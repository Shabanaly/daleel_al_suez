[{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin-support.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/analytics.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/areas.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/categories.actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":76,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":76,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":154,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":154,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\n\nimport { createClient } from '@/lib/supabase/server'\nimport { logAudit, generateChangesSummary } from '@/lib/audit'\nimport { revalidatePath } from 'next/cache'\n\nexport type CategoryState = {\n    errors?: {\n        name?: string[]\n        slug?: string[]\n        icon?: string[]\n        _form?: string[]\n    }\n    message?: string\n    success?: boolean\n}\n\nexport async function createCategory(prevState: CategoryState, formData: FormData): Promise<CategoryState> {\n    const name = formData.get('name') as string\n    const slug = formData.get('slug') as string\n    const icon = formData.get('icon') as string\n    const is_featured = formData.get('is_featured') === 'true'\n    const sort_order = parseInt(formData.get('sort_order') as string) || 0\n\n    // Basic validation\n    if (!name || name.length < 3) {\n        return { errors: { name: ['Name must be at least 3 characters'] }, success: false }\n    }\n    if (!slug) {\n        return { errors: { slug: ['Slug is required'] }, success: false }\n    }\n\n    const supabase = await createClient()\n\n    try {\n        // 1. Check authentication\n        const { data: { user } } = await supabase.auth.getUser()\n        if (!user) {\n            return { errors: { _form: ['Not authenticated'] }, success: false }\n        }\n\n        // 2. Check Super Admin role\n        const { data: profile } = await supabase\n            .from('profiles')\n            .select('role')\n            .eq('id', user.id)\n            .single()\n\n        if (profile?.role !== 'super_admin') {\n            return { errors: { _form: ['Access denied. Only Super Admin can manage categories.'] }, success: false }\n        }\n\n        // 3. Insert category (no created_by needed)\n        const { data, error } = await supabase\n            .from('categories')\n            .insert({ name, slug, icon, is_featured, sort_order })\n            .select()\n            .single()\n\n        if (error) {\n            console.error('Create category error:', error)\n            return { errors: { _form: ['Failed to create category. Database error.'] }, success: false }\n        }\n\n        // 4. Log audit\n        await logAudit({\n            action: 'category.create',\n            targetId: data.id,\n            details: {\n                after: { name, slug, icon, is_featured, sort_order }\n            }\n        })\n\n        revalidatePath('/admin/categories')\n        return { success: true, message: 'تم إضافة التصنيف بنجاح' }\n    } catch (e) {\n        return { errors: { _form: ['Unexpected error occurred'] }, success: false }\n    }\n}\n\nexport async function updateCategory(id: string, prevState: CategoryState, formData: FormData): Promise<CategoryState> {\n    const name = formData.get('name') as string\n    const slug = formData.get('slug') as string\n    const icon = formData.get('icon') as string\n    const is_featured = formData.get('is_featured') === 'true'\n    const sort_order = parseInt(formData.get('sort_order') as string) || 0\n\n    // Basic validation\n    if (!name || name.length < 3) {\n        return { errors: { name: ['Name must be at least 3 characters'] }, success: false }\n    }\n    if (!slug) {\n        return { errors: { slug: ['Slug is required'] }, success: false }\n    }\n\n    const supabase = await createClient()\n\n    try {\n        // 1. Check authentication\n        const { data: { user } } = await supabase.auth.getUser()\n        if (!user) {\n            return { errors: { _form: ['Not authenticated'] }, success: false }\n        }\n\n        // 2. Check Super Admin role\n        const { data: profile } = await supabase\n            .from('profiles')\n            .select('role')\n            .eq('id', user.id)\n            .single()\n\n        if (profile?.role !== 'super_admin') {\n            return { errors: { _form: ['Access denied. Only Super Admin can manage categories.'] }, success: false }\n        }\n\n        // 3. Fetch old data first for audit comparison\n        const { data: oldCategory } = await supabase\n            .from('categories')\n            .select('*')\n            .eq('id', id)\n            .single()\n\n        // 4. Update category\n        const { error } = await supabase\n            .from('categories')\n            .update({ name, slug, icon, is_featured, sort_order })\n            .eq('id', id)\n\n        if (error) {\n            console.error('Update category error:', error)\n            return { errors: { _form: ['Failed to update category.'] }, success: false }\n        }\n\n        // 5. Log audit with changes\n        if (oldCategory) {\n            const changes = generateChangesSummary(\n                oldCategory,\n                { name, slug, icon, is_featured, sort_order }\n            )\n\n            await logAudit({\n                action: 'category.update',\n                targetId: id,\n                details: {\n                    before: oldCategory,\n                    after: { name, slug, icon, is_featured, sort_order },\n                    changes\n                }\n            })\n        }\n\n        revalidatePath('/admin/categories')\n        return { success: true, message: 'تم تحديث التصنيف بنجاح' }\n    } catch (e) {\n        return { errors: { _form: ['Unexpected error occurred'] }, success: false }\n    }\n}\n\nexport async function deleteCategory(formData: FormData) {\n    const id = formData.get('id')\n    if (!id) return\n\n    const supabase = await createClient()\n\n    try {\n        // 1. Check authentication\n        const { data: { user } } = await supabase.auth.getUser()\n        if (!user) {\n            console.error('Delete category error: Not authenticated')\n            return\n        }\n\n        // 2. Check Super Admin role\n        const { data: profile } = await supabase\n            .from('profiles')\n            .select('role')\n            .eq('id', user.id)\n            .single()\n\n        if (profile?.role !== 'super_admin') {\n            console.error('Delete category error: Access denied')\n            return\n        }\n\n        // 3. Fetch category before deletion for audit log\n        const { data: categoryToDelete } = await supabase\n            .from('categories')\n            .select('*')\n            .eq('id', id)\n            .single()\n\n        // 4. Delete category\n        const { error } = await supabase\n            .from('categories')\n            .delete()\n            .eq('id', id)\n\n        if (error) throw error\n\n        // 5. Log deletion\n        if (categoryToDelete) {\n            await logAudit({\n                action: 'category.delete',\n                targetId: id as string,\n                details: {\n                    before: categoryToDelete,\n                    metadata: { deletedAt: new Date().toISOString() }\n                }\n            })\n        }\n\n        revalidatePath('/admin/categories')\n    } catch (error) {\n        console.error('Delete category error:', error)\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/events.actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getAdminRole' is defined but never used.","line":15,"column":16,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\n\nimport { createEventUseCase, updateEventUseCase, deleteEventUseCase, getAdminEventsUseCase } from \"@/di/modules\"\nimport { createClient } from \"@/lib/supabase/server\"\nimport { revalidatePath } from \"next/cache\"\nimport { SuezEvent, EventStatus, EventType } from \"@/domain/entities/suez-event\"\n\nexport type EventState = {\n    message?: string\n    errors?: Record<string, string[]>\n    success?: boolean\n    data?: SuezEvent\n}\n\nasync function getAdminRole() {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return null\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n\n    return profile?.role || null\n}\n\nexport async function createEventAction(prevState: EventState, formData: FormData): Promise<EventState> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return { message: \"Unauthorized\" }\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n    const role = profile?.role || null\n    if (!role) return { message: \"Unauthorized\" }\n\n    const title = formData.get('title') as string\n    const slug = formData.get('slug') as string\n    const description = formData.get('description') as string\n    const imageUrl = formData.get('imageUrl') as string\n    const startDate = formData.get('startDate') as string\n    const endDate = formData.get('endDate') as string\n    const location = formData.get('location') as string\n    const placeId = formData.get('placeId') as string\n    const status = formData.get('status') as EventStatus\n    const type = formData.get('type') as EventType\n\n    try {\n        const event = await createEventUseCase.execute(role, {\n            title,\n            slug,\n            description,\n            imageUrl,\n            startDate: new Date(startDate),\n            endDate: new Date(endDate),\n            location,\n            placeId: placeId || null,\n            status,\n            type\n        }, supabase)\n\n        revalidatePath('/admin/events')\n        revalidatePath('/events')\n        return { success: true, data: event, message: \"Event created successfully\" }\n    } catch (error) {\n        return { success: false, message: error instanceof Error ? error.message : \"Failed to create event\" }\n    }\n}\n\nexport async function updateEventAction(id: string, prevState: EventState, formData: FormData): Promise<EventState> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return { message: \"Unauthorized\" }\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n    const role = profile?.role || null\n    if (!role) return { message: \"Unauthorized\" }\n\n    const updates: Partial<SuezEvent> = {}\n    if (formData.has('title')) updates.title = formData.get('title') as string\n    if (formData.has('slug')) updates.slug = formData.get('slug') as string\n    if (formData.has('description')) updates.description = formData.get('description') as string\n    if (formData.has('imageUrl')) updates.imageUrl = formData.get('imageUrl') as string\n    if (formData.has('startDate')) updates.startDate = new Date(formData.get('startDate') as string)\n    if (formData.has('endDate')) updates.endDate = new Date(formData.get('endDate') as string)\n    if (formData.has('location')) updates.location = formData.get('location') as string\n    if (formData.has('placeId')) updates.placeId = (formData.get('placeId') as string) || null\n    if (formData.has('status')) updates.status = formData.get('status') as EventStatus\n    if (formData.has('type')) updates.type = formData.get('type') as EventType\n\n    try {\n        const event = await updateEventUseCase.execute(id, role, updates, supabase)\n        revalidatePath('/admin/events')\n        revalidatePath('/events')\n        return { success: true, data: event, message: \"Event updated successfully\" }\n    } catch (error) {\n        return { success: false, message: error instanceof Error ? error.message : \"Failed to update event\" }\n    }\n}\n\nexport async function deleteEventAction(id: string): Promise<{ success: boolean; message: string }> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return { success: false, message: \"Unauthorized\" }\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n    const role = profile?.role || null\n    if (!role) return { success: false, message: \"Unauthorized\" }\n\n    try {\n        await deleteEventUseCase.execute(id, role, supabase)\n        revalidatePath('/admin/events')\n        revalidatePath('/events')\n        return { success: true, message: \"Event deleted successfully\" }\n    } catch (error) {\n        return { success: false, message: error instanceof Error ? error.message : \"Failed to delete event\" }\n    }\n}\n\nexport async function toggleEventStatusAction(id: string, newStatus: EventStatus): Promise<{ success: boolean; message: string }> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return { success: false, message: \"Unauthorized\" }\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n    const role = profile?.role || null\n    if (role !== 'super_admin') return { success: false, message: \"Unauthorized\" }\n\n    try {\n        await updateEventUseCase.execute(id, role, { status: newStatus }, supabase)\n        revalidatePath('/admin/events')\n        revalidatePath('/events')\n        return { success: true, message: `Status updated to ${newStatus}` }\n    } catch (error) {\n        return { success: false, message: error instanceof Error ? error.message : \"Failed to update status\" }\n    }\n}\n\nexport async function getAdminEventsAction() {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) throw new Error(\"Unauthorized\")\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n    const role = profile?.role || null\n    if (role !== 'super_admin') throw new Error(\"Unauthorized\")\n\n    return getAdminEventsUseCase.execute(role, supabase)\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/notifications.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/places.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/settings.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/admin/users.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/favorites.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/notification-preferences.actions.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'id' is assigned a value but never used.","line":40,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":15,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user_id' is assigned a value but never used.","line":40,"column":17,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'created_at' is assigned a value but never used.","line":40,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":36,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'updated_at' is assigned a value but never used.","line":40,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":48,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/notifications.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/profile-security.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/profile.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/reviews.actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is assigned a value but never used.","line":15,"column":29,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\n\nimport { revalidatePath } from 'next/cache'\nimport { createClient } from '@/lib/supabase/server'\nimport { ReviewFormData } from '@/domain/entities/review'\nimport { SupabaseReviewRepository } from '@/data/repositories/supabase-review.repository'\nimport { CreateReviewUseCase } from '@/domain/use-cases/reviews/create-review.usecase'\nimport { UpdateReviewUseCase } from '@/domain/use-cases/reviews/update-review.usecase'\nimport { DeleteReviewUseCase } from '@/domain/use-cases/reviews/delete-review.usecase'\nimport { VoteReviewUseCase } from '@/domain/use-cases/reviews/vote-review.usecase'\n\n// Helper to create use cases with authenticated client\nasync function getAuthenticatedUseCases() {\n    const supabase = await createClient()\n    const { data: { user }, error } = await supabase.auth.getUser()\n\n    // Create fresh instances with the request-scoped client\n    const reviewRepository = new SupabaseReviewRepository(supabase)\n\n    return {\n        user,\n        createReviewUseCase: new CreateReviewUseCase(reviewRepository),\n        updateReviewUseCase: new UpdateReviewUseCase(reviewRepository),\n        deleteReviewUseCase: new DeleteReviewUseCase(reviewRepository),\n        voteReviewUseCase: new VoteReviewUseCase(reviewRepository),\n    }\n}\n\nexport async function createReviewAction(placeId: string, placeSlug: string, data: ReviewFormData) {\n    const { user, createReviewUseCase } = await getAuthenticatedUseCases()\n\n    if (!user) {\n        throw new Error('يجب تسجيل الدخول لكتابة تقييم')\n    }\n\n\n    const userName = user.user_metadata?.full_name || user.user_metadata?.name || user.email?.split('@')[0] || 'مستخدم'\n    const userAvatar = user.user_metadata?.avatar_url || user.user_metadata?.picture\n\n\n    try {\n        await createReviewUseCase.execute({\n            placeId,\n            userId: user.id,\n            userName,\n            userAvatar,\n            ...data\n        })\n\n        revalidatePath(`/places/${placeSlug}`)\n        revalidatePath('/places')\n\n        return { success: true }\n    } catch (error) {\n        console.error('Create Review Error:', error)\n        throw new Error(error instanceof Error ? error.message : 'فشل إنشاء التقييم')\n    }\n}\n\nexport async function updateReviewAction(reviewId: string, placeSlug: string, data: ReviewFormData) {\n    const { user, updateReviewUseCase } = await getAuthenticatedUseCases()\n\n    if (!user) {\n        throw new Error('يجب تسجيل الدخول')\n    }\n\n    try {\n        await updateReviewUseCase.execute(reviewId, data)\n\n        revalidatePath(`/places/${placeSlug}`)\n\n        return { success: true }\n    } catch (error) {\n        throw new Error(error instanceof Error ? error.message : 'فشل تحديث التقييم')\n    }\n}\n\nexport async function deleteReviewAction(reviewId: string, placeSlug: string) {\n    const { user, deleteReviewUseCase } = await getAuthenticatedUseCases()\n\n    if (!user) {\n        throw new Error('يجب تسجيل الدخول')\n    }\n\n    try {\n        await deleteReviewUseCase.execute(reviewId)\n\n        revalidatePath(`/places/${placeSlug}`)\n        revalidatePath('/places')\n\n        return { success: true }\n    } catch (error) {\n        throw new Error(error instanceof Error ? error.message : 'فشل حذف التقييم')\n    }\n}\n\nexport async function voteReviewAction(reviewId: string, placeSlug: string, isHelpful: boolean) {\n    const { user, voteReviewUseCase } = await getAuthenticatedUseCases()\n\n    if (!user) {\n        throw new Error('يجب تسجيل الدخول للتصويت')\n    }\n\n    try {\n        await voteReviewUseCase.execute(reviewId, user.id, isHelpful)\n\n        revalidatePath(`/places/${placeSlug}`)\n\n        return { success: true }\n    } catch (error) {\n        throw new Error(error instanceof Error ? error.message : 'فشل التصويت')\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/support.actions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/actions/user-stats.actions.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":63,"column":88,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":63,"endColumn":91,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1603,1606],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1603,1606],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\n\nimport { createClient } from '@/lib/supabase/server'\n\nexport async function getUserStatistics() {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) return null\n\n    const { data, error } = await supabase\n        .from('user_statistics')\n        .select('*')\n        .eq('user_id', user.id)\n        .single()\n\n    if (error && error.code !== 'PGRST116') throw error\n\n    // Return default stats if none found (e.g. no reviews yet)\n    return data || {\n        total_reviews: 0,\n        avg_rating: 0,\n        total_favorites: 0,\n        helpful_votes: 0\n    }\n}\n\nexport async function getReviewsByMonth() {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) return []\n\n    const { data, error } = await supabase\n        .from('user_reviews_by_month')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('month', { ascending: true })\n        .limit(12)\n\n    if (error) throw error\n    return data\n}\n\nexport async function getCategoryBreakdown() {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) return []\n\n    const { data, error } = await supabase\n        .from('reviews')\n        .select(`\n            places!inner(\n                categories!inner(name)\n            )\n        `)\n        .eq('user_id', user.id)\n\n    if (error) throw error\n\n    // Process and group by category\n    const breakdown = (data as unknown[]).reduce((acc: Record<string, number>, review: any) => {\n        // Handle Supabase join structure which can return arrays for joins\n        const places = Array.isArray(review.places) ? review.places[0] : review.places;\n        const categories = places && Array.isArray(places.categories) ? places.categories[0] : places?.categories;\n        const categoryName = categories?.name || 'غير مصنف'\n\n        acc[categoryName] = (acc[categoryName] || 0) + 1\n        return acc\n    }, {} as Record<string, number>)\n\n    return Object.entries(breakdown).map(([name, count]) => ({\n        name,\n        count\n    }))\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/about/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/auth/callback/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/categories/[slug]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2302,2305],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2302,2305],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { PlacesListView } from \"@/presentation/features/places-list-view\";\nimport { getCategoriesUseCase } from \"@/di/modules\";\nimport { createClient } from \"@/lib/supabase/server\";\nimport { notFound } from \"next/navigation\";\nimport { Metadata } from \"next\";\n\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 3600;\n\ntype Props = {\n    params: Promise<{ slug: string }>\n}\n\nexport async function generateMetadata({ params }: Props): Promise<Metadata> {\n    const { slug } = await params;\n    const categories = await getCategoriesUseCase.execute()\n    const currentCategory = categories.find(c => c.slug === slug)\n\n    if (!currentCategory) {\n        return {\n            title: 'Category Not Found',\n        }\n    }\n\n    const title = `${currentCategory.name} | دليل السويس`;\n    const description = `أفضل أماكن ${currentCategory.name} في السويس. تصفح التقييمات والعناوين وأرقام الهواتف.`;\n\n    return {\n        title,\n        description,\n        openGraph: {\n            title,\n            description,\n            type: 'website',\n            locale: 'ar_EG',\n            siteName: 'دليل السويس',\n        },\n        twitter: {\n            card: 'summary_large_image',\n            title,\n            description,\n        },\n        alternates: {\n            canonical: `/categories/${currentCategory.slug}`,\n        }\n    }\n}\n\nexport default async function CategoryDetailsPage({\n    params,\n}: Props) {\n    const { slug } = await params;\n    const supabase = await createClient()\n\n    // Get all categories for filters\n    const categories = await getCategoriesUseCase.execute()\n\n    // Find the current category\n    const currentCategory = categories.find(c => c.slug === slug)\n    if (!currentCategory) {\n        notFound()\n    }\n\n    // Get places in this category\n    const { data: placesData } = await supabase\n        .from('places')\n        .select('*, categories(name), areas(name)')\n        .eq('category_id', currentCategory.id)\n        .eq('status', 'active')\n        .order('created_at', { ascending: false })\n\n    // Get areas for filters\n    const { data: areasData } = await supabase\n        .from('areas')\n        .select('id, name')\n        .order('name')\n\n    const areas = areasData || []\n\n    // Map to Place entities\n    const places = (placesData || []).map((p: any) => ({\n        id: p.id,\n        name: p.name,\n        slug: p.slug,\n        description: p.description,\n        address: p.address,\n        phone: p.phone,\n        whatsapp: p.whatsapp,\n        website: p.website,\n        facebook: p.facebook,\n        instagram: p.instagram,\n        mapLink: p.map_link,\n        images: p.images || [],\n        categoryId: p.category_id,\n        categoryName: p.categories?.name,\n        areaId: p.area_id,\n        areaName: p.areas?.name,\n        rating: p.rating || 0,\n        reviewCount: p.review_count || 0,\n        isFeatured: p.is_featured || false,\n        status: p.status,\n        type: p.type,\n        createdAt: p.created_at,\n    }))\n\n    return (\n        <PlacesListView\n            places={places}\n            title={currentCategory.name}\n            categories={categories}\n            areas={areas}\n            resultsCount={places.length}\n        />\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/categories/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/contact/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/favorites/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/forgot-password/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1025,1028],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1025,1028],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport Link from 'next/link'\nimport { Loader2, Mail, ArrowRight } from 'lucide-react'\n\nexport default function ForgotPasswordPage() {\n    const [email, setEmail] = useState('')\n    const [loading, setLoading] = useState(false)\n    const [message, setMessage] = useState<{ text: string, type: 'error' | 'success' } | null>(null)\n\n    const supabase = createClient()\n\n    const handleResetPassword = async (e: React.FormEvent) => {\n        e.preventDefault()\n        setLoading(true)\n        setMessage(null)\n\n        try {\n            const { error } = await supabase.auth.resetPasswordForEmail(email, {\n                redirectTo: `${location.origin}/auth/callback?next=/profile/reset-password`,\n            })\n\n            if (error) throw error\n\n            setMessage({\n                text: 'تم إرسال رابط استعادة كلمة المرور إلى بريدك الإلكتروني.',\n                type: 'success'\n            })\n        } catch (error: any) {\n            setMessage({ text: error.message, type: 'error' })\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"min-h-screen flex items-center justify-center p-4 bg-muted/20\">\n            <div className=\"w-full max-w-md bg-card rounded-3xl shadow-xl overflow-hidden border border-border\">\n                <div className=\"p-8\">\n                    {/* Back to Home */}\n                    <Link href=\"/login\" className=\"inline-flex items-center text-sm text-muted-foreground hover:text-primary transition-colors mb-6\">\n                        <ArrowRight size={16} className=\"ml-2\" />\n                        الرجوع لتسجيل الدخول\n                    </Link>\n\n                    <div className=\"text-center mb-8\">\n                        <h1 className=\"text-2xl font-bold text-foreground\">استعادة كلمة المرور</h1>\n                        <p className=\"text-muted-foreground mt-2\">\n                            أدخل بريدك الإلكتروني وسنرسل لك رابطاً لإعادة تعيين كلمة المرور\n                        </p>\n                    </div>\n\n                    <form onSubmit={handleResetPassword} className=\"space-y-4\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">البريد الإلكتروني</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"email\"\n                                    value={email}\n                                    onChange={(e) => setEmail(e.target.value)}\n                                    required\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"name@example.com\"\n                                />\n                                <Mail className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        {message && (\n                            <div className={`p-4 rounded-xl text-sm flex items-center gap-2 ${message.type === 'error' ? 'bg-red-50 text-red-600 border border-red-100' : 'bg-green-50 text-green-600 border border-green-100'}`}>\n                                {message.type === 'error' ? '⚠️' : '✅'}\n                                {message.text}\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={loading}\n                            className=\"w-full bg-primary text-primary-foreground py-3.5 rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                        >\n                            {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : 'إرسال الرابط'}\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/login/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":7,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":47,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[213,219],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used.","line":8,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":13,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Image"},"fix":{"range":[251,281],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1298,1301],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1298,1301],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":56,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":56,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1806,1809],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1806,1809],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport { Loader2, Mail, Lock, ArrowRight, User, Compass } from 'lucide-react'\nimport Image from 'next/image'\n\nexport default function LoginPage() {\n    const [email, setEmail] = useState('')\n    const [password, setPassword] = useState('')\n    const [loading, setLoading] = useState(false)\n    const [message, setMessage] = useState<{ text: string, type: 'error' | 'success' } | null>(null)\n\n    const router = useRouter()\n    const supabase = createClient()\n\n    const handleEmailLogin = async (e: React.FormEvent) => {\n        e.preventDefault()\n        setLoading(true)\n        setMessage(null)\n\n        try {\n            const { error } = await supabase.auth.signInWithPassword({\n                email,\n                password,\n            })\n\n            if (error) throw error\n\n            // Check if we are admin or normal user\n            const { data: { user } } = await supabase.auth.getUser()\n\n            // Simple redirection for now, middleware or protected routes handle the rest\n            if (user) {\n                router.push('/')\n                router.refresh()\n            }\n        } catch (error: any) {\n            setMessage({ text: error.message, type: 'error' })\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    const handleSocialLogin = async (provider: 'google' | 'facebook') => {\n        try {\n            const { error } = await supabase.auth.signInWithOAuth({\n                provider,\n                options: {\n                    redirectTo: `${location.origin}/auth/callback`,\n                },\n            })\n            if (error) throw error\n        } catch (error: any) {\n            setMessage({ text: error.message, type: 'error' })\n        }\n    }\n\n    return (\n        <div className=\"min-h-screen flex\">\n            {/* Right Side - Form */}\n            <div className=\"w-full lg:w-1/2 flex items-center justify-center p-8 lg:p-12 bg-background\">\n                <div className=\"w-full max-w-md space-y-8\">\n                    {/* Back to Home */}\n                    <Link href=\"/\" className=\"inline-flex items-center text-sm text-muted-foreground hover:text-primary transition-colors mb-8\">\n                        <ArrowRight size={16} className=\"ml-2\" />\n                        الرجوع للرئيسية\n                    </Link>\n\n                    <div className=\"text-center\">\n                        <h1 className=\"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-blue-600 mb-2\">\n                            مرحباً بعودتك\n                        </h1>\n                        <p className=\"text-muted-foreground\">\n                            سجل الدخول لاستكمال رحلتك في استكشاف السويس\n                        </p>\n                    </div>\n\n                    <form onSubmit={handleEmailLogin} className=\"space-y-6\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">البريد الإلكتروني</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"email\"\n                                    value={email}\n                                    onChange={(e) => setEmail(e.target.value)}\n                                    required\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"name@example.com\"\n                                />\n                                <Mail className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        <div className=\"space-y-2\">\n                            <div className=\"flex justify-between items-center\">\n                                <label className=\"text-sm font-medium text-foreground\">كلمة المرور</label>\n                                <Link href=\"/forgot-password\" className=\"text-xs font-medium text-primary hover:underline\">\n                                    نسيت كلمة المرور؟\n                                </Link>\n                            </div>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"password\"\n                                    value={password}\n                                    onChange={(e) => setPassword(e.target.value)}\n                                    required\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"••••••••\"\n                                />\n                                <Lock className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        {message && (\n                            <div className={`p-4 rounded-xl text-sm flex items-center gap-2 ${message.type === 'error' ? 'bg-red-50 text-red-600 border border-red-100' : 'bg-green-50 text-green-600 border border-green-100'}`}>\n                                {message.type === 'error' ? '⚠️' : '✅'}\n                                {message.text}\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={loading}\n                            className=\"w-full bg-primary text-primary-foreground py-3.5 rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                        >\n                            {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : 'تسجيل الدخول'}\n                        </button>\n                    </form>\n\n                    <div className=\"relative\">\n                        <div className=\"absolute inset-0 flex items-center\">\n                            <span className=\"w-full border-t border-border\" />\n                        </div>\n                        <div className=\"relative flex justify-center text-sm\">\n                            <span className=\"px-4 bg-background text-muted-foreground\">أو تابع باستخدام</span>\n                        </div>\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <button\n                            onClick={() => handleSocialLogin('google')}\n                            className=\"flex items-center justify-center py-3 border border-input rounded-xl hover:bg-muted transition-colors font-medium text-foreground gap-2\"\n                        >\n                            <svg className=\"w-5 h-5\" viewBox=\"0 0 24 24\"><path d=\"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z\" fill=\"#4285F4\" /><path d=\"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z\" fill=\"#34A853\" /><path d=\"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z\" fill=\"#FBBC05\" /><path d=\"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z\" fill=\"#EA4335\" /></svg>\n                            Google\n                        </button>\n                        <button\n                            onClick={() => handleSocialLogin('facebook')}\n                            className=\"flex items-center justify-center py-3 border border-input rounded-xl hover:bg-muted transition-colors font-medium text-foreground gap-2\"\n                        >\n                            <svg className=\"w-5 h-5 text-[#1877F2]\" fill=\"currentColor\" viewBox=\"0 0 24 24\"><path d=\"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z\" /></svg>\n                            Facebook\n                        </button>\n                    </div>\n\n                    <p className=\"text-center text-sm text-muted-foreground\">\n                        ليس لديك حساب بعد؟{' '}\n                        <Link href=\"/signup\" className=\"font-bold text-primary hover:underline\">\n                            سجل مجاناً\n                        </Link>\n                    </p>\n                </div>\n            </div>\n\n            {/* Left Side - Image/Banner (Hidden on Mobile) */}\n            <div className=\"hidden lg:block w-1/2 relative bg-slate-900\">\n                <div className=\"absolute inset-0 bg-gradient-to-br from-primary/40 to-blue-900/60 mix-blend-multiply z-10\" />\n                {/* Fallback pattern or generic image if no specific image is available */}\n                <div className=\"absolute inset-0 bg-[url('/images/hero-bg.png')] bg-cover bg-center\" />\n\n                <div className=\"relative z-20 h-full flex flex-col justify-between p-12 text-white\">\n                    <div className=\"flex items-center gap-4\">\n                        <Compass className=\"w-6 h-6 text-white\" />\n                        <span className=\"text-2xl font-bold\">دليل السويس</span>\n                    </div>\n\n                    <div className=\"max-w-md\">\n                        <h2 className=\"text-4xl font-bold mb-6 leading-tight\">\n                            اكتشف جمال السويس في مكان واحد\n                        </h2>\n                        <p className=\"text-lg text-white/80 leading-relaxed\">\n                            انضم إلى مجتمعنا اليوم واكتشف أفضل الأماكن، الفعاليات، والعروض الحصرية في مدينتك.\n                        </p>\n                    </div>\n\n                    <div className=\"flex items-center gap-4 text-sm text-white/60\">\n                        <span>© 2024 دليل السويس</span>\n                        <span>•</span>\n                        <Link href=\"/privacy\" className=\"hover:text-white transition-colors\">سياسة الخصوصية</Link>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/places/[slug]/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":139,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4338,4341],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4338,4341],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { notFound } from \"next/navigation\";\nimport { PlaceDetailsView } from \"@/presentation/features/place-details-view\";\nimport { getPlaceBySlugUseCase, getPlaceReviewsUseCase, getPlaceRatingStatsUseCase } from \"@/di/modules\";\nimport { createClient } from \"@/lib/supabase/server\";\nimport { Metadata } from \"next\";\n\nexport const dynamic = 'force-dynamic';\nexport const revalidate = 3600;\n\ntype Props = {\n    params: Promise<{ slug: string }>\n}\n\nexport async function generateMetadata({ params }: Props): Promise<Metadata> {\n    const { slug } = await params;\n    const place = await getPlaceBySlugUseCase.execute(slug);\n\n    if (!place) {\n        return {\n            title: 'Place Not Found',\n        }\n    }\n\n    const title = `${place.name} | دليل السويس`;\n    const description = place.description?.substring(0, 160) || `تفاصيل ومعلومات عن ${place.name} في السويس. العنوان، رقم الهاتف، وتقييمات العملاء.`;\n    const images = place.images && place.images.length > 0 ? [place.images[0]] : [];\n\n    // Convert string-based time to ISO date string for valid OpenGraph if needed, \n    // but for article:published_time we usually need a date. \n    // Here we'll just stick to basic OpenGraph tags.\n\n    return {\n        title,\n        description,\n        openGraph: {\n            title,\n            description,\n            images,\n            type: 'website',\n            locale: 'ar_EG',\n            siteName: 'دليل السويس',\n        },\n        twitter: {\n            card: 'summary_large_image',\n            title,\n            description,\n            images,\n        },\n        alternates: {\n            canonical: `/places/${place.slug}`,\n        }\n    }\n}\n\nexport default async function PlaceDetailsPage({\n    params,\n}: Props) {\n    const { slug } = await params;\n\n    // 1. Get place details\n    const place = await getPlaceBySlugUseCase.execute(slug);\n\n    if (!place) {\n        notFound();\n    }\n\n    // JSON-LD Structured Data\n    const baseUrl = process.env.NEXT_PUBLIC_SITE_URL || 'https://dalil-al-suways.vercel.app';\n\n    const jsonLd = {\n        '@context': 'https://schema.org',\n        '@type': 'LocalBusiness',\n        name: place.name,\n        image: place.images,\n        description: place.description,\n        address: {\n            '@type': 'PostalAddress',\n            streetAddress: place.address,\n            addressLocality: 'Suez',\n            addressRegion: 'Suez',\n            addressCountry: 'EG'\n        },\n        telephone: place.phone,\n        url: `${baseUrl}/places/${place.slug}`,\n        aggregateRating: place.rating ? {\n            '@type': 'AggregateRating',\n            ratingValue: place.rating,\n            reviewCount: place.reviewCount || 0\n        } : undefined,\n    }\n\n    const supabase = await createClient()\n\n    // 2. Get current user (if logged in)\n    const { data: { user } } = await supabase.auth.getUser()\n\n    // 3. Fetch reviews and stats\n    const [reviews, ratingStats] = await Promise.all([\n        getPlaceReviewsUseCase.execute(place.id, user?.id),\n        getPlaceRatingStatsUseCase.execute(place.id)\n    ])\n\n    // 4. Get user's review if logged in\n    let userReview = null\n    if (user) {\n        const { data: existingReview } = await supabase\n            .from('reviews')\n            .select('*')\n            .eq('place_id', place.id)\n            .eq('user_id', user.id)\n            .maybeSingle()\n\n        if (existingReview) {\n            userReview = {\n                id: existingReview.id,\n                placeId: existingReview.place_id,\n                userId: existingReview.user_id,\n                rating: existingReview.rating,\n                title: existingReview.title,\n                comment: existingReview.comment,\n                helpfulCount: existingReview.helpful_count || 0,\n                status: existingReview.status,\n                createdAt: existingReview.created_at,\n                updatedAt: existingReview.updated_at,\n            }\n        }\n    }\n\n    // 5. Fetch related places from same category\n    const { data: relatedPlaces } = await supabase\n        .from('places')\n        .select('*, categories(name), areas(name)')\n        .eq('category_id', place.categoryId)\n        .eq('status', 'active')\n        .neq('id', place.id)\n        .limit(4)\n\n    // Map to Place entities\n    const related = (relatedPlaces || []).map((p: any) => ({\n        id: p.id,\n        name: p.name,\n        slug: p.slug,\n        description: p.description,\n        address: p.address,\n        phone: p.phone,\n        whatsapp: p.whatsapp,\n        website: p.website,\n        facebook: p.facebook,\n        instagram: p.instagram,\n        mapLink: p.map_link,\n        images: p.images || [],\n        categoryId: p.category_id,\n        categoryName: p.categories?.name,\n        areaId: p.area_id,\n        areaName: p.areas?.name,\n        rating: p.rating || 0,\n        reviewCount: p.review_count || 0,\n        isFeatured: p.is_featured || false,\n        status: p.status,\n        type: p.type,\n        createdAt: p.created_at,\n    }))\n\n    return (\n        <>\n            <script\n                type=\"application/ld+json\"\n                dangerouslySetInnerHTML={{ __html: JSON.stringify(jsonLd) }}\n            />\n            <PlaceDetailsView\n                place={place}\n                relatedPlaces={related}\n                reviews={reviews}\n                ratingStats={ratingStats}\n                currentUserId={user?.id}\n                userReview={userReview}\n            />\n        </>\n    );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/places/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2129,2132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2129,2132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { PlacesListView } from \"@/presentation/features/places-list-view\";\nimport { getCategoriesUseCase } from \"@/di/modules\";\nimport { createClient } from \"@/lib/supabase/server\";\n\nexport const dynamic = 'force-dynamic'; // Force dynamic rendering\nexport const revalidate = 0; // No caching\n\ninterface SearchParams {\n    search?: string;\n    category?: string;\n    area?: string;\n    sort?: string;\n}\n\nexport default async function PlacesPage({\n    searchParams,\n}: {\n    searchParams: Promise<SearchParams> | SearchParams;\n}) {\n    // Await searchParams for Next.js 15 compatibility\n    const params = searchParams instanceof Promise ? await searchParams : searchParams;\n\n    const supabase = await createClient()\n\n    // Get all categories and areas for filters\n    const [categories, { data: areasData }] = await Promise.all([\n        getCategoriesUseCase.execute(),\n        supabase.from('areas').select('id, name').order('name')\n    ])\n\n    const areas = areasData || []\n\n    // Build query\n    let query = supabase\n        .from('places')\n        .select('*, categories(name), areas(name)')\n        .eq('status', 'active')\n\n    // Apply search filter\n    if (params.search) {\n        query = query.or(`name.ilike.%${params.search}%,description.ilike.%${params.search}%,address.ilike.%${params.search}%`)\n    }\n\n    // Apply category filter\n    if (params.category) {\n        const category = categories.find(c => c.slug === params.category)\n        if (category) {\n            query = query.eq('category_id', category.id)\n        }\n    }\n\n    // Apply area filter\n    if (params.area) {\n        query = query.eq('area_id', params.area)\n    }\n\n    // Apply sorting\n    switch (params.sort) {\n        case 'rating':\n            query = query.order('rating', { ascending: false })\n            break\n        case 'name':\n            query = query.order('name', { ascending: true })\n            break\n        default: // 'recent'\n            query = query.order('created_at', { ascending: false })\n    }\n\n    const { data: placesData } = await query\n\n    // Map to Place entities\n    const places = (placesData || []).map((p: any) => ({\n        id: p.id,\n        name: p.name,\n        slug: p.slug,\n        description: p.description,\n        address: p.address,\n        phone: p.phone,\n        whatsapp: p.whatsapp,\n        website: p.website,\n        facebook: p.facebook,\n        instagram: p.instagram,\n        mapLink: p.map_link,\n        images: p.images || [],\n        categoryId: p.category_id,\n        categoryName: p.categories?.name,\n        areaId: p.area_id,\n        areaName: p.areas?.name,\n        rating: p.rating || 0,\n        reviewCount: p.review_count || 0,\n        isFeatured: p.is_featured || false,\n        status: p.status,\n        type: p.type,\n        createdAt: p.created_at,\n    }))\n\n    // Generate title\n    let title = \"كل الأماكن\"\n    if (params.search) {\n        title = `نتائج البحث: ${params.search}`\n    } else if (params.category) {\n        const cat = categories.find(c => c.slug === params.category)\n        if (cat) title = cat.name\n    }\n\n    return (\n        <PlacesListView\n            places={places}\n            title={title}\n            categories={categories}\n            areas={areas}\n            resultsCount={places.length}\n        />\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/privacy/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/profile/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/profile/reset-password/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":62,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":62,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2082,2085],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2082,2085],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport { Loader2, Lock, ArrowRight } from 'lucide-react'\n\nexport default function ResetPasswordPage() {\n    const [password, setPassword] = useState('')\n    const [confirmPassword, setConfirmPassword] = useState('')\n    const [loading, setLoading] = useState(false)\n    const [message, setMessage] = useState<{ text: string, type: 'error' | 'success' } | null>(null)\n    const [validSession, setValidSession] = useState(false)\n    const [checkingSession, setCheckingSession] = useState(true)\n\n    const router = useRouter()\n    const supabase = createClient()\n\n    useEffect(() => {\n        const checkSession = async () => {\n            const { data: { session } } = await supabase.auth.getSession()\n            if (!session) {\n                // If no session, they might have clicked a bad link or it expired.\n                // However, the auth/callback should have established the session.\n                setMessage({ text: 'رابط غير صالح أو انتهت صلاحيته. يرجى طلب رابط جديد.', type: 'error' })\n            } else {\n                setValidSession(true)\n            }\n            setCheckingSession(false)\n        }\n        checkSession()\n    }, [supabase])\n\n    const handleUpdatePassword = async (e: React.FormEvent) => {\n        e.preventDefault()\n\n        if (password !== confirmPassword) {\n            setMessage({ text: 'كلمات المرور غير متطابقة', type: 'error' })\n            return\n        }\n\n        setLoading(true)\n        setMessage(null)\n\n        try {\n            const { error } = await supabase.auth.updateUser({\n                password: password\n            })\n\n            if (error) throw error\n\n            setMessage({\n                text: 'تم تحديث كلمة المرور بنجاح! سيتم توجيهك لصفحة تسجيل الدخول.',\n                type: 'success'\n            })\n\n            setTimeout(() => {\n                router.push('/login')\n            }, 3000)\n\n        } catch (error: any) {\n            setMessage({ text: error.message, type: 'error' })\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    if (checkingSession) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n        )\n    }\n\n    if (!validSession) {\n        return (\n            <div className=\"min-h-screen flex items-center justify-center p-4\">\n                <div className=\"w-full max-w-md bg-card p-8 rounded-3xl shadow-xl text-center\">\n                    <p className=\"text-red-500 mb-4\">جلسة غير صالحة</p>\n                    <Link href=\"/forgot-password\" className=\"text-primary hover:underline\">\n                        طلب رابط استعادة جديد\n                    </Link>\n                </div>\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"min-h-screen flex items-center justify-center p-4 bg-muted/20\">\n            <div className=\"w-full max-w-md bg-card rounded-3xl shadow-xl overflow-hidden border border-border\">\n                <div className=\"p-8\">\n                    {/* Back to Home */}\n                    <Link href=\"/\" className=\"inline-flex items-center text-sm text-muted-foreground hover:text-primary transition-colors mb-6\">\n                        <ArrowRight size={16} className=\"ml-2\" />\n                        الرجوع للرئيسية\n                    </Link>\n\n                    <div className=\"text-center mb-8\">\n                        <h1 className=\"text-2xl font-bold text-foreground\">تعيين كلمة مرور جديدة</h1>\n                        <p className=\"text-muted-foreground mt-2\">\n                            الرجاء إدخال كلمة المرور الجديدة لحسابك\n                        </p>\n                    </div>\n\n                    <form onSubmit={handleUpdatePassword} className=\"space-y-4\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">كلمة المرور الجديدة</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"password\"\n                                    value={password}\n                                    onChange={(e) => setPassword(e.target.value)}\n                                    required\n                                    minLength={6}\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"••••••••\"\n                                />\n                                <Lock className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">تأكيد كلمة المرور</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"password\"\n                                    value={confirmPassword}\n                                    onChange={(e) => setConfirmPassword(e.target.value)}\n                                    required\n                                    minLength={6}\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"••••••••\"\n                                />\n                                <Lock className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        {message && (\n                            <div className={`p-4 rounded-xl text-sm flex items-center gap-2 ${message.type === 'error' ? 'bg-red-50 text-red-600 border border-red-100' : 'bg-green-50 text-green-600 border border-green-100'}`}>\n                                {message.type === 'error' ? '⚠️' : '✅'}\n                                {message.text}\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={loading}\n                            className=\"w-full bg-primary text-primary-foreground py-3.5 rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                        >\n                            {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : 'تحديث كلمة المرور'}\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/profile/support/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/signup/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1431,1434],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1431,1434],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter } from 'next/navigation'\nimport Link from 'next/link'\nimport { Loader2, Mail, Lock, User, ArrowRight, Compass } from 'lucide-react'\n\nexport default function SignUpPage() {\n    const [name, setName] = useState('')\n    const [email, setEmail] = useState('')\n    const [password, setPassword] = useState('')\n    const [loading, setLoading] = useState(false)\n    const [message, setMessage] = useState<{ text: string, type: 'error' | 'success' } | null>(null)\n\n    const router = useRouter()\n    const supabase = createClient()\n\n    const handleSignUp = async (e: React.FormEvent) => {\n        e.preventDefault()\n        setLoading(true)\n        setMessage(null)\n\n        try {\n            const { error } = await supabase.auth.signUp({\n                email,\n                password,\n                options: {\n                    data: {\n                        full_name: name,\n                    },\n                },\n            })\n\n            if (error) throw error\n\n            setMessage({\n                text: 'تم إنشاء الحساب بنجاح! يرجى التحقق من بريدك الإلكتروني لتفعيل الحساب.',\n                type: 'success'\n            })\n\n            // Optional: Redirect to login after a delay\n            setTimeout(() => {\n                router.push('/login')\n            }, 3000)\n\n        } catch (error: any) {\n            setMessage({ text: error.message, type: 'error' })\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"min-h-screen flex flex-row-reverse\">\n            {/* Left Side - Form (Right in RTL) */}\n            <div className=\"w-full lg:w-1/2 flex items-center justify-center p-8 lg:p-12 bg-background\">\n                <div className=\"w-full max-w-md space-y-8\">\n                    {/* Back to Home */}\n                    <Link href=\"/\" className=\"inline-flex items-center text-sm text-muted-foreground hover:text-primary transition-colors mb-8\">\n                        <ArrowRight size={16} className=\"ml-2\" />\n                        الرجوع للرئيسية\n                    </Link>\n\n                    <div className=\"text-center\">\n                        <h1 className=\"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-blue-600 mb-2\">\n                            إنشاء حساب جديد\n                        </h1>\n                        <p className=\"text-muted-foreground\">\n                            انضم إلينا واستمتع بتجربة كاملة في دليل السويس\n                        </p>\n                    </div>\n\n                    <form onSubmit={handleSignUp} className=\"space-y-5\">\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">الاسم الكامل</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"text\"\n                                    value={name}\n                                    onChange={(e) => setName(e.target.value)}\n                                    required\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"الاسم الثنائي\"\n                                />\n                                <User className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">البريد الإلكتروني</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"email\"\n                                    value={email}\n                                    onChange={(e) => setEmail(e.target.value)}\n                                    required\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"name@example.com\"\n                                />\n                                <Mail className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        <div className=\"space-y-2\">\n                            <label className=\"text-sm font-medium text-foreground\">كلمة المرور</label>\n                            <div className=\"relative\">\n                                <input\n                                    type=\"password\"\n                                    value={password}\n                                    onChange={(e) => setPassword(e.target.value)}\n                                    required\n                                    minLength={6}\n                                    className=\"w-full px-4 py-3 pr-10 rounded-xl border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"••••••••\"\n                                />\n                                <Lock className=\"absolute left-3 top-3.5 text-muted-foreground w-5 h-5 pointer-events-none\" />\n                            </div>\n                        </div>\n\n                        {message && (\n                            <div className={`p-4 rounded-xl text-sm flex items-center gap-2 ${message.type === 'error' ? 'bg-red-50 text-red-600 border border-red-100' : 'bg-green-50 text-green-600 border border-green-100'}`}>\n                                {message.type === 'error' ? '⚠️' : '✅'}\n                                {message.text}\n                            </div>\n                        )}\n\n                        <button\n                            type=\"submit\"\n                            disabled={loading}\n                            className=\"w-full bg-primary text-primary-foreground py-3.5 rounded-xl font-bold hover:bg-primary/90 transition-all shadow-lg shadow-primary/20 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n                        >\n                            {loading ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : 'إنشاء الحساب'}\n                        </button>\n                    </form>\n\n                    <div className=\"text-center text-sm text-muted-foreground\">\n                        لديك حساب بالفعل؟{' '}\n                        <Link href=\"/login\" className=\"font-bold text-primary hover:underline\">\n                            سجل الدخول\n                        </Link>\n                    </div>\n                </div>\n            </div>\n\n            {/* Right Side - Image/Banner (Hidden on Mobile) */}\n            <div className=\"hidden lg:block w-1/2 relative bg-slate-900\">\n                <div className=\"absolute inset-0 bg-gradient-to-bl from-primary/40 to-blue-900/60 mix-blend-multiply z-10\" />\n                {/* Fallback pattern or generic image if no specific image is available */}\n                <div className=\"absolute inset-0 bg-[url('/images/hero-bg.png')] bg-cover bg-center\" />\n\n                <div className=\"relative z-20 h-full flex flex-col justify-between p-12 text-white\">\n                    <div className=\"flex items-center gap-4\" dir=\"ltr\">\n                        <Compass className=\"w-6 h-6 text-white\" />\n                        <span className=\"text-2xl font-bold\">دليل السويس</span>\n                    </div>\n\n                    <div className=\"max-w-md\">\n                        <h2 className=\"text-4xl font-bold mb-6 leading-tight\">\n                            ابدأ رحلتك معنا اليوم\n                        </h2>\n                        <ul className=\"space-y-4 text-lg text-white/90\">\n                            <li className=\"flex items-center gap-3\">\n                                <div className=\"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-green-400\">✓</div>\n                                <span>احفظ أماكنك المفضلة</span>\n                            </li>\n                            <li className=\"flex items-center gap-3\">\n                                <div className=\"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-green-400\">✓</div>\n                                <span>شارك تقييماتك وتجاربك</span>\n                            </li>\n                            <li className=\"flex items-center gap-3\">\n                                <div className=\"w-6 h-6 rounded-full bg-green-500/20 flex items-center justify-center text-green-400\">✓</div>\n                                <span>تعرف على أحدث الفعاليات</span>\n                            </li>\n                        </ul>\n                    </div>\n\n                    <div className=\"flex items-center gap-4 text-sm text-white/60\">\n                        <span>© 2024 دليل السويس</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/(public)/terms/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/actions/categories.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/actions/translate.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/NotificationBell.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/ai-sync-button.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[738,741],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[738,741],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { Button } from '@/presentation/ui/button'\nimport { RefreshCw, Bot } from 'lucide-react'\nimport { toast } from 'sonner'\n\nexport function AiSyncButton() {\n    const [loading, setLoading] = useState(false)\n\n    const handleSync = async () => {\n        setLoading(true)\n        const toastId = toast.loading('جاري تحديث قاعدة المعرفة...')\n\n        try {\n            const res = await fetch('/api/admin/embeddings', { method: 'POST' })\n            const data = await res.json()\n\n            if (!res.ok) {\n                throw new Error(data.error || 'فشل التحديث')\n            }\n\n            toast.success(`تم تحديث ${data.processed} مكان بنجاح`, { id: toastId })\n        } catch (err: any) {\n            console.error(err)\n            toast.error(err.message || 'حدث خطأ أثناء التحديث', { id: toastId })\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"bg-slate-900 border border-slate-800 rounded-2xl p-6 shadow-sm flex items-center justify-between\">\n            <div className=\"flex items-center gap-4\">\n                <div className=\"w-12 h-12 rounded-xl bg-purple-500/10 border border-purple-500/20 flex items-center justify-center\">\n                    <Bot className=\"text-purple-400\" size={24} />\n                </div>\n                <div>\n                    <h3 className=\"text-lg font-bold text-white\">المساعد الذكي (AI)</h3>\n                    <p className=\"text-slate-400 text-sm\">تحديث قاعدة المعرفة لبيانات الشات بوت</p>\n                </div>\n            </div>\n            <Button\n                onClick={handleSync}\n                disabled={loading}\n                variant=\"outline\"\n                className=\"border-purple-500/20 bg-transparent hover:bg-purple-500/10 hover:text-purple-400 text-slate-300 gap-2\"\n            >\n                <RefreshCw className={loading ? 'animate-spin' : ''} size={16} />\n                {loading ? 'جاري التحديث...' : 'تحديث البيانات'}\n            </Button>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/categories/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/categories/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/categories/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/events/[id]/edit/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'getAdminEventsUseCase' is defined but never used.","line":2,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":54,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"getAdminEventsUseCase"},"fix":{"range":[83,106],"text":""},"desc":"Remove unused variable \"getAdminEventsUseCase\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server'\nimport { getAdminPlacesUseCase, getAdminEventsUseCase } from '@/di/modules'\nimport { CreateEventForm } from '@/presentation/components/admin/create-event-form' // We can reuse the form if we add initialData\nimport { ChevronRight } from 'lucide-react'\nimport Link from 'next/link'\nimport { notFound } from 'next/navigation'\n\nexport default async function EditEventPage({ params }: { params: Promise<{ id: string }> }) {\n    const { id } = await params\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n    if (!user) return null\n\n    const { data: profile } = await supabase\n        .from('profiles')\n        .select('role')\n        .eq('id', user.id)\n        .single()\n\n    if (profile?.role !== 'super_admin') return <div>Unauthorized</div>\n\n    // Fetch Event, Places\n    const [event, places] = await Promise.all([\n        supabase.from('events').select('*').eq('id', id).single().then(res => res.data),\n        getAdminPlacesUseCase.execute(user.id, profile.role, {})\n    ])\n\n    if (!event) return notFound()\n\n    return (\n        <div className=\"max-w-4xl mx-auto space-y-8\" dir=\"rtl\">\n            <div className=\"flex items-center gap-4\">\n                <Link href=\"/admin/events\" className=\"p-2 bg-slate-900 border border-slate-800 rounded-xl text-slate-400 hover:text-primary transition-colors\">\n                    <ChevronRight size={20} />\n                </Link>\n                <div>\n                    <h1 className=\"text-3xl font-bold text-slate-100\">تعديل الفعالية</h1>\n                    <p className=\"text-slate-500\">قم بتحديث بيانات الفعالية أدناه</p>\n                </div>\n            </div>\n\n            <CreateEventForm places={places} initialData={event} />\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/events/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/events/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":1,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":29,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"User"},"fix":{"range":[22,28],"text":""},"desc":"Remove unused variable \"User\"."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":33,"column":29,"nodeType":"JSXOpeningElement","endLine":33,"endColumn":106}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Search, Globe, User } from 'lucide-react'\nimport Link from 'next/link'\nimport { NotificationBell } from './NotificationBell'\nimport { createClient } from '@/lib/supabase/server'\n\nexport async function AdminHeader() {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    const avatarUrl = user?.user_metadata?.avatar_url\n    const userName = user?.user_metadata?.full_name || user?.email || 'Admin'\n    const fallbackLetter = userName[0].toUpperCase()\n\n    return (\n        <header className=\"flex items-center justify-between h-16 px-8 pr-16 md:pr-8 border-b border-slate-800 bg-slate-900 text-white\">\n            <div className=\"flex items-center gap-4\">\n                <h2 className=\"text-xl font-bold\">لوحة التحكم</h2>\n            </div>\n\n            <div className=\"flex items-center gap-4\">\n                <Link href=\"/\" target=\"_blank\" className=\"p-2 text-slate-400 hover:text-white rounded-full hover:bg-slate-800 transition-colors\" title=\"عرض الموقع\">\n                    <Globe size={20} />\n                </Link>\n                <button className=\"p-2 text-slate-400 hover:text-white rounded-full hover:bg-slate-800 transition-colors\">\n                    <Search size={20} />\n                </button>\n\n                <NotificationBell />\n\n                <Link href=\"/admin/profile\" className=\"flex items-center gap-3 pl-2\">\n                    <div className=\"w-8 h-8 rounded-full bg-primary overflow-hidden flex items-center justify-center text-sm font-bold border border-slate-700\">\n                        {avatarUrl ? (\n                            <img src={avatarUrl} alt={userName} className=\"w-full h-full object-cover\" />\n                        ) : (\n                            fallbackLetter\n                        )}\n                    </div>\n                </Link>\n            </div>\n        </header>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/notifications/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/places/[id]/edit/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/places/actions.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'redirect' is defined but never used.","line":6,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":18,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"redirect"},"fix":{"range":[201,243],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1880,1883],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1880,1883],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":89,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":89,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3125,3128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3125,3128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3701,3704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3701,3704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use server'\n\nimport { createClient } from '@/lib/supabase/server'\nimport { createPlaceUseCase, deletePlaceUseCase, updatePlaceUseCase } from '@/di/modules'\nimport { revalidatePath } from 'next/cache'\nimport { redirect } from 'next/navigation'\n\nexport type ActionState = {\n    message?: string\n    errors?: Record<string, string[]>\n    success?: boolean\n}\n\nexport async function createPlaceAction(prevState: ActionState, formData: FormData): Promise<ActionState> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) {\n        return { success: false, message: 'Unauthorized' }\n    }\n\n    const name = formData.get('name') as string\n    const categoryId = formData.get('category_id') as string\n\n    // Basic Validation\n    const errors: Record<string, string[]> = {}\n    if (!name) errors.name = ['Name is required']\n    if (!categoryId) errors.category_id = ['Category is required']\n\n    if (Object.keys(errors).length > 0) {\n        return { success: false, message: 'برجاء التأكد من البيانات المدخلة', errors }\n    }\n\n    const slug = name.toLowerCase().replace(/ /g, '-') + '-' + Math.floor(Math.random() * 1000)\n\n    try {\n        await createPlaceUseCase.execute({\n            name,\n            slug,\n            categoryId,\n            address: formData.get('address') as string,\n            description: formData.get('description') as string,\n            phone: formData.get('phone') as string,\n            whatsapp: formData.get('whatsapp') as string,\n            googleMapsUrl: formData.get('google_maps_url') as string,\n            opensAt: formData.get('opens_at') as string,\n            closesAt: formData.get('closes_at') as string,\n            images: [],\n        }, user.id)\n\n        revalidatePath('/admin/places')\n        return { success: true, message: 'تم حفظ المكان بنجاح' }\n    } catch (e: any) {\n        console.error(e)\n        return { success: false, message: e.message || 'فشل في حفظ المكان' }\n    }\n}\n\nexport async function updatePlaceAction(id: string, prevState: ActionState, formData: FormData): Promise<ActionState> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) {\n        return { success: false, message: 'Unauthorized' }\n    }\n\n    const name = formData.get('name') as string\n    const categoryId = formData.get('category_id') as string\n\n    const errors: Record<string, string[]> = {}\n    if (!name) errors.name = ['Name is required']\n    if (!categoryId) errors.category_id = ['Category is required']\n\n    if (Object.keys(errors).length > 0) {\n        return { success: false, message: 'برجاء التأكد من البيانات المدخلة', errors }\n    }\n\n    try {\n        await updatePlaceUseCase.execute(id, {\n            name,\n            categoryId,\n            address: formData.get('address') as string,\n            description: formData.get('description') as string,\n            phone: formData.get('phone') as string,\n        })\n\n        revalidatePath('/admin/places')\n        return { success: true, message: 'تم تحديث البيانات بنجاح' }\n    } catch (e: any) {\n        console.error(e)\n        return { success: false, message: e.message || 'فشل في تحديث البيانات' }\n    }\n}\n\nexport async function deletePlaceAction(placeId: string): Promise<ActionState> {\n    const supabase = await createClient()\n    const { data: { user } } = await supabase.auth.getUser()\n\n    if (!user) {\n        return { success: false, message: 'Unauthorized' }\n    }\n\n    try {\n        await deletePlaceUseCase.execute(placeId, supabase)\n        revalidatePath('/admin/places')\n        return { success: true, message: 'تم الحذف بنجاح' }\n    } catch (e: any) {\n        console.error('SERVER ACTION ERROR:', e)\n        return { success: false, message: e.message || 'فشل الحذف' }\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/places/new/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/places/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/profile/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/settings/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/settings/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'X' is defined but never used.","line":4,"column":70,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":71,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"X"},"fix":{"range":[125,128],"text":""},"desc":"Remove unused variable \"X\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'mounted' is assigned a value but never used.","line":15,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setMounted' is assigned a value but never used.","line":15,"column":21,"nodeType":"Identifier","messageId":"unusedVar","endLine":15,"endColumn":31},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":222,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10351,10354],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10351,10354],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":247,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":247,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11107,11110],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11107,11110],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Save, Loader2, Settings2, Globe, Phone, List, Shield, Plus, X, Trash2 } from \"lucide-react\"\nimport { getSettingsAction, updateSettingsAction } from \"@/actions/admin/settings.actions\"\nimport { Setting } from \"@/domain/entities/setting\"\nimport { toast } from 'sonner'\n\nexport default function AdminSettingsPage() {\n    const [settings, setSettings] = useState<Setting[]>([])\n    const [loading, setLoading] = useState(true)\n    const [saving, setSaving] = useState(false)\n    const [unsavedChanges, setUnsavedChanges] = useState<Record<string, string>>({})\n    const [activeTab, setActiveTab] = useState('general')\n    const [mounted, setMounted] = useState(false) // Added mounted state\n\n    const loadSettings = async () => {\n        setLoading(true)\n        const result = await getSettingsAction()\n        if (result.success && result.data) {\n            setSettings(result.data)\n        } else {\n            toast.error(\"فشل تحميل الإعدادات\")\n        }\n        setLoading(false)\n    }\n\n    useEffect(() => {\n        // Use a tick to avoid \"setState in effect\" warning\n        setTimeout(() => loadSettings(), 0)\n    }, [])\n\n    const handleChange = (key: string, value: string) => {\n        setSettings(prev => prev.map(s => s.key === key ? { ...s, value } : s))\n        setUnsavedChanges(prev => ({ ...prev, [key]: value }))\n    }\n\n    const handleSave = async () => {\n        if (Object.keys(unsavedChanges).length === 0) return\n\n        setSaving(true)\n        const result = await updateSettingsAction(unsavedChanges)\n\n        if (result.success) {\n            toast.success(result.message)\n            setUnsavedChanges({})\n        } else {\n            toast.error(result.message || \"فشل الحفظ\")\n        }\n        setSaving(false)\n    }\n\n    // Helper to group settings\n    const getGroup = (group: string) => settings.filter(s => s.group === group)\n\n    if (loading) {\n        return <div className=\"p-12 text-center text-slate-500 flex justify-center\"><Loader2 className=\"animate-spin\" /></div>\n    }\n\n    const tabs = [\n        { id: 'general', label: 'عامة', icon: Globe },\n        { id: 'contact', label: 'التواصل', icon: Phone },\n        { id: 'menus', label: 'القوائم', icon: List },\n        { id: 'system', label: 'النظام', icon: Shield },\n    ]\n\n    return (\n        <div className=\"space-y-6 max-w-5xl mx-auto pb-20\">\n            {/* Header */}\n            <div className=\"flex flex-col sm:flex-row justify-between items-start sm:items-center bg-slate-900 border border-slate-800 p-6 rounded-2xl gap-4\">\n                <div>\n                    <h1 className=\"text-2xl font-bold text-white flex items-center gap-2\">\n                        <Settings2 className=\"text-primary\" />\n                        إعدادات الموقع\n                    </h1>\n                    <p className=\"text-slate-400 text-sm mt-1\">التحكم في بيانات الموقع، القوائم، والصيانة</p>\n                </div>\n                <button\n                    onClick={handleSave}\n                    disabled={saving || Object.keys(unsavedChanges).length === 0}\n                    className=\"bg-primary hover:bg-primary/90 text-white px-6 py-2.5 rounded-xl font-medium flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                >\n                    {saving ? <Loader2 className=\"animate-spin h-5 w-5\" /> : <Save className=\"h-5 w-5\" />}\n                    حفظ التغييرات\n                </button>\n            </div>\n\n            {/* Custom Tabs */}\n            <div className=\"grid grid-cols-4 bg-slate-900 p-1 rounded-xl mb-6 border border-slate-800\">\n                {tabs.map(tab => (\n                    <button\n                        key={tab.id}\n                        onClick={() => setActiveTab(tab.id)}\n                        className={`\n                            flex items-center justify-center gap-2 py-3 rounded-lg text-sm font-medium transition-colors\n                            ${activeTab === tab.id\n                                ? 'bg-slate-800 text-white shadow-sm'\n                                : 'text-slate-400 hover:text-white hover:bg-slate-800/50'}\n                        `}\n                    >\n                        <tab.icon className=\"w-4 h-4\" />\n                        <span className=\"hidden sm:inline\">{tab.label}</span>\n                    </button>\n                ))}\n            </div>\n\n            {/* Tab Content */}\n            <div className=\"bg-slate-900 border border-slate-800 rounded-2xl p-6\">\n\n                {/* General Tab */}\n                {activeTab === 'general' && (\n                    <div className=\"space-y-6\">\n                        <div className=\"mb-6\">\n                            <h2 className=\"text-xl font-bold text-white\">البيانات الأساسية</h2>\n                            <p className=\"text-slate-400 text-sm\">تظهر هذه البيانات في العناوين ومحركات البحث</p>\n                        </div>\n                        {getGroup('general').map(setting => (\n                            <SettingInput key={setting.key} setting={setting} onChange={handleChange} />\n                        ))}\n                    </div>\n                )}\n\n                {/* Contact Tab */}\n                {activeTab === 'contact' && (\n                    <div className=\"space-y-6\">\n                        <div className=\"mb-6\">\n                            <h2 className=\"text-xl font-bold text-white\">معلومات الاتصال</h2>\n                            <p className=\"text-slate-400 text-sm\">تظهر في الفوتر وصفحة اتصل بنا</p>\n                        </div>\n                        {getGroup('contact').filter(s => s.type !== 'json').map(setting => (\n                            <SettingInput key={setting.key} setting={setting} onChange={handleChange} />\n                        ))}\n                    </div>\n                )}\n\n                {/* Menus Tab */}\n                {activeTab === 'menus' && (\n                    <div className=\"space-y-8\">\n                        <div className=\"mb-6\">\n                            <h2 className=\"text-xl font-bold text-white\">بناء القوائم</h2>\n                            <p className=\"text-slate-400 text-sm\">التحكم في الروابط المعروضة في الفوتر</p>\n                        </div>\n                        {/* Special handling for JSON menus including Social Links which are technically 'contact' group but 'json' type */}\n                        {getGroup('menus').concat(getGroup('contact').filter(s => s.type === 'json')).map(setting => (\n                            <div key={setting.key} className=\"space-y-4 pt-6 border-t border-slate-800 first:border-0 first:pt-0\">\n                                <div>\n                                    <label className=\"block text-white font-medium mb-1\">{setting.label}</label>\n                                    <p className=\"text-xs text-slate-500\">{setting.description}</p>\n                                </div>\n                                <MenuBuilder\n                                    initialValue={setting.value}\n                                    onChange={(newJson) => handleChange(setting.key, newJson)}\n                                />\n                            </div>\n                        ))}\n                    </div>\n                )}\n\n                {/* System Tab */}\n                {activeTab === 'system' && (\n                    <div className=\"space-y-6\">\n                        <div className=\"mb-6\">\n                            <h2 className=\"text-xl font-bold text-white\">إعدادات النظام</h2>\n                            <p className=\"text-slate-400 text-sm\">خيارات متقدمة للتحكم في الموقع</p>\n                        </div>\n                        {getGroup('system').map(setting => (\n                            <SettingInput key={setting.key} setting={setting} onChange={handleChange} />\n                        ))}\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}\n\n// Sub-components with Raw HTML/Tailwind\n\nfunction SettingInput({ setting, onChange }: { setting: Setting, onChange: (k: string, v: string) => void }) {\n    if (setting.type === 'boolean') {\n        const isChecked = setting.value === 'true';\n        return (\n            <div className=\"flex items-center justify-between p-4 bg-slate-950 rounded-xl border border-slate-800\">\n                <div className=\"space-y-0.5\">\n                    <label className=\"text-base text-slate-200 font-medium\">{setting.label}</label>\n                    <p className=\"text-xs text-slate-500\">{setting.description}</p>\n                </div>\n                {/* Custom Switch Toggle */}\n                <button\n                    onClick={() => onChange(setting.key, (!isChecked).toString())}\n                    className={`w-11 h-6 rounded-full transition-colors relative ${isChecked ? 'bg-primary' : 'bg-slate-700'}`}\n                >\n                    <span className={`block w-4 h-4 bg-white rounded-full absolute top-1 transition-transform ${isChecked ? 'left-1' : 'right-1'}`} />\n                </button>\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"space-y-2\">\n            <label className=\"block text-sm font-medium text-slate-300\">{setting.label}</label>\n            {setting.key.includes('description') ? (\n                <textarea\n                    value={setting.value || ''}\n                    onChange={(e) => onChange(setting.key, e.target.value)}\n                    className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors min-h-[100px]\"\n                />\n            ) : (\n                <input\n                    type=\"text\"\n                    value={setting.value || ''}\n                    onChange={(e) => onChange(setting.key, e.target.value)}\n                    className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors\"\n                    dir=\"auto\"\n                />\n            )}\n            <p className=\"text-xs text-slate-500\">{setting.description}</p>\n        </div>\n    )\n}\n\nfunction MenuBuilder({ initialValue, onChange }: { initialValue: string, onChange: (val: string) => void }) {\n    const [items, setItems] = useState<any[]>(() => {\n        try {\n            const parsed = JSON.parse(initialValue || '[]')\n            return Array.isArray(parsed) ? parsed : []\n        } catch {\n            return []\n        }\n    })\n\n    useEffect(() => {\n        if (!initialValue) return\n        try {\n            const parsed = JSON.parse(initialValue)\n            const currentJson = JSON.stringify(items)\n            if (JSON.stringify(parsed) !== currentJson) {\n                // Use a tick to avoid synchronous setState warning\n                setTimeout(() => {\n                    setItems(Array.isArray(parsed) ? parsed : [])\n                }, 0)\n            }\n        } catch {\n            // ignore\n        }\n    }, [initialValue, items])\n\n    const updateJson = (newItems: any[]) => {\n        setItems(newItems)\n        onChange(JSON.stringify(newItems))\n    }\n\n    const addItem = () => {\n        updateJson([...items, { label: 'رابط جديد', url: '/' }])\n    }\n\n    const removeItem = (index: number) => {\n        const newItems = [...items]\n        newItems.splice(index, 1)\n        updateJson(newItems)\n    }\n\n    const updateItem = (index: number, field: string, value: string) => {\n        const newItems = [...items]\n        newItems[index] = { ...newItems[index], [field]: value }\n        updateJson(newItems)\n    }\n\n    return (\n        <div className=\"bg-slate-950 rounded-xl border border-slate-800 p-4 space-y-3\">\n            {items.map((item, idx) => (\n                <div key={idx} className=\"flex flex-col md:flex-row gap-2 items-start bg-slate-900/50 p-3 rounded-lg border border-slate-800/50\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-2 flex-1 w-full\">\n                        <input\n                            placeholder=\"النص (الاسم)\"\n                            value={item.label || item.platform || ''}\n                            onChange={(e) => updateItem(idx, item.label ? 'label' : 'platform', e.target.value)}\n                            className=\"bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white outline-none focus:border-primary/50\"\n                        />\n                        <input\n                            placeholder=\"الرابط (URL)\"\n                            value={item.url}\n                            onChange={(e) => updateItem(idx, 'url', e.target.value)}\n                            className=\"bg-slate-950 border border-slate-700 rounded-lg px-3 py-2 text-sm text-white outline-none focus:border-primary/50 text-left ltr\"\n                            dir=\"ltr\"\n                        />\n                    </div>\n                    <button\n                        onClick={() => removeItem(idx)}\n                        className=\"p-2 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-colors self-end md:self-center\"\n                    >\n                        <Trash2 size={18} />\n                    </button>\n                </div>\n            ))}\n            <button\n                onClick={addItem}\n                className=\"w-full py-3 border border-dashed border-slate-700 rounded-xl text-slate-400 hover:text-white hover:bg-slate-800 transition-colors flex items-center justify-center gap-2 text-sm font-medium\"\n            >\n                <Plus size={16} />\n                إضافة عنصر جديد\n            </button>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/sidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/support/[id]/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/support/admin-ticket-chat.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCheck' is defined but never used.","line":4,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":41,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCheck"},"fix":{"range":[94,106],"text":""},"desc":"Remove unused variable \"CheckCheck\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[616,619],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[616,619],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[641,644],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[641,644],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":145,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":145,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5605,5608],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5605,5608],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useRef, useEffect } from 'react'\nimport { Send, User, Loader2, CheckCheck, ShieldAlert } from 'lucide-react'\nimport { formatDistanceToNow } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport { replyAsAdmin, updateTicketStatus, getAdminTicketMessages } from '@/actions/admin-support.actions'\nimport { cn } from '@/lib/utils'\nimport { ScrollArea } from '@/presentation/ui/scroll-area'\nimport { Badge } from '@/presentation/ui/badge'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter } from 'next/navigation'\n\ninterface AdminTicketChatProps {\n    ticket: any\n    initialMessages: any[]\n}\n\nexport function AdminTicketChat({ ticket, initialMessages }: AdminTicketChatProps) {\n    const [messages, setMessages] = useState(initialMessages)\n    const [newMessage, setNewMessage] = useState('')\n    const [sending, setSending] = useState(false)\n    const [updatingStatus, setUpdatingStatus] = useState(false)\n    const scrollRef = useRef<HTMLDivElement>(null)\n    const router = useRouter()\n    const supabase = createClient()\n\n    useEffect(() => {\n        if (scrollRef.current) {\n            scrollRef.current.scrollIntoView({ behavior: \"smooth\" })\n        }\n    }, [messages])\n\n    // Realtime subscription & Polling fallback\n    useEffect(() => {\n        const fetchMessages = async () => {\n            try {\n                const latestMessages = await getAdminTicketMessages(ticket.id)\n                if (latestMessages) {\n                    setMessages(prev => {\n                        // Simple check to avoid creating new array if length is same\n                        // Ideally we check IDs, but this is a decent heuristic for chat\n                        if (prev.length === latestMessages.length) return prev\n                        return latestMessages\n                    })\n                }\n            } catch (error) {\n                console.error('Polling error:', error)\n            }\n        }\n\n        // Poll every 5 seconds\n        const interval = setInterval(fetchMessages, 5000)\n\n        // Keep Realtime as well for instant updates if it works\n        const channel = supabase\n            .channel(`ticket_chat_${ticket.id}`)\n            .on(\n                'postgres_changes',\n                {\n                    event: 'INSERT',\n                    schema: 'public',\n                    table: 'support_messages',\n                    filter: `ticket_id=eq.${ticket.id}`\n                },\n                (payload) => {\n                    const newMsg = payload.new\n                    setMessages(prev => {\n                        if (prev.find(m => m.id === newMsg.id)) return prev\n                        return [...prev, newMsg]\n                    })\n                    router.refresh()\n                }\n            )\n            .subscribe()\n\n        return () => {\n            clearInterval(interval)\n            supabase.removeChannel(channel)\n        }\n    }, [ticket.id, router, supabase])\n\n    const handleSendMessage = async (e: React.FormEvent) => {\n        e.preventDefault()\n        if (!newMessage.trim()) return\n\n        setSending(true)\n        try {\n            await replyAsAdmin(ticket.id, newMessage)\n            setNewMessage('')\n            // Optimistic update handled by realtime or refresh\n        } catch (error) {\n            console.error('Failed to send message:', error)\n            alert('فشل إرسال الرسالة')\n        } finally {\n            setSending(false)\n        }\n    }\n\n    const handleStatusChange = async (status: string) => {\n        setUpdatingStatus(true)\n        try {\n            await updateTicketStatus(ticket.id, status)\n            router.refresh()\n        } catch (error) {\n            console.error('Failed to update status:', error)\n            alert('فشل تحديث الحالة')\n        } finally {\n            setUpdatingStatus(false)\n        }\n    }\n\n    return (\n        <div className=\"flex flex-col h-[650px] border border-slate-800 rounded-xl bg-slate-900 overflow-hidden shadow-sm\">\n            {/* Chat Header */}\n            <div className=\"p-4 border-b border-slate-800 bg-slate-900 flex items-center justify-between\">\n                <div>\n                    <h2 className=\"font-bold flex items-center gap-2 text-slate-100\">\n                        {ticket.subject}\n                        <Badge variant=\"outline\" className=\"border-slate-700 text-slate-400\">{ticket.category}</Badge>\n                    </h2>\n                    <p className=\"text-sm text-slate-400 mt-1\">\n                        المستخدم: {ticket.profiles?.full_name}\n                    </p>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                    <select\n                        value={ticket.status}\n                        onChange={(e) => handleStatusChange(e.target.value)}\n                        disabled={updatingStatus}\n                        className=\"text-sm border border-slate-700 rounded-md px-2 py-1 bg-slate-950 text-slate-200 focus:ring-2 focus:ring-primary/50 outline-none\"\n                    >\n                        <option value=\"open\">مفتوح</option>\n                        <option value=\"in_progress\">قيد المعالجة</option>\n                        <option value=\"resolved\">تم الحل</option>\n                        <option value=\"closed\">مغلق</option>\n                    </select>\n                </div>\n            </div>\n\n            {/* Messages Area */}\n            <ScrollArea className=\"flex-1 bg-slate-950/50\">\n                <div className=\"p-4 space-y-4\">\n                    {messages.map((msg: any) => {\n                        const isAdmin = msg.is_admin\n\n                        return (\n                            <div\n                                key={msg.id}\n                                className={cn(\n                                    \"flex w-full mb-4\",\n                                    isAdmin ? \"justify-end\" : \"justify-start\"\n                                )}\n                            >\n                                <div className={cn(\n                                    \"flex max-w-[80%] gap-3\",\n                                    isAdmin ? \"flex-row-reverse\" : \"flex-row\"\n                                )}>\n                                    <div className={cn(\n                                        \"w-8 h-8 rounded-full flex items-center justify-center shrink-0 mt-1\",\n                                        isAdmin ? \"bg-primary text-white\" : \"bg-slate-800 text-slate-400\"\n                                    )}>\n                                        {isAdmin ? <ShieldAlert size={16} /> : <User size={16} />}\n                                    </div>\n\n                                    <div className={cn(\n                                        \"p-3 rounded-2xl text-sm relative group\",\n                                        isAdmin\n                                            ? \"bg-primary text-white rounded-tr-sm\"\n                                            : \"bg-slate-800 text-slate-200 rounded-tl-sm\"\n                                    )}>\n                                        <p className=\"whitespace-pre-wrap leading-relaxed\">{msg.message}</p>\n\n                                        <div className={cn(\n                                            \"text-[10px] mt-1 opacity-70 flex items-center gap-1\",\n                                            isAdmin ? \"text-white/70\" : \"text-slate-400\"\n                                        )}>\n                                            {formatDistanceToNow(new Date(msg.created_at), { addSuffix: true, locale: ar })}\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        )\n                    })}\n                    <div ref={scrollRef} />\n                </div>\n            </ScrollArea>\n\n            {/* Input Area */}\n            <form onSubmit={handleSendMessage} className=\"p-4 border-t border-slate-800 bg-slate-900\">\n                <div className=\"flex gap-2\">\n                    <input\n                        type=\"text\"\n                        value={newMessage}\n                        onChange={(e) => setNewMessage(e.target.value)}\n                        placeholder=\"اكتب ردك هنا...\"\n                        className=\"flex-1 px-4 py-2 rounded-xl border border-slate-700 bg-slate-950 text-slate-100 focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all placeholder:text-slate-500\"\n                        disabled={sending}\n                    />\n                    <button\n                        type=\"submit\"\n                        disabled={!newMessage.trim() || sending}\n                        className=\"bg-primary text-white p-2 rounded-xl hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed w-10 h-10 flex items-center justify-center\"\n                    >\n                        {sending ? <Loader2 size={20} className=\"animate-spin\" /> : <Send size={20} className={ar ? \"rotate-180\" : \"\"} />}\n                    </button>\n                </div>\n            </form>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/support/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle2' is defined but never used.","line":7,"column":32,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":44,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle2"},"fix":{"range":[300,314],"text":""},"desc":"Remove unused variable \"CheckCircle2\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AlertCircle' is defined but never used.","line":7,"column":46,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":57,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AlertCircle"},"fix":{"range":[314,327],"text":""},"desc":"Remove unused variable \"AlertCircle\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2655,2658],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2655,2658],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getAllTickets } from '@/actions/admin-support.actions'\nimport { Badge } from '@/presentation/ui/badge'\nimport { Card } from '@/presentation/ui/card'\nimport { formatDistanceToNow } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport Link from 'next/link'\nimport { MessageSquare, Clock, CheckCircle2, AlertCircle } from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\n// Force dynamic rendering to ensure fresh data\nexport const dynamic = 'force-dynamic'\n\nexport default async function AdminSupportPage() {\n    const tickets = await getAllTickets()\n\n    const getStatusColor = (status: string) => {\n        switch (status) {\n            case 'open': return 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20'\n            case 'in_progress': return 'bg-blue-500/10 text-blue-500 border-blue-500/20'\n            case 'resolved': return 'bg-green-500/10 text-green-500 border-green-500/20'\n            case 'closed': return 'bg-slate-500/10 text-slate-500 border-slate-500/20'\n            default: return 'bg-slate-500/10 text-slate-500'\n        }\n    }\n\n    const getStatusLabel = (status: string) => {\n        switch (status) {\n            case 'open': return 'مفتوح'\n            case 'in_progress': return 'قيد المعالجة'\n            case 'resolved': return 'تم الحل'\n            case 'closed': return 'مغلق'\n            default: return status\n        }\n    }\n\n    const getPriorityColor = (priority: string) => {\n        switch (priority) {\n            case 'urgent': return 'text-red-500 bg-red-500/10'\n            case 'high': return 'text-orange-500 bg-orange-500/10'\n            case 'normal': return 'text-blue-500 bg-blue-500/10'\n            case 'low': return 'text-slate-500 bg-slate-500/10'\n            default: return 'text-slate-500'\n        }\n    }\n\n    return (\n        <div className=\"w-full space-y-6\">\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h1 className=\"text-2xl font-bold mb-2 text-slate-100\">تذاكر الدعم الفني</h1>\n                    <p className=\"text-slate-400\">إدارة ومتابعة تذاكر الدعم الفني للمستخدمين</p>\n                </div>\n                <div className=\"flex gap-2\">\n                    {/* Add filters here if needed */}\n                </div>\n            </div>\n\n            <div className=\"flex flex-col gap-4\">\n                {tickets?.length === 0 ? (\n                    <div className=\"text-center py-12 text-slate-500 bg-slate-900 rounded-xl border border-dashed border-slate-800\">\n                        لا توجد تذاكر دعم فني حالياً\n                    </div>\n                ) : (\n                    tickets?.map((ticket: any) => (\n                        <Link key={ticket.id} href={`/admin/support/${ticket.id}`} className=\"block group\">\n                            <Card className=\"p-4 bg-slate-900 border-slate-800 hover:border-primary/50 transition-colors relative overflow-hidden group-hover:shadow-md\">\n                                <div className=\"flex items-start justify-between gap-4\">\n                                    <div className=\"flex items-start gap-4 flex-1 min-w-0\">\n                                        <div className=\"w-10 h-10 rounded-full bg-slate-800 flex items-center justify-center text-primary font-bold shrink-0 border border-slate-700\">\n                                            {ticket.profiles?.full_name?.[0] || '?'}\n                                        </div>\n                                        <div className=\"flex-1 min-w-0\">\n                                            <div className=\"flex items-center gap-2 mb-1 flex-wrap\">\n                                                <h3 className=\"font-bold text-lg text-slate-200 group-hover:text-primary transition-colors truncate\">\n                                                    {ticket.subject}\n                                                </h3>\n                                                <Badge variant=\"outline\" className={cn(\"border-0 shrink-0\", getStatusColor(ticket.status))}>\n                                                    {getStatusLabel(ticket.status)}\n                                                </Badge>\n                                                <Badge variant=\"secondary\" className={cn(\"shrink-0\", getPriorityColor(ticket.priority))}>\n                                                    {ticket.priority}\n                                                </Badge>\n                                            </div>\n                                            <div className=\"flex items-center gap-4 text-sm text-slate-400 flex-wrap\">\n                                                <span className=\"flex items-center gap-1 shrink-0\">\n                                                    <MessageSquare size={14} />\n                                                    {ticket.category}\n                                                </span>\n                                                <span className=\"flex items-center gap-1 shrink-0\">\n                                                    <Clock size={14} />\n                                                    {formatDistanceToNow(new Date(ticket.created_at), { addSuffix: true, locale: ar })}\n                                                </span>\n                                                <span className=\"truncate\">\n                                                    بواسطة: {ticket.profiles?.full_name || 'مستخدم غير معروف'}\n                                                </span>\n                                            </div>\n                                        </div>\n                                    </div>\n\n                                    {ticket.messages?.[0]?.count > 0 && (\n                                        <div className=\"flex items-center gap-1 text-xs font-medium bg-slate-800 text-slate-300 border border-slate-700 px-2 py-1 rounded-full shrink-0\">\n                                            <span>{ticket.messages[0].count}</span>\n                                            <span>رسالة</span>\n                                        </div>\n                                    )}\n                                </div>\n                            </Card>\n                        </Link>\n                    ))\n                )}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/users/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/admin/users/page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'User' is defined but never used.","line":2,"column":15,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":19,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"User"},"fix":{"range":[70,120],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getUsersUseCase, getCurrentUserUseCase } from '@/di/modules'\nimport type { User } from '@/domain/entities/user'\nimport UsersClientPage from '@/presentation/components/admin/UsersClientPage'\nimport { createClient } from '@/lib/supabase/server'\nimport { redirect } from 'next/navigation'\n\nexport const dynamic = 'force-dynamic'\n\nexport default async function UsersPage() {\n    const supabase = await createClient()\n\n    // 1. Get Current User and Role using Use Case\n    const currentUser = await getCurrentUserUseCase.execute(supabase)\n\n    if (!currentUser) {\n        redirect('/login')\n    }\n\n    // 2. Check permissions (Super Admin only)\n    if (currentUser.role !== 'super_admin') {\n        redirect('/admin')\n    }\n\n    // 3. Fetch users using Use Case\n    const users = await getUsersUseCase.execute(supabase)\n\n    return (\n        <UsersClientPage\n            initialUsers={users}\n            currentUserRole={currentUser.role}\n        />\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/api/admin/embeddings/route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'req' is defined but never used.","line":6,"column":28,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from '@/lib/supabase/server'\nimport { NextResponse } from 'next/server'\nimport { google } from '@ai-sdk/google'\nimport { embed } from 'ai'\n\nexport async function POST(req: Request) {\n    try {\n        const supabase = await createClient()\n\n        // 1. Check Auth & Admin Role\n        const { data: { user } } = await supabase.auth.getUser()\n        if (!user) {\n            return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n        }\n\n\n        // Verifying admin role (simplified check)\n        // In a real app, you should check a `profiles` table or custom claims\n        // checking if email ends with specific domain or is in allowlist, \n        // OR better: check if specific public.users table has role 'admin'\n        // For now, assuming authorized if logged in for this MVP step.\n\n        // 2. Fetch Approved Places\n        // We assume relationships 'categories' and 'sub_categories' exist.\n        // If exact foreign key names differ, this might fail, but standard convention suggests plural table names.\n        const { data: places, error: placesError } = await supabase\n            .from('places')\n            .select(`\n        id,\n        slug,\n        name,\n        description,\n        address,\n        phone,\n        whatsapp,\n        website,\n        rating,\n        review_count,\n        google_maps_url,\n        working_hours,\n        opens_at,\n        closes_at,\n        categories (name)\n      `)\n            .eq('status', 'active') // Only embed active places\n\n        if (placesError) {\n            console.error('Error fetching places:', placesError)\n            return NextResponse.json({ error: placesError.message }, { status: 500 })\n        }\n\n        if (!places || places.length === 0) {\n            return NextResponse.json({ message: 'No places found to process' })\n        }\n\n        let processedCount = 0\n        const errors: { place: string; error: string }[] = []\n\n        // 3. Process Each Place\n        // Batch processing would be better for scaling, but for ~100 places sequential is fine.\n        for (const place of places) {\n            // Construct rich text for embedding context\n            const categoryObj = place.categories as unknown as { name: string } | { name: string }[] | null\n            const categoryName = Array.isArray(categoryObj) ? (categoryObj[0] as { name: string } | undefined)?.name : (categoryObj as { name: string } | null)?.name || ''\n\n            const content = `[بيانات المكان]\nالاسم: ${place.name}\nالفئة: ${categoryName}\nالرابط (Slug): ${place.slug}\nالعنوان: ${place.address}\nالهاتف: ${place.phone || 'غير متاح'}\nواتساب: ${place.whatsapp || 'غير متاح'}\nالموقع الإلكتروني: ${place.website || 'غير متاح'}\nساعات العمل: ${place.opens_at && place.closes_at ? `${place.opens_at} - ${place.closes_at}` : 'غير محددة'}\nالتقييم: ${place.rating || 0}/5 (${place.review_count || 0} تقييم)\nرابط الخريطة: ${place.google_maps_url || 'غير متاح'}\nالوصف: ${place.description || 'لا يوجد وصف'}`.trim()\n\n            try {\n                // Generate Embedding using Google Gemini\n                // Note: 'gemini-embedding-001' generates 768-dimensional vectors\n                const { embedding } = await embed({\n                    model: google.textEmbeddingModel('gemini-embedding-001'),\n                    value: content,\n                })\n\n                // Delete existing document for this place to avoid duplicates\n                await supabase\n                    .from('documents')\n                    .delete()\n                    .filter('metadata->>place_id', 'eq', place.id)\n\n                // Store in Database\n                const { error: insertError } = await supabase\n                    .from('documents')\n                    .insert({\n                        content: content,\n                        metadata: {\n                            place_id: place.id,\n                            name: place.name,\n                            type: 'place'\n                        },\n                        embedding: embedding\n                    })\n\n                if (insertError) {\n                    console.error(`Error inserting embedding for ${place.name}:`, insertError)\n                    errors.push({ place: place.name, error: insertError.message })\n                } else {\n                    processedCount++\n                }\n\n            } catch (err) {\n                const message = err instanceof Error ? err.message : String(err)\n                console.error(`Error generating embedding for ${place.name}:`, err)\n                errors.push({ place: place.name, error: message })\n                // Continue to next place\n            }\n        }\n\n        return NextResponse.json({\n            message: `Processed ${processedCount} places successfully.`,\n            errors: errors.length > 0 ? errors : undefined\n        })\n\n    } catch (error) {\n        const message = error instanceof Error ? error.message : String(error)\n        console.error('Embeddings API Error:', error)\n        return NextResponse.json({ error: message }, { status: 500 })\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/api/chat/route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/events/page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/manifest.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/robots.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/app/sitemap.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/notifications.repository.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[413,416],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[413,416],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createClient } from \"@/lib/supabase/client\";\n\nexport interface Notification {\n    id: string;\n    user_id: string;\n    type: string;\n    title: string;\n    message: string;\n    link?: string;\n    place_slug?: string; // For role-based routing to place details\n    is_read: boolean;\n    created_at: string;\n}\n\nexport class NotificationsRepository {\n    private supabase;\n\n    constructor(supabaseClient?: any) {\n        this.supabase = supabaseClient || createClient();\n    }\n\n    async getUnreadCount(userId: string): Promise<number> {\n        const { count, error } = await this.supabase\n            .from('notifications')\n            .select('*', { count: 'exact', head: true })\n            .eq('user_id', userId)\n            .eq('is_read', false);\n\n        if (error) {\n            console.error('Error fetching unread count:', error);\n            return 0;\n        }\n\n        return count || 0;\n    }\n\n    async getRecentNotifications(userId: string, limit = 5): Promise<Notification[]> {\n        const { data, error } = await this.supabase\n            .from('notifications')\n            .select('*')\n            .eq('user_id', userId)\n            .order('created_at', { ascending: false })\n            .limit(limit);\n\n        if (error) {\n            console.error('Error fetching notifications:', error);\n            return [];\n        }\n\n        return data || [];\n    }\n\n    async markAsRead(notificationId: string): Promise<void> {\n        const { error } = await this.supabase\n            .from('notifications')\n            .update({ is_read: true })\n            .eq('id', notificationId);\n\n        if (error) throw new Error(error.message);\n    }\n\n    async markAllAsRead(userId: string): Promise<void> {\n        const { error } = await this.supabase\n            .from('notifications')\n            .update({ is_read: true })\n            .eq('user_id', userId)\n            .eq('is_read', false);\n\n        if (error) throw new Error(error.message);\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-area.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-category.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-event.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-favorites.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-place.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-review.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-settings.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/data/repositories/supabase-user.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/di/modules.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/area.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/audit-log.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/category.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/place.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/review.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/setting.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/suez-event.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/entities/user.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/interfaces/area-repository.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/interfaces/category-repository.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/interfaces/event-repository.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/interfaces/place-repository.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/interfaces/settings-repository.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/interfaces/user-repository.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/repositories/favorites.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/repositories/review.repository.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/create-event.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/create-place.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/delete-event.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/delete-place.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-admin-events.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-admin-places.usecase.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[570,573],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[570,573],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Place } from \"../../entities/place\";\nimport { IPlaceRepository } from \"../../interfaces/place-repository.interface\";\n\nexport class GetAdminPlacesUseCase {\n    constructor(private placeRepository: IPlaceRepository) { }\n\n    async execute(\n        userId: string,\n        role: string,\n        filters: {\n            search?: string;\n            categoryId?: string;\n            areaId?: string;\n            status?: string;\n            creatorId?: string; // Super admin can filter by creator\n        } = {}\n    ): Promise<Place[]> {\n        const queryFilters: any = { ...filters };\n\n        // RBAC Logic:\n        // If NOT Super Admin, enforce 'userId' filter to be their own ID.\n        if (role !== 'super_admin') {\n            queryFilters.userId = userId;\n            delete queryFilters.creatorId; // Ignore creatorId if regular admin tries to send it\n        } else {\n            // If Super Admin, use 'creatorId' as 'userId' filter if provided\n            if (filters.creatorId) {\n                queryFilters.userId = filters.creatorId;\n            }\n        }\n\n        return this.placeRepository.getAdminPlaces(queryFilters);\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-areas.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-category-by-id.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-place-by-id.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-settings.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-user-logs.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-user-stats.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/get-users.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/update-event.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/update-place.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/update-setting.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/admin/update-user-role.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/auth/get-current-user.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/auth/get-user-role.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/get-active-events.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/get-categories.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/get-featured-places.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/get-place-by-slug.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/get-places-by-category.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/reviews/create-review.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/reviews/delete-review.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/reviews/get-place-rating-stats.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/reviews/get-place-reviews.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/reviews/update-review.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/reviews/vote-review.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/domain/use-cases/search-places.usecase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/audit.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/email.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/icons.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/slugify.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/supabase/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/supabase/middleware.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'options' is defined but never used.","line":18,"column":58,"nodeType":"Identifier","messageId":"unusedVar","endLine":18,"endColumn":65}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient } from '@supabase/ssr'\nimport { NextResponse, type NextRequest } from 'next/server'\n\nexport async function updateSession(request: NextRequest) {\n    let supabaseResponse = NextResponse.next({\n        request,\n    })\n\n    const supabase = createServerClient(\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n        {\n            cookies: {\n                getAll() {\n                    return request.cookies.getAll()\n                },\n                setAll(cookiesToSet) {\n                    cookiesToSet.forEach(({ name, value, options }) =>\n                        request.cookies.set(name, value)\n                    )\n                    supabaseResponse = NextResponse.next({\n                        request,\n                    })\n                    cookiesToSet.forEach(({ name, value, options }) =>\n                        supabaseResponse.cookies.set(name, value, options)\n                    )\n                },\n            },\n        }\n    )\n\n    const {\n        data: { user },\n    } = await supabase.auth.getUser()\n\n    // --- Security Logic ---\n    const path = request.nextUrl.pathname\n\n    // 1. If trying to access /admin*, must be logged in\n    if (path.startsWith('/admin')) {\n        if (!user) {\n            return NextResponse.redirect(new URL('/login', request.url))\n        }\n\n        // Note: We technically \"could\" check the role here by querying DB,\n        // but creating a Supabase client inside middleware to query DB is blocked by Edge limitations sometimes\n        // or just slower. \n        // It's often better to let the Layout (Server Component) handle the specific Role check (which we did).\n        // BUT, for extra security, if we have role in metadata, we can check it.\n        // For now, Layout check is sufficient for MVP Security.\n    }\n\n    // 2. If logged in and trying to access /login, redirect to /\n    if (path.startsWith('/login') && user) {\n        return NextResponse.redirect(new URL('/', request.url))\n    }\n\n    return supabaseResponse\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/supabase/server.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CookieOptions' is defined but never used.","line":1,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":48,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CookieOptions"},"fix":{"range":[27,47],"text":""},"desc":"Remove unused variable \"CookieOptions\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createServerClient, type CookieOptions } from '@supabase/ssr'\nimport { cookies } from 'next/headers'\n\nexport async function createClient() {\n    const cookieStore = await cookies()\n\n    return createServerClient(\n        process.env.NEXT_PUBLIC_SUPABASE_URL!,\n        process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n        {\n            cookies: {\n                getAll() {\n                    return cookieStore.getAll()\n                },\n                setAll(cookiesToSet) {\n                    try {\n                        cookiesToSet.forEach(({ name, value, options }) =>\n                            cookieStore.set(name, value, options)\n                        )\n                    } catch {\n                        // The `setAll` method was called from a Server Component.\n                        // This can be ignored if you have middleware refreshing\n                        // user sessions.\n                    }\n                },\n            },\n        }\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/supabase/service-role.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/lib/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/CategoriesClient.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/CategoryForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentUserRole' is defined but never used.","line":142,"column":53,"nodeType":"Identifier","messageId":"unusedVar","endLine":142,"endColumn":68},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'slug'. Either include it or remove the dependency array.","line":189,"column":8,"nodeType":"ArrayExpression","endLine":189,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [debouncedName, initialData, slug]","fix":{"range":[6552,6580],"text":"[debouncedName, initialData, slug]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect, useActionState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { createCategory, updateCategory, type CategoryState } from '@/actions/admin/categories.actions'\nimport { Loader2, Folder, Home, Star, Heart, Info, MapPin, Globe, Flag, Bell, Calendar, Utensils, Coffee, Pizza, CakeSlice, Wine, Beer, CupSoda, Sandwich, ShoppingBag, ShoppingCart, Tag, Gift, CreditCard, Store, Ticket, Percent, Car, Plane, Train, Bus, Bike, Hotel, Mountain, Palmtree, Tent, Anchor, Stethoscope, Dumbbell, GraduationCap, Briefcase, Wrench, Scissors, Hammer, Construction, Music, Camera, Wifi, Laptop, Smartphone, Gamepad, Tv, Radio, Headphones, Sun, Moon, Cloud, Zap, Droplets, Flame, Wind } from 'lucide-react'\nimport { translateAndSlugify } from '@/app/actions/translate'\nimport { useDebounce } from 'use-debounce'\nimport { getIconComponent } from '@/lib/icons'\nimport { toast } from 'sonner'\n\n// Icon Categories Configuration\nconst ICON_CATEGORIES = [\n    {\n        id: 'general',\n        label: 'عام',\n        icon: Folder,\n        icons: [\n            { name: 'Folder', icon: Folder },\n            { name: 'Home', icon: Home },\n            { name: 'Star', icon: Star },\n            { name: 'Heart', icon: Heart },\n            { name: 'Info', icon: Info },\n            { name: 'MapPin', icon: MapPin },\n            { name: 'Globe', icon: Globe },\n            { name: 'Flag', icon: Flag },\n            { name: 'Bell', icon: Bell },\n            { name: 'Calendar', icon: Calendar },\n        ]\n    },\n    {\n        id: 'food',\n        label: 'طعام',\n        icon: Utensils,\n        icons: [\n            { name: 'Utensils', icon: Utensils },\n            { name: 'Coffee', icon: Coffee },\n            { name: 'Pizza', icon: Pizza },\n            { name: 'CakeSlice', icon: CakeSlice },\n            { name: 'Wine', icon: Wine },\n            { name: 'Beer', icon: Beer },\n            { name: 'CupSoda', icon: CupSoda },\n            { name: 'Sandwich', icon: Sandwich },\n        ]\n    },\n    {\n        id: 'shopping',\n        label: 'تسوّق',\n        icon: ShoppingBag,\n        icons: [\n            { name: 'ShoppingBag', icon: ShoppingBag },\n            { name: 'ShoppingCart', icon: ShoppingCart },\n            { name: 'Store', icon: Store },\n            { name: 'Tag', icon: Tag },\n            { name: 'Gift', icon: Gift },\n            { name: 'CreditCard', icon: CreditCard },\n            { name: 'Ticket', icon: Ticket },\n            { name: 'Percent', icon: Percent },\n        ]\n    },\n    {\n        id: 'places',\n        label: 'أماكن',\n        icon: MapPin,\n        icons: [\n            { name: 'Car', icon: Car },\n            { name: 'Plane', icon: Plane },\n            { name: 'Train', icon: Train },\n            { name: 'Bus', icon: Bus },\n            { name: 'Bike', icon: Bike },\n            { name: 'Hotel', icon: Hotel },\n            { name: 'Mountain', icon: Mountain },\n            { name: 'Palmtree', icon: Palmtree },\n            { name: 'Tent', icon: Tent },\n            { name: 'Anchor', icon: Anchor },\n        ]\n    },\n    {\n        id: 'services',\n        label: 'خدمات',\n        icon: Briefcase,\n        icons: [\n            { name: 'Stethoscope', icon: Stethoscope },\n            { name: 'Dumbbell', icon: Dumbbell },\n            { name: 'GraduationCap', icon: GraduationCap },\n            { name: 'Briefcase', icon: Briefcase },\n            { name: 'Wrench', icon: Wrench },\n            { name: 'Scissors', icon: Scissors },\n            { name: 'Hammer', icon: Hammer },\n            { name: 'Construction', icon: Construction },\n        ]\n    },\n    {\n        id: 'tech',\n        label: 'ترفيه',\n        icon: Gamepad,\n        icons: [\n            { name: 'Music', icon: Music },\n            { name: 'Camera', icon: Camera },\n            { name: 'Wifi', icon: Wifi },\n            { name: 'Laptop', icon: Laptop },\n            { name: 'Smartphone', icon: Smartphone },\n            { name: 'Gamepad', icon: Gamepad },\n            { name: 'Tv', icon: Tv },\n            { name: 'Radio', icon: Radio },\n            { name: 'Headphones', icon: Headphones },\n        ]\n    },\n    {\n        id: 'nature',\n        label: 'طبيعة',\n        icon: Sun,\n        icons: [\n            { name: 'Sun', icon: Sun },\n            { name: 'Moon', icon: Moon },\n            { name: 'Cloud', icon: Cloud },\n            { name: 'Zap', icon: Zap },\n            { name: 'Droplets', icon: Droplets },\n            { name: 'Flame', icon: Flame },\n            { name: 'Wind', icon: Wind },\n        ]\n    }\n]\n\ntype CategoryFormProps = {\n    initialData?: {\n        id?: string\n        name: string\n        slug: string\n        icon: string\n        is_featured?: boolean\n        sort_order?: number\n    }\n    currentUserRole?: string | null\n}\n\nconst initialState: CategoryState = {\n    message: '',\n    errors: {}\n}\n\nexport default function CategoryForm({ initialData, currentUserRole }: CategoryFormProps) {\n    const router = useRouter()\n    const [name, setName] = useState(initialData?.name || '')\n    const [slug, setSlug] = useState(initialData?.slug || '')\n    const [debouncedName] = useDebounce(name, 1000)\n    const [isTranslating, setIsTranslating] = useState(false)\n\n    // Icon Picker State\n    const [activeTab, setActiveTab] = useState('general')\n    const [selectedIcon, setSelectedIcon] = useState(initialData?.icon || 'Folder')\n\n    const SelectedLucideIcon = getIconComponent(selectedIcon)\n\n    // Select the appropriate action\n    const formAction = initialData?.id\n        ? updateCategory.bind(null, initialData.id)\n        : createCategory\n\n    const [state, action, isPending] = useActionState(formAction, initialState)\n\n    useEffect(() => {\n        if (state.success) {\n            toast.success(state.message)\n            router.push('/admin/categories')\n            router.refresh()\n        } else if (state.message) {\n            toast.error(state.message)\n        } else if (state.errors?._form) {\n            toast.error(state.errors._form[0])\n        }\n    }, [state, router])\n\n    useEffect(() => {\n        const translate = async () => {\n            if (!initialData && debouncedName && !slug) {\n                setIsTranslating(true)\n                try {\n                    const generated = await translateAndSlugify(debouncedName)\n                    setSlug(generated)\n                } catch (error) {\n                    console.error(error)\n                } finally {\n                    setIsTranslating(false)\n                }\n            }\n        }\n        translate()\n    }, [debouncedName, initialData])\n\n    return (\n        <form action={action} className=\"space-y-8 bg-slate-900 p-8 rounded-2xl border border-slate-800 shadow-xl\">\n            {/* Name & Slug Section */}\n            <div className=\"space-y-6\">\n                <div>\n                    <label className=\"block text-sm font-medium text-slate-300 mb-2\">اسم التصنيف <span className=\"text-red-500\">*</span></label>\n                    <input\n                        type=\"text\"\n                        name=\"name\"\n                        value={name}\n                        onChange={(e) => setName(e.target.value)}\n                        required\n                        className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white placeholder-slate-600 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all\"\n                        placeholder=\"مثال: مطاعم ومقاهي\"\n                    />\n                    {state.errors?.name && <p className=\"text-red-500 text-xs mt-1\">{state.errors.name[0]}</p>}\n                </div>\n\n                <div>\n                    <label className=\"block text-sm font-medium text-slate-400 mb-2\">\n                        الاسم اللطيف (Slug) - <span className=\"text-xs text-slate-500\">يتم الترجمة تلقائياً بواسطة Google</span>\n                    </label>\n                    <div className=\"relative\">\n                        <input\n                            type=\"text\"\n                            name=\"slug\"\n                            value={slug}\n                            onChange={(e) => setSlug(e.target.value)}\n                            required\n                            className=\"w-full px-4 py-3 bg-slate-950/50 border border-slate-800 rounded-xl text-slate-400 font-mono text-sm focus:border-primary/50 outline-none transition-all\"\n                        />\n                        {isTranslating && (\n                            <div className=\"absolute left-3 top-3\">\n                                <Loader2 className=\"w-5 h-5 animate-spin text-primary\" />\n                            </div>\n                        )}\n                        {state.errors?.slug && <p className=\"text-red-500 text-xs mt-1\">{state.errors.slug[0]}</p>}\n                    </div>\n                </div>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                    {/* Featured Toggle */}\n                    <div className=\"bg-slate-950/30 border border-slate-800 rounded-xl p-4 flex items-center justify-between\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-1\">تصنيف مميز</label>\n                            <p className=\"text-xs text-slate-500\">يظهر في الصفحة الرئيسية</p>\n                        </div>\n                        <label className=\"relative inline-flex items-center cursor-pointer\">\n                            <input\n                                type=\"checkbox\"\n                                name=\"is_featured\"\n                                value=\"true\"\n                                defaultChecked={initialData?.is_featured}\n                                className=\"sr-only peer\"\n                            />\n                            <div className=\"w-11 h-6 bg-slate-700 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-primary/50 rounded-full peer peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary\"></div>\n                        </label>\n                    </div>\n\n                    {/* Sort Order Input */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-slate-300 mb-2\">ترتيب الظهور</label>\n                        <input\n                            type=\"number\"\n                            name=\"sort_order\"\n                            defaultValue={initialData?.sort_order || 0}\n                            className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white placeholder-slate-600 focus:border-primary focus:ring-1 focus:ring-primary outline-none transition-all\"\n                            placeholder=\"0\"\n                        />\n                        <p className=\"text-xs text-slate-500 mt-1\">الأرقام الأقل تظهر أولاً</p>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"border-t border-slate-800 my-6\"></div>\n\n            {/* Tabbed Icon Picker Section */}\n            <div>\n                <label className=\"block text-sm font-medium text-slate-300 mb-4\">أيقونة التصنيف</label>\n                <input type=\"hidden\" name=\"icon\" value={selectedIcon} />\n\n                <div className=\"bg-slate-950 border border-slate-800 rounded-xl overflow-hidden\">\n                    {/* Tabs Header */}\n                    <div className=\"flex overflow-x-auto custom-scrollbar border-b border-slate-800 bg-slate-900/50\">\n                        {ICON_CATEGORIES.map((cat) => (\n                            <button\n                                key={cat.id}\n                                type=\"button\"\n                                onClick={() => setActiveTab(cat.id)}\n                                className={`flex items-center gap-2 px-4 py-3 text-sm font-medium whitespace-nowrap transition-colors border-b-2 ${activeTab === cat.id\n                                    ? 'text-primary border-primary bg-primary/5'\n                                    : 'text-slate-400 border-transparent hover:text-white hover:bg-slate-800'\n                                    }`}\n                            >\n                                <cat.icon size={16} />\n                                {cat.label}\n                            </button>\n                        ))}\n                    </div>\n\n                    {/* Icons Grid */}\n                    <div className=\"p-4 h-48 overflow-y-auto custom-scrollbar\">\n                        <div className=\"grid grid-cols-6 sm:grid-cols-8 gap-3\">\n                            {ICON_CATEGORIES.find(c => c.id === activeTab)?.icons.map(({ name, icon: Icon }) => (\n                                <button\n                                    key={name}\n                                    type=\"button\"\n                                    onClick={() => setSelectedIcon(name)}\n                                    className={`p-2 rounded-lg flex items-center justify-center transition-all duration-200 border aspect-square ${selectedIcon === name\n                                        ? 'bg-primary text-primary-foreground border-primary shadow-lg shadow-primary/20 scale-105'\n                                        : 'bg-slate-900 text-slate-500 border-slate-800 hover:border-slate-600 hover:text-white hover:bg-slate-800'\n                                        }`}\n                                    title={name}\n                                >\n                                    <Icon size={20} strokeWidth={selectedIcon === name ? 2.5 : 2} />\n                                </button>\n                            ))}\n                        </div>\n                    </div>\n                </div>\n\n                {/* Selected Icon Preview */}\n                <div className=\"mt-4 flex items-center gap-3 p-3 bg-slate-950/50 rounded-xl border border-slate-800/50\">\n                    <div className=\"bg-primary/20 p-2 rounded-lg text-primary\">\n                        <SelectedLucideIcon size={24} />\n                    </div>\n                    <div className=\"flex flex-col\">\n                        <span className=\"text-xs text-slate-500\">الأيقونة المختارة</span>\n                        <span className=\"text-sm font-bold text-white font-mono\">{selectedIcon}</span>\n                    </div>\n                </div>\n            </div>\n\n            {state.errors?._form && (\n                <div className=\"bg-red-500/10 border border-red-500/20 text-red-500 p-4 rounded-xl text-sm\">\n                    {state.errors._form[0]}\n                </div>\n            )}\n\n            <div className=\"border-t border-slate-800 my-6\"></div>\n\n            <div className=\"flex items-center justify-end gap-3\">\n                <button type=\"button\" onClick={() => router.back()} className=\"px-6 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl font-medium transition-colors\">\n                    إلغاء\n                </button>\n                <button\n                    type=\"submit\"\n                    disabled={isPending}\n                    className=\"px-6 py-2.5 bg-primary text-primary-foreground hover:brightness-110 rounded-xl font-medium transition-all shadow-lg shadow-primary/20 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                    {isPending ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : (initialData ? 'حفظ التعديلات' : 'حفظ التصنيف')}\n                </button>\n            </div>\n        </form>\n    )\n}\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/PlaceForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Share2' is defined but never used.","line":8,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":81,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Share2"},"fix":{"range":[393,401],"text":""},"desc":"Remove unused variable \"Share2\"."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'slug'. Either include it or remove the dependency array.","line":85,"column":8,"nodeType":"ArrayExpression","endLine":85,"endColumn":42,"suggestions":[{"desc":"Update the dependencies array to be: [debouncedName, initialData?.slug, slug]","fix":{"range":[3240,3274],"text":"[debouncedName, initialData?.slug, slug]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect, useActionState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { createPlaceAction, updatePlaceAction, PlaceState } from '@/actions/admin/places.actions'\nimport { translateAndSlugify } from '@/app/actions/translate'\nimport { useDebounce } from 'use-debounce'\nimport { Loader2, Store, User, MapPin, Globe, Phone, Facebook, Instagram, Share2 } from 'lucide-react'\nimport ImageUpload from '@/presentation/ui/image-upload'\nimport { Place } from '@/domain/entities/place'\nimport { Area } from '@/domain/entities/area'\n\n// Types\ntype PlaceFormProps = {\n    initialData?: Partial<Place>\n    categories: { id: string; name: string }[]\n    areas: Area[] // We need to export this type\n}\nconst initialState: PlaceState = {\n    message: '',\n    errors: {}\n}\n\nexport default function PlaceForm({ initialData, categories, areas }: PlaceFormProps) {\n    const router = useRouter()\n\n    // --- State ---\n    const [name, setName] = useState(initialData?.name || '')\n    // English Name Removed as per request\n    const [slug, setSlug] = useState(initialData?.slug || '')\n    const [type, setType] = useState<'business' | 'professional'>(initialData?.type || 'business')\n    const [images, setImages] = useState<string[]>(initialData?.images || [])\n    const [address, setAddress] = useState(initialData?.address || '')\n    const [opensAt, setOpensAt] = useState(initialData?.opensAt || '')\n    const [closesAt, setClosesAt] = useState(initialData?.closesAt || '')\n\n    // Social Links State\n    const [socialLinks, setSocialLinks] = useState(initialData?.socialLinks || { facebook: '', instagram: '' })\n\n    const [debouncedName] = useDebounce(name, 1000)\n    const [isGeneratingSlug, setIsGeneratingSlug] = useState(false)\n\n    // --- Actions ---\n    // Wrap server action to inject extra state (images, socialLinks) NOT in the form itself\n    const handleSubmit = async (prevState: PlaceState, formData: FormData): Promise<PlaceState> => {\n        // Appending manual state to data object for the server action\n        const rawData = Object.fromEntries(formData.entries()) as Record<string, unknown>\n\n        const payload: Partial<Place> = {\n            ...rawData,\n            images,\n            socialLinks,\n            type,\n            opensAt,\n            closesAt\n        }\n\n        if (initialData?.id) {\n            return await updatePlaceAction(initialData.id, payload)\n        } else {\n            return await createPlaceAction(payload)\n        }\n    }\n\n\n    const [state, action, isPending] = useActionState(handleSubmit, initialState)\n\n    // --- Effects ---\n    // Auto-generate slug from Arabic Name (Translated)\n    useEffect(() => {\n        const generateSlug = async () => {\n            if (debouncedName && !initialData?.slug && !slug) {\n                setIsGeneratingSlug(true)\n                try {\n                    const generated = await translateAndSlugify(debouncedName)\n                    setSlug(generated)\n                } catch (error) {\n                    console.error(\"Slug generation failed\", error)\n                } finally {\n                    setIsGeneratingSlug(false)\n                }\n            }\n        }\n        generateSlug()\n    }, [debouncedName, initialData?.slug])\n\n    const generateMapLink = () => {\n        if (!name) return\n        const query = encodeURIComponent(`${name} ${address}`)\n        const link = `https://www.google.com/maps/search/?api=1&query=${query}`\n        // Using DOM manipulation for uncontrolled input or state if controlled. \n        // Since googleMapsUrl is uncontrolled (defaultValue), we should ideally control it or simpler:\n        const input = document.querySelector('input[name=\"googleMapsUrl\"]') as HTMLInputElement\n        if (input) {\n            input.value = link\n            input.focus()\n        }\n    }\n\n    return (\n        <form action={action} className=\"space-y-8 bg-slate-900 p-8 rounded-2xl border border-slate-800 shadow-xl w-full\">\n\n            {/* ... Type Selection ... */}\n            <div className=\"space-y-4\">\n                <label className=\"block text-sm font-medium text-slate-300\">نوع الإضافة</label>\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                    <button\n                        type=\"button\"\n                        onClick={() => setType('business')}\n                        className={`p-4 rounded-xl border flex flex-col items-center gap-3 transition-all ${type === 'business'\n                            ? 'bg-primary/10 border-primary text-primary'\n                            : 'bg-slate-950 border-slate-800 text-slate-400 hover:bg-slate-800'\n                            }`}\n                    >\n                        <Store size={32} />\n                        <span className=\"font-bold\">مكان تجاري / شركة</span>\n                    </button>\n\n                    <button\n                        type=\"button\"\n                        onClick={() => setType('professional')}\n                        className={`p-4 rounded-xl border flex flex-col items-center gap-3 transition-all ${type === 'professional'\n                            ? 'bg-primary/10 border-primary text-primary'\n                            : 'bg-slate-950 border-slate-800 text-slate-400 hover:bg-slate-800'\n                            }`}\n                    >\n                        <User size={32} />\n                        <span className=\"font-bold\">فني / مهني مستقل</span>\n                    </button>\n                </div>\n            </div>\n\n            <div className=\"border-t border-slate-800\"></div>\n\n            <div className=\"grid lg:grid-cols-2 gap-8\">\n                {/* Right Column: Basic Info */}\n                <div className=\"space-y-6\">\n                    <div>\n                        <label className=\"block text-sm font-medium text-slate-300 mb-2\">الاسم (بالعربي) <span className=\"text-red-500\">*</span></label>\n                        <input\n                            type=\"text\"\n                            name=\"name\"\n                            value={name}\n                            onChange={(e) => setName(e.target.value)}\n                            required\n                            className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors\"\n                            placeholder={type === 'business' ? \"مثال: مطعم اسماك السويس\" : \"مثال: ورشة الأسطى محمد\"}\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block text-sm font-medium text-slate-300 mb-2\">الرابط (Slug) <span className=\"text-red-500\">*</span></label>\n                        <div className=\"relative\">\n                            <input\n                                type=\"text\"\n                                name=\"slug\"\n                                value={slug}\n                                onChange={(e) => setSlug(e.target.value)}\n                                required\n                                className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-slate-400 font-mono text-sm outline-none focus:border-primary transition-colors\"\n                            />\n                            {isGeneratingSlug && <div className=\"absolute left-3 top-3\"><Loader2 className=\"animate-spin text-primary w-5 h-5\" /></div>}\n                        </div>\n                        {state.errors?.slug && <p className=\"text-red-500 text-xs mt-1\">{state.errors.slug[0]}</p>}\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">التصنيف <span className=\"text-red-500\">*</span></label>\n                            <select\n                                name=\"categoryId\"\n                                defaultValue={initialData?.categoryId || ''}\n                                required\n                                className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors appearance-none cursor-pointer\"\n                            >\n                                <option value=\"\" disabled>اختر التصنيف...</option>\n                                {categories.map(cat => (\n                                    <option key={cat.id} value={cat.id}>{cat.name}</option>\n                                ))}\n                            </select>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">المنطقة</label>\n                            <select\n                                name=\"areaId\"\n                                defaultValue={initialData?.areaId || ''}\n                                className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors appearance-none cursor-pointer\"\n                            >\n                                <option value=\"\">بدون منطقة</option>\n                                {areas.map(area => (\n                                    <option key={area.id} value={area.id}>{area.name}</option>\n                                ))}\n                            </select>\n                        </div>\n                    </div>\n\n                    <div>\n                        <label className=\"block text-sm font-medium text-slate-300 mb-2\">\n                            {type === 'business' ? 'العنوان وتفاصيل الموقع' : 'العنوان (اختياري)'}\n                        </label>\n                        <textarea\n                            name=\"address\"\n                            value={address}\n                            onChange={(e) => setAddress(e.target.value)}\n                            // Required only for business\n                            required={type === 'business'}\n                            rows={3}\n                            className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors\"\n                            placeholder=\"مثال:شارع الجيش، بجوار البنك الأهلي\"\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block text-sm font-medium text-slate-300 mb-2\">مواعيد العمل</label>\n                        <div className=\"grid grid-cols-2 gap-4\">\n                            <div>\n                                <label className=\"text-xs text-slate-400 mb-1 block\">يفتح في</label>\n                                <input\n                                    type=\"time\"\n                                    name=\"opens_at\"\n                                    value={opensAt}\n                                    onChange={(e) => setOpensAt(e.target.value)}\n                                    className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors text-center dir-ltr\"\n                                />\n                            </div>\n                            <div>\n                                <label className=\"text-xs text-slate-400 mb-1 block\">يغلق في</label>\n                                <input\n                                    type=\"time\"\n                                    name=\"closes_at\"\n                                    value={closesAt}\n                                    onChange={(e) => setClosesAt(e.target.value)}\n                                    className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors text-center dir-ltr\"\n                                />\n                            </div>\n                        </div>\n                    </div>\n                    <div>\n                        <div className=\"flex justify-between items-center mb-2\">\n                            <label className=\"block text-sm font-medium text-slate-300\">رابط خرائط جوجل</label>\n                            <button\n                                type=\"button\"\n                                onClick={generateMapLink}\n                                className=\"text-xs text-primary hover:text-primary/80 flex items-center gap-1 transition-colors\"\n                            >\n                                <Globe size={12} />\n                                توليد تلقائي\n                            </button>\n                        </div>\n                        <div className=\"relative\">\n                            <MapPin className=\"absolute right-3 top-3.5 text-slate-500 w-5 h-5\" />\n                            <input\n                                type=\"url\"\n                                name=\"googleMapsUrl\"\n                                defaultValue={initialData?.googleMapsUrl || ''}\n                                className=\"w-full pr-10 pl-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors ltr:text-left\"\n                                placeholder=\"https://maps.app.goo.gl/...\"\n                            />\n                        </div>\n                    </div>\n                </div>\n\n                {/* Left Column: Contact & Media */}\n                <div className=\"space-y-6\">\n\n                    {/* Image Upload */}\n                    <div>\n                        <label className=\"block text-sm font-medium text-slate-300 mb-2\">الصور</label>\n                        <ImageUpload\n                            value={images}\n                            onChange={(urls) => setImages(urls)}\n                        />\n                    </div>\n\n                    <div className=\"border-t border-slate-800 my-4\"></div>\n\n                    <h3 className=\"font-bold text-lg text-white flex items-center gap-2\">\n                        <Phone className=\"w-5 h-5 text-primary\" />\n                        بيانات التواصل\n                    </h3>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">رقم الهاتف</label>\n                            <input\n                                type=\"tel\"\n                                name=\"phone\"\n                                defaultValue={initialData?.phone || ''}\n                                className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors dir-ltr\"\n                                placeholder=\"01xxxxxxxxx\"\n                            />\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">رقم الواتساب</label>\n                            <input\n                                type=\"tel\"\n                                name=\"whatsapp\"\n                                defaultValue={initialData?.whatsapp || ''}\n                                className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors dir-ltr\"\n                                placeholder=\"201xxxxxxxxx\"\n                            />\n                        </div>\n                    </div>\n\n                    {/* Social Links */}\n                    <div className=\"space-y-4\">\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">فيسبوك</label>\n                            <div className=\"relative\">\n                                <Facebook className=\"absolute right-3 top-3.5 text-blue-500 w-5 h-5\" />\n                                <input\n                                    type=\"url\"\n                                    value={socialLinks.facebook || ''}\n                                    onChange={e => setSocialLinks({ ...socialLinks, facebook: e.target.value })}\n                                    className=\"w-full pr-10 pl-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors ltr:text-left\"\n                                    placeholder=\"https://facebook.com/...\"\n                                />\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">انستجرام</label>\n                            <div className=\"relative\">\n                                <Instagram className=\"absolute right-3 top-3.5 text-pink-500 w-5 h-5\" />\n                                <input\n                                    type=\"url\"\n                                    value={socialLinks.instagram || ''}\n                                    onChange={e => setSocialLinks({ ...socialLinks, instagram: e.target.value })}\n                                    className=\"w-full pr-10 pl-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors ltr:text-left\"\n                                    placeholder=\"https://instagram.com/...\"\n                                />\n                            </div>\n                        </div>\n                        <div>\n                            <label className=\"block text-sm font-medium text-slate-300 mb-2\">الموقع الإلكتروني</label>\n                            <div className=\"relative\">\n                                <Globe className=\"absolute right-3 top-3.5 text-slate-500 w-5 h-5\" />\n                                <input\n                                    type=\"url\"\n                                    name=\"website\"\n                                    defaultValue={initialData?.website || ''}\n                                    className=\"w-full pr-10 pl-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors ltr:text-left\"\n                                    placeholder=\"https://example.com\"\n                                />\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"border-t border-slate-800 mt-8 pt-6\">\n                <label className=\"block text-sm font-medium text-slate-300 mb-2\">الوصف / عن المكان</label>\n                <textarea\n                    name=\"description\"\n                    defaultValue={initialData?.description || ''}\n                    rows={4}\n                    className=\"w-full px-4 py-3 bg-slate-950 border border-slate-800 rounded-xl text-white outline-none focus:border-primary transition-colors\"\n                    placeholder=\"اكتب وصفاً جذاباً للمكان أو الخدمات المقدمة...\"\n                />\n            </div>\n\n            {state.message && !state.success && (\n                <div className=\"bg-red-500/10 border border-red-500/20 text-red-500 p-4 rounded-xl text-sm\">\n                    {state.message}\n                </div>\n            )}\n\n            {state.message && state.success && (\n                <div className=\"bg-green-500/10 border border-green-500/20 text-green-500 p-4 rounded-xl text-sm\">\n                    {state.message}\n                </div>\n            )}\n\n            <div className=\"flex items-center justify-end gap-3 pt-4\">\n                <button type=\"button\" onClick={() => router.back()} className=\"px-6 py-3 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl font-medium transition-colors\">\n                    إلغاء\n                </button>\n                <button\n                    type=\"submit\"\n                    disabled={isPending}\n                    className=\"px-8 py-3 bg-primary text-primary-foreground hover:brightness-110 rounded-xl font-bold transition-all shadow-lg shadow-primary/20 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                    {isPending ? <Loader2 className=\"w-5 h-5 animate-spin\" /> : (initialData?.id ? 'حفظ التعديلات' : 'إضافة المكان')}\n                </button>\n            </div>\n        </form>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/PlacesFilterBar.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Filter' is defined but never used.","line":3,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":24,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Filter"},"fix":{"range":[29,37],"text":""},"desc":"Remove unused variable \"Filter\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { Search, Filter, X } from 'lucide-react'\nimport { useRouter, useSearchParams, usePathname } from 'next/navigation'\nimport { useDebouncedCallback } from 'use-debounce'\nimport { Category } from '@/domain/entities/category'\nimport { Area } from '@/domain/entities/area'\n\ninterface Props {\n    categories: Category[]\n    areas: Area[]\n    users?: { id: string, full_name: string | null }[] // For Super Admin\n}\n\nimport { RequestCategoryButton } from '@/presentation/components/admin/request-category-button'\n\nexport default function PlacesFilterBar({ categories, areas, users }: Props) {\n    const searchParams = useSearchParams()\n    const pathname = usePathname()\n    const router = useRouter()\n\n    const handleSearch = useDebouncedCallback((term: string) => {\n        const params = new URLSearchParams(searchParams)\n        if (term) {\n            params.set('search', term)\n        } else {\n            params.delete('search')\n        }\n        router.replace(`${pathname}?${params.toString()}`)\n    }, 300)\n\n    const handleFilterChange = (key: string, value: string) => {\n        const params = new URLSearchParams(searchParams)\n        if (value && value !== 'all') {\n            params.set(key, value)\n        } else {\n            params.delete(key)\n        }\n        router.replace(`${pathname}?${params.toString()}`)\n    }\n\n    const hasActiveFilters = searchParams.toString().length > 0\n\n    const clearFilters = () => {\n        router.replace(pathname)\n    }\n\n\n\n    return (\n        <div className=\"bg-slate-900 border border-slate-800 rounded-2xl p-4 mb-6 shadow-sm\">\n            <div className=\"flex justify-between items-center mb-4\">\n                <h3 className=\"text-sm font-semibold text-slate-400\">تصفية النتائج</h3>\n                <RequestCategoryButton />\n            </div>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\">\n                {/* Search */}\n                <div className=\"relative\">\n                    <Search className=\"absolute right-3 top-3 h-4 w-4 text-slate-500\" />\n                    <input\n                        type=\"text\"\n                        placeholder=\"بحث عن مكان...\"\n                        defaultValue={searchParams.get('search')?.toString()}\n                        onChange={(e) => handleSearch(e.target.value)}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl py-2.5 pr-10 pl-4 text-sm focus:outline-none focus:ring-1 focus:ring-primary/50 text-white placeholder-slate-500 transition-colors\"\n                    />\n                </div>\n\n                {/* Category Filter */}\n                <select\n                    value={searchParams.get('categoryId') || 'all'}\n                    onChange={(e) => handleFilterChange('categoryId', e.target.value)}\n                    className=\"bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 text-sm text-slate-300 focus:outline-none focus:ring-1 focus:ring-primary/50 cursor-pointer\"\n                >\n                    <option value=\"all\">كل التصنيفات</option>\n                    {categories.map((cat) => (\n                        <option key={cat.id} value={cat.id}>{cat.name}</option>\n                    ))}\n                </select>\n\n                {/* Area Filter */}\n                <select\n                    value={searchParams.get('areaId') || 'all'}\n                    onChange={(e) => handleFilterChange('areaId', e.target.value)}\n                    className=\"bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 text-sm text-slate-300 focus:outline-none focus:ring-1 focus:ring-primary/50 cursor-pointer\"\n                >\n                    <option value=\"all\">كل المناطق</option>\n                    {areas.map((area) => (\n                        <option key={area.id} value={area.id}>{area.name}</option>\n                    ))}\n                </select>\n\n                {/* Status Filter */}\n                <select\n                    value={searchParams.get('status') || 'all'}\n                    onChange={(e) => handleFilterChange('status', e.target.value)}\n                    className=\"bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 text-sm text-slate-300 focus:outline-none focus:ring-1 focus:ring-primary/50 cursor-pointer\"\n                >\n                    <option value=\"all\">كل الحالات</option>\n                    <option value=\"active\">نشط</option>\n                    <option value=\"pending\">قيد المراجعة</option>\n                    <option value=\"inactive\">غير نشط</option>\n                </select>\n\n                {/* User Filter (Super Admin Only) */}\n                {users && users.length > 0 && (\n                    <select\n                        value={searchParams.get('creatorId') || 'all'}\n                        onChange={(e) => handleFilterChange('creatorId', e.target.value)}\n                        className=\"bg-slate-950 border border-slate-800 rounded-xl px-4 py-2.5 text-sm text-slate-300 focus:outline-none focus:ring-1 focus:ring-primary/50 cursor-pointer\"\n                    >\n                        <option value=\"all\">كل المستخدمين</option>\n                        {users.map((user) => (\n                            <option key={user.id} value={user.id}>{user.full_name || 'مستخدم بدون اسم'}</option>\n                        ))}\n                    </select>\n                )}\n            </div>\n\n            {hasActiveFilters && (\n                <div className=\"mt-4 pt-4 border-t border-slate-800 flex justify-end\">\n                    <button\n                        onClick={clearFilters}\n                        className=\"text-xs text-red-400 hover:text-red-300 flex items-center gap-1 transition-colors\"\n                    >\n                        <X size={14} />\n                        إلغاء الفلاتر\n                    </button>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/UsersClientPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ShieldAlert' is defined but never used.","line":5,"column":31,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":42,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ShieldAlert"},"fix":{"range":[94,107],"text":""},"desc":"Remove unused variable \"ShieldAlert\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'CheckCircle' is defined but never used.","line":8,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":41,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"CheckCircle"},"fix":{"range":[253,266],"text":""},"desc":"Remove unused variable \"CheckCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'XCircle' is defined but never used.","line":8,"column":43,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":50,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"XCircle"},"fix":{"range":[266,275],"text":""},"desc":"Remove unused variable \"XCircle\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":50,"column":14,"nodeType":"Identifier","messageId":"unusedVar","endLine":50,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, Fragment } from 'react'\nimport {\n    User as UserIcon, Shield, ShieldAlert, ShieldCheck,\n    Calendar, MoreVertical, Search, FileText, Loader2,\n    MapPin, Star, ChevronDown, ChevronUp, Clock,\n    Plus, Edit, Trash2, Eye, CheckCircle, XCircle, LucideIcon\n} from 'lucide-react'\n\nimport { format, formatDistanceToNow, differenceInDays } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport { updateUserRole, getUserDetails } from '@/actions/admin/users.actions'\nimport type { User } from '@/domain/entities/user'\nimport type { UserStats } from '@/domain/interfaces/user-repository.interface'\nimport type { AuditLog } from '@/domain/entities/audit-log'\n\n// Helper function to get action icon and color\nfunction getLogActionStyle(action: string) {\n    const styles: Record<string, { icon: LucideIcon, color: string, bg: string, label: string }> = {\n        'user.created': { icon: Plus, color: 'text-green-400', bg: 'bg-green-500/10', label: 'إنشاء مستخدم' },\n        'user.role_update': { icon: Shield, color: 'text-blue-400', bg: 'bg-blue-500/10', label: 'تحديث صلاحيات' },\n        'place.created': { icon: Plus, color: 'text-emerald-400', bg: 'bg-emerald-500/10', label: 'إضافة مكان' },\n        'place.updated': { icon: Edit, color: 'text-amber-400', bg: 'bg-amber-500/10', label: 'تعديل مكان' },\n        'place.deleted': { icon: Trash2, color: 'text-red-400', bg: 'bg-red-500/10', label: 'حذف مكان' },\n        'category.created': { icon: Plus, color: 'text-purple-400', bg: 'bg-purple-500/10', label: 'إضافة تصنيف' },\n        'category.updated': { icon: Edit, color: 'text-yellow-400', bg: 'bg-yellow-500/10', label: 'تعديل تصنيف' },\n        'category.deleted': { icon: Trash2, color: 'text-orange-400', bg: 'bg-orange-500/10', label: 'حذف تصنيف' },\n    }\n    return styles[action] || { icon: Eye, color: 'text-slate-400', bg: 'bg-slate-800', label: action }\n}\n\n// Format log details - Handle nested objects properly\nfunction formatLogDetails(details: Record<string, unknown> | null | undefined): string {\n    if (!details) return ''\n    if (typeof details === 'string') return details\n\n    try {\n        const entries = Object.entries(details)\n            .filter(([key]) => !['id', 'created_at', 'updated_at'].includes(key))\n            .map(([key, value]) => {\n                // Handle nested objects/arrays\n                if (typeof value === 'object' && value !== null) {\n                    return `${key}: ${JSON.stringify(value)}`\n                }\n                return `${key}: ${value}`\n            })\n\n        return entries.join(' • ')\n    } catch (error) {\n        return JSON.stringify(details)\n    }\n}\n\n// Format timestamp - show relative time for recent logs, date for old ones\nfunction formatLogTimestamp(date: Date): string {\n    const now = new Date()\n\n    if (isNaN(date.getTime())) return 'غير متوفر'\n\n    // If older than 2 days\n    if (Math.abs(differenceInDays(now, date)) >= 2) {\n        return format(date, 'dd MMMM yyyy - hh:mm a', { locale: ar })\n    }\n\n    // Otherwise show relative time\n    return formatDistanceToNow(date, { addSuffix: true, locale: ar })\n}\n\nexport default function UsersClientPage({ initialUsers, currentUserRole }: { initialUsers: User[], currentUserRole: string | null }) {\n    const [users, setUsers] = useState<User[]>(initialUsers)\n    const [searchQuery, setSearchQuery] = useState('')\n    const [updating, setUpdating] = useState<string | null>(null)\n\n    // Expanded User State (Stats + Logs)\n    const [expandedUserId, setExpandedUserId] = useState<string | null>(null)\n    const [userStats, setUserStats] = useState<UserStats | null>(null)\n    const [userLogs, setUserLogs] = useState<AuditLog[]>([])\n    const [loadingDetails, setLoadingDetails] = useState(false)\n\n    const fetchUserDetailsClient = async (userId: string) => {\n        if (expandedUserId === userId) {\n            setExpandedUserId(null)\n            return\n        }\n\n        setExpandedUserId(userId)\n        setLoadingDetails(true)\n        setUserStats(null)\n        setUserLogs([])\n\n        try {\n            const { stats, logs } = await getUserDetails(userId)\n            setUserStats(stats)\n            setUserLogs(logs)\n        } catch (error) {\n            console.error('Error fetching details:', error)\n        } finally {\n            setLoadingDetails(false)\n        }\n    }\n\n    const handleRoleUpdate = async (userId: string, newRole: string) => {\n        if (!confirm('هل أنت متأكد من تغيير صلاحيات هذا المستخدم؟')) return\n\n        setUpdating(userId)\n        try {\n            const result = await updateUserRole(userId, newRole)\n\n            if (!result.success) throw new Error(result.error)\n\n            // Update local state\n            setUsers(users.map(u => u.id === userId ? { ...u, role: newRole as User['role'] } : u))\n            alert('تم تحديث الصلاحيات بنجاح ✅')\n        } catch (error) {\n            alert('حدث خطأ: ' + (error instanceof Error ? error.message : String(error)))\n        } finally {\n            setUpdating(null)\n        }\n    }\n\n    // Sort Logic: Super Admin > Admin > User, then by date key\n    const rolePriority: Record<string, number> = { super_admin: 0, admin: 1, user: 2 }\n\n    const filteredUsers = users\n        .filter(user =>\n            user.email?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n            user.fullName?.toLowerCase().includes(searchQuery.toLowerCase())\n        )\n        .sort((a, b) => {\n            // 1. Sort by Role Priority\n            const priorityDiff = rolePriority[a.role] - rolePriority[b.role]\n            if (priorityDiff !== 0) return priorityDiff\n\n            // 2. Sort by Created Date (Newest first)\n            const dateA = a.createdAt ? new Date(a.createdAt).getTime() : 0\n            const dateB = b.createdAt ? new Date(b.createdAt).getTime() : 0\n            return dateB - dateA\n        })\n\n    return (\n        <div className=\"space-y-6\">\n            {/* Header Card - Modern Design */}\n            <div className=\"bg-slate-900 border border-slate-800 rounded-2xl p-6 shadow-sm\">\n                <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4\">\n                    {/* Title Section */}\n                    <div className=\"flex-1\">\n                        <h1 className=\"text-2xl font-bold text-white mb-1 flex items-center gap-2\">\n                            <div className=\"w-10 h-10 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center\">\n                                <UserIcon className=\"text-primary\" size={20} />\n                            </div>\n                            المستخدمين\n                        </h1>\n                        <p className=\"text-slate-400 text-sm mr-12\">\n                            إدارة المستخدمين والصلاحيات\n                        </p>\n                    </div>\n\n                    {/* Search Section */}\n                    <div className=\"w-full lg:w-64\">\n                        <div className=\"relative\">\n                            <Search className=\"absolute right-3 top-2.5 h-4 w-4 text-slate-500\" />\n                            <input\n                                type=\"text\"\n                                placeholder=\"بحث عن مستخدم...\"\n                                value={searchQuery}\n                                onChange={(e) => setSearchQuery(e.target.value)}\n                                className=\"w-full bg-slate-950/50 border border-slate-800 rounded-xl py-2 pr-10 pl-4 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50 focus:border-primary/50 text-white placeholder-slate-500 transition-all\"\n                            />\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Table Card */}\n            <div className=\"bg-slate-900 border border-slate-800 rounded-2xl overflow-hidden\">\n                <div className=\"overflow-x-auto\">\n                    <table className=\"w-full text-right border-collapse\">\n                        <thead>\n                            <tr className=\"border-b border-slate-800 bg-slate-950/50\">\n                                <th className=\"p-4 font-medium text-slate-400 text-sm\">المستخدم</th>\n                                <th className=\"p-4 font-medium text-slate-400 text-sm w-32 md:w-auto\">الدور</th>\n                                <th className=\"p-4 font-medium text-slate-400 text-sm hidden md:table-cell\">تاريخ الانضمام</th>\n                                <th className=\"p-4 font-medium text-slate-400 text-sm w-10\"></th>\n                            </tr>\n                        </thead>\n                        <tbody className=\"divide-y divide-slate-800\">\n                            {filteredUsers.map((user) => (\n                                <Fragment key={user.id}>\n                                    <tr\n                                        onClick={() => fetchUserDetailsClient(user.id)}\n                                        className={`cursor-pointer transition-colors ${expandedUserId === user.id ? 'bg-slate-800/80' : 'hover:bg-slate-800/50'}`}\n                                    >\n                                        <td className=\"p-4\">\n                                            <div className=\"flex items-center gap-3\">\n                                                <div className={`w-10 h-10 min-w-[2.5rem] rounded-full flex items-center justify-center ${user.role === 'super_admin' ? 'bg-purple-500/10 text-purple-400' :\n                                                    user.role === 'admin' ? 'bg-blue-500/10 text-blue-400' :\n                                                        'bg-slate-800 text-slate-400'\n                                                    }`}>\n                                                    <UserIcon size={20} />\n                                                </div>\n                                                <div className=\"min-w-0\">\n                                                    <div className=\"font-medium text-slate-200 truncate max-w-[120px] md:max-w-none\">\n                                                        {user.fullName || 'بدون اسم'}\n                                                    </div>\n                                                    <div className=\"text-xs text-slate-500 truncate max-w-[120px] md:max-w-none\">\n                                                        {user.email}\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </td>\n                                        <td className=\"p-4\">\n                                            {/* Enhanced Role Badge with Gradient */}\n                                            <div className={`inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold border ${user.role === 'super_admin'\n                                                ? 'bg-gradient-to-r from-purple-500/20 to-pink-500/20 border-purple-500/40 text-purple-300'\n                                                : user.role === 'admin'\n                                                    ? 'bg-blue-500/20 border-blue-500/40 text-blue-300'\n                                                    : 'bg-slate-800 border-slate-700 text-slate-300'\n                                                }`}>\n                                                {user.role === 'super_admin' && <ShieldCheck className=\"text-purple-400\" size={14} />}\n                                                {user.role === 'admin' && <Shield className=\"text-blue-400\" size={14} />}\n                                                {user.role === 'user' && <UserIcon size={14} />}\n                                                <span>\n                                                    {user.role === 'super_admin' ? 'مدير أعلى' : user.role === 'admin' ? 'مدير محتوى' : 'مستخدم'}\n                                                </span>\n                                            </div>\n                                        </td>\n                                        <td className=\"p-4 text-sm text-slate-400 hidden md:table-cell\">\n                                            <div className=\"flex items-center gap-2\">\n                                                <Calendar size={14} />\n                                                {user.createdAt ? format(new Date(user.createdAt), 'dd MMM yyyy', { locale: ar }) : '-'}\n                                            </div>\n                                        </td>\n                                        <td className=\"p-4 text-left\">\n                                            {expandedUserId === user.id ? <ChevronUp size={18} className=\"text-slate-500\" /> : <ChevronDown size={18} className=\"text-slate-500\" />}\n                                        </td>\n                                    </tr>\n\n                                    {/* Expanded Details Row */}\n                                    {expandedUserId === user.id && (\n                                        <tr className=\"bg-slate-900/50\">\n                                            <td colSpan={4} className=\"p-0\">\n                                                <div className=\"p-4 md:p-6 border-b border-slate-800 animate-in slide-in-from-top-2\">\n                                                    {/* Details Component can be extracted further */}\n                                                    {/* Mobile Only Date Display */}\n                                                    <div className=\"md:hidden flex items-center gap-2 text-xs text-slate-500 mb-4 px-1\">\n                                                        <Calendar size={14} />\n                                                        <span>تاريخ الانضمام: {user.createdAt ? format(new Date(user.createdAt), 'dd MMM yyyy', { locale: ar }) : '-'}</span>\n                                                    </div>\n\n                                                    {loadingDetails ? (\n                                                        <div className=\"flex justify-center py-4\">\n                                                            <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n                                                        </div>\n                                                    ) : (\n                                                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                                                            {/* 1. Statistics Section */}\n                                                            <div className=\"space-y-4\">\n                                                                <h4 className=\"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2\">\n                                                                    <MoreVertical size={14} /> إحصائيات\n                                                                </h4>\n                                                                <div className=\"grid grid-cols-2 gap-3 md:gap-4\">\n                                                                    <div className=\"bg-slate-950 p-3 md:p-4 rounded-xl border border-slate-800 flex items-center gap-3\">\n                                                                        <div className=\"p-2 md:p-3 bg-emerald-500/10 text-emerald-500 rounded-lg shrink-0\">\n                                                                            <MapPin size={20} />\n                                                                        </div>\n                                                                        <div className=\"min-w-0\">\n                                                                            <p className=\"text-xs text-slate-400 truncate\">الأماكن</p>\n                                                                            <p className=\"text-lg md:text-xl font-bold text-white\">{userStats?.placesCount || 0}</p>\n                                                                        </div>\n                                                                    </div>\n                                                                    <div className=\"bg-slate-950 p-3 md:p-4 rounded-xl border border-slate-800 flex items-center gap-3\">\n                                                                        <div className=\"p-2 md:p-3 bg-amber-500/10 text-amber-500 rounded-lg shrink-0\">\n                                                                            <Star size={20} />\n                                                                        </div>\n                                                                        <div className=\"min-w-0\">\n                                                                            <p className=\"text-xs text-slate-400 truncate\">التعليقات</p>\n                                                                            <p className=\"text-lg md:text-xl font-bold text-white\">{userStats?.reviewsCount || 0}</p>\n                                                                        </div>\n                                                                    </div>\n                                                                </div>\n\n                                                                {/* Role Actions (Only for Super Admin) */}\n                                                                {currentUserRole === 'super_admin' && user.role !== 'super_admin' && (\n                                                                    <div className=\"mt-4 pt-4 border-t border-slate-800\">\n                                                                        <p className=\"text-xs text-slate-500 mb-2\">تغيير الصلاحيات:</p>\n                                                                        <div className=\"flex flex-wrap gap-2\">\n                                                                            {user.role !== 'admin' && (\n                                                                                <button\n                                                                                    onClick={(e) => { e.stopPropagation(); handleRoleUpdate(user.id, 'admin'); }}\n                                                                                    disabled={updating === user.id}\n                                                                                    className=\"flex-1 md:flex-none px-3 py-2 text-xs bg-blue-500/10 text-blue-400 hover:bg-blue-500/20 rounded-lg transition-colors border border-blue-500/20 flex justify-center\"\n                                                                                >\n                                                                                    ترقية إلى أدمن\n                                                                                </button>\n                                                                            )}\n                                                                            {user.role !== 'user' && (\n                                                                                <button\n                                                                                    onClick={(e) => { e.stopPropagation(); handleRoleUpdate(user.id, 'user'); }}\n                                                                                    disabled={updating === user.id}\n                                                                                    className=\"flex-1 md:flex-none px-3 py-2 text-xs bg-red-500/10 text-red-400 hover:bg-red-500/20 rounded-lg transition-colors border border-red-500/20 flex justify-center\"\n                                                                                >\n                                                                                    تخفيض إلى مستخدم\n                                                                                </button>\n                                                                            )}\n                                                                        </div>\n                                                                    </div>\n                                                                )}\n                                                            </div>\n\n                                                            {/* 2. Audit Logs Section - Only for Super Admins */}\n                                                            {currentUserRole === 'super_admin' && (\n                                                                <div className=\"space-y-4\">\n                                                                    <h4 className=\"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2\">\n                                                                        <Clock size={14} /> سجل النشاط (آخر 50 عملية)\n                                                                    </h4>\n                                                                    <div className=\"bg-slate-950 rounded-xl border border-slate-800 h-64 overflow-y-auto custom-scrollbar p-2\">\n                                                                        {userLogs.length === 0 ? (\n                                                                            <div className=\"h-full flex flex-col items-center justify-center text-slate-600\">\n                                                                                <FileText size={24} className=\"mb-2 opacity-50\" />\n                                                                                <p className=\"text-sm\">لا يوجد سجلات نشاط</p>\n                                                                            </div>\n                                                                        ) : (\n                                                                            <div className=\"space-y-3\">\n                                                                                {userLogs.map(log => {\n                                                                                    const style = getLogActionStyle(log.action)\n                                                                                    const Icon = style.icon as LucideIcon\n\n                                                                                    return (\n                                                                                        <div key={log.id} className=\"flex items-start gap-3 p-3 rounded-lg bg-slate-900/50 border border-slate-800/50 hover:border-slate-700 transition-colors\">\n                                                                                            {/* Icon */}\n                                                                                            <div className={`p-2 rounded-lg shrink-0 ${style.bg}`}>\n                                                                                                <Icon className={style.color} size={16} />\n                                                                                            </div>\n\n                                                                                            {/* Content */}\n                                                                                            <div className=\"flex-1 min-w-0\">\n                                                                                                <div className=\"flex items-start justify-between gap-2 mb-1\">\n                                                                                                    <span className=\"text-xs font-semibold text-white\">\n                                                                                                        {style.label}\n                                                                                                    </span>\n                                                                                                    <span className=\"text-[10px] text-slate-500 shrink-0\">\n                                                                                                        {log.createdAt ? formatLogTimestamp(new Date(log.createdAt)) : '-'}\n                                                                                                    </span>\n                                                                                                </div>\n\n                                                                                                {log.details && (\n                                                                                                    <div className=\"max-w-full overflow-x-auto\">\n                                                                                                        <p className=\"text-xs text-slate-400 whitespace-nowrap\">\n                                                                                                            {formatLogDetails(log.details)}\n                                                                                                        </p>\n                                                                                                    </div>\n                                                                                                )}\n                                                                                            </div>\n                                                                                        </div>\n                                                                                    )\n                                                                                })}\n                                                                            </div>\n                                                                        )}\n                                                                    </div>\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    )}\n                                                </div>\n                                            </td>\n                                        </tr>\n                                    )}\n                                </Fragment>\n                            ))}\n                        </tbody>\n                    </table>\n\n                    {filteredUsers.length === 0 && (\n                        <div className=\"p-8 text-center text-slate-500\">\n                            لا يوجد مستخدمين مطابقين للبحث\n                        </div>\n                    )}\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/create-event-form.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[756,759],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[756,759],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'slug'. Either include it or remove the dependency array.","line":46,"column":8,"nodeType":"ArrayExpression","endLine":46,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [debouncedTitle, initialData?.slug, slug]","fix":{"range":[1953,1988],"text":"[debouncedTitle, initialData?.slug, slug]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useActionState, useState, useEffect } from 'react'\nimport { createEventAction, updateEventAction } from '@/actions/admin/events.actions'\nimport { Place } from '@/domain/entities/place'\nimport { useRouter } from 'next/navigation'\nimport { toast } from 'sonner'\nimport { Calendar, MapPin, Type, FileText, Image as ImageIcon, Link2, Save, X, Loader2 } from 'lucide-react'\nimport ImageUpload from '@/presentation/ui/image-upload'\nimport { useDebounce } from 'use-debounce'\nimport { translateAndSlugify } from '@/app/actions/translate'\n\nimport { SuezEvent } from '@/domain/entities/suez-event'\nimport { EventState } from '@/actions/admin/events.actions'\n\ninterface CreateEventFormProps {\n    places: Place[]\n    initialData?: SuezEvent | any // Support SuezEvent entity or raw DB object for now\n}\n\nexport function CreateEventForm({ places, initialData }: CreateEventFormProps) {\n    const router = useRouter()\n    const isEdit = !!initialData\n    const [images, setImages] = useState<string[]>(initialData?.imageUrl || initialData?.image_url ? [initialData.imageUrl || initialData.image_url] : [])\n    const [title, setTitle] = useState(initialData?.title || '')\n    const [slug, setSlug] = useState(initialData?.slug || '')\n    const [debouncedTitle] = useDebounce(title, 1000)\n    const [isGeneratingSlug, setIsGeneratingSlug] = useState(false)\n\n    // Auto-generate slug\n    useEffect(() => {\n        const generateSlug = async () => {\n            if (debouncedTitle && !initialData?.slug && !slug) {\n                setIsGeneratingSlug(true)\n                try {\n                    const generated = await translateAndSlugify(debouncedTitle)\n                    setSlug(generated)\n                } catch (error) {\n                    console.error(\"Slug generation failed\", error)\n                } finally {\n                    setIsGeneratingSlug(false)\n                }\n            }\n        }\n        generateSlug()\n    }, [debouncedTitle, initialData?.slug]) // Removed slug dependency to allow manual override without fighting the effect\n\n    const boundAction = isEdit ? updateEventAction.bind(null, initialData.id) : createEventAction\n\n    const [state, action, isPending] = useActionState(boundAction, {\n        message: '',\n        success: false\n    } as EventState)\n\n    if (state.success) {\n        toast.success(state.message)\n        router.push('/admin/events')\n    } else if (state.message && !state.success) {\n        toast.error(state.message)\n    }\n\n    return (\n        <form action={action} className=\"space-y-8 bg-slate-900 p-8 rounded-3xl border border-slate-800 shadow-xl\" dir=\"rtl\">\n            {/* Hidden Input for Image URL */}\n            <input type=\"hidden\" name=\"imageUrl\" value={images[0] || ''} />\n\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <Type size={16} className=\"text-primary\" /> عنوان الفعالية\n                    </label>\n                    <input\n                        name=\"title\"\n                        required\n                        value={title}\n                        onChange={(e) => setTitle(e.target.value)}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 transition-all outline-none\"\n                        placeholder=\"مثلاً: مهرجان السويس الصيفي\"\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <Link2 size={16} className=\"text-primary\" /> الرابط المختصر (Slug)\n                    </label>\n                    <div className=\"relative\">\n                        <input\n                            name=\"slug\"\n                            required\n                            value={slug}\n                            onChange={(e) => setSlug(e.target.value)}\n                            className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 focus:border-primary/50 focus:ring-1 focus:ring-primary/50 transition-all outline-none\"\n                            placeholder=\"suez-summer-festival\"\n                        />\n                        {isGeneratingSlug && <div className=\"absolute left-3 top-3\"><Loader2 className=\"animate-spin text-primary w-5 h-5\" /></div>}\n                    </div>\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <Calendar size={16} className=\"text-primary\" /> تاريخ البدء\n                    </label>\n                    <input\n                        name=\"startDate\"\n                        type=\"datetime-local\"\n                        required\n                        defaultValue={(initialData?.startDate || initialData?.start_date) ? new Date(new Date(initialData.startDate || initialData.start_date).getTime() - new Date().getTimezoneOffset() * 60000).toISOString().slice(0, 16) : ''}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none\"\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <Calendar size={16} className=\"text-primary\" /> تاريخ الانتهاء\n                    </label>\n                    <input\n                        name=\"endDate\"\n                        type=\"datetime-local\"\n                        required\n                        defaultValue={(initialData?.endDate || initialData?.end_date) ? new Date(new Date(initialData.endDate || initialData.end_date).getTime() - new Date().getTimezoneOffset() * 60000).toISOString().slice(0, 16) : ''}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none\"\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <MapPin size={16} className=\"text-primary\" /> نوع المكان\n                    </label>\n                    <select\n                        name=\"type\"\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none\"\n                        defaultValue={initialData?.type || 'general'}\n                    >\n                        <option value=\"general\">فعالية عامة (مكان نصي)</option>\n                        <option value=\"place_hosted\">مُقام في مكان مسجل</option>\n                    </select>\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <MapPin size={16} className=\"text-primary\" /> اختيار المكان (اختياري)\n                    </label>\n                    <select\n                        name=\"placeId\"\n                        defaultValue={(initialData?.placeId || initialData?.place_id) || ''}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none\"\n                    >\n                        <option value=\"\">-- اختر مكاناً --</option>\n                        {places.map(place => (\n                            <option key={place.id} value={place.id}>{place.name}</option>\n                        ))}\n                    </select>\n                </div>\n\n                <div className=\"md:col-span-2 space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300\">وصف المكان (نصي)</label>\n                    <input\n                        name=\"location\"\n                        defaultValue={initialData?.location}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none\"\n                        placeholder=\"مثلاً: الكورنيش القديم، بجوار...\"\n                    />\n                </div>\n\n                <div className=\"md:col-span-2 space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <FileText size={16} className=\"text-primary\" /> وصف الفعالية\n                    </label>\n                    <textarea\n                        name=\"description\"\n                        rows={4}\n                        defaultValue={initialData?.description}\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none resize-none\"\n                        placeholder=\"اكتب تفاصيل الفعالية هنا...\"\n                    />\n                </div>\n\n                <div className=\"md:col-span-2 space-y-4\">\n                    <label className=\"text-sm font-medium text-slate-300 flex items-center gap-2\">\n                        <ImageIcon size={16} className=\"text-primary\" /> صورة الفعالية\n                    </label>\n                    <ImageUpload\n                        value={images}\n                        onChange={(urls) => setImages(urls)}\n                        maxFiles={1}\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium text-slate-300\">الحالة</label>\n                    <select\n                        name=\"status\"\n                        className=\"w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-slate-200 outline-none\"\n                        defaultValue={initialData?.status || 'draft'}\n                    >\n                        <option value=\"draft\">مسودة</option>\n                        <option value=\"active\">نشط</option>\n                        <option value=\"inactive\">معطل</option>\n                    </select>\n                </div>\n            </div>\n\n            <div className=\"flex gap-4 pt-4 border-t border-slate-800\">\n                <button\n                    type=\"submit\"\n                    disabled={isPending}\n                    className=\"flex-1 bg-primary hover:bg-primary/90 disabled:bg-slate-800 text-white font-bold py-4 rounded-2xl flex items-center justify-center gap-3 transition-all shadow-lg shadow-primary/20\"\n                >\n                    <Save size={20} />\n                    {isPending ? 'جاري الحفظ...' : 'حفظ الفعالية'}\n                </button>\n                <button\n                    type=\"button\"\n                    onClick={() => router.back()}\n                    className=\"px-8 bg-slate-800 hover:bg-slate-700 text-slate-300 font-bold rounded-2xl flex items-center gap-2 transition-all border border-slate-700\"\n                >\n                    <X size={20} /> إلغاء\n                </button>\n            </div>\n        </form>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/create-place-form.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useState' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":18,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"useState"},"fix":{"range":[255,264],"text":""},"desc":"Remove unused variable \"useState\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Category } from '@/domain/entities/category'\nimport { Place } from '@/domain/entities/place'\nimport { createPlaceAction, updatePlaceAction, type ActionState } from '@/app/admin/places/actions'\nimport { useRouter } from 'next/navigation'\nimport { useState, useEffect, useActionState } from 'react'\nimport { Loader2 } from 'lucide-react'\nimport { toast } from 'sonner'\n\ninterface PlaceFormProps {\n    categories: Category[]\n    initialData?: Place\n}\n\nconst initialState: ActionState = {}\n\nexport function PlaceForm({ categories, initialData }: PlaceFormProps) {\n    const router = useRouter()\n    const isEdit = !!initialData\n\n    const actionWithId = isEdit && initialData\n        ? updatePlaceAction.bind(null, initialData.id)\n        : createPlaceAction\n\n    const [state, action, isPending] = useActionState(actionWithId, initialState)\n\n    useEffect(() => {\n        if (state.success) {\n            toast.success(state.message)\n            router.push('/admin/places')\n            router.refresh()\n        } else if (state.message) {\n            toast.error(state.message)\n        }\n    }, [state, router])\n\n    return (\n        <form action={action} className=\"space-y-6 bg-slate-900 p-8 rounded-2xl border border-slate-800 shadow-sm text-slate-200\">\n            <div>\n                <label className=\"block text-sm font-medium text-slate-400 mb-1\">اسم المكان</label>\n                <input\n                    type=\"text\"\n                    name=\"name\"\n                    defaultValue={initialData?.name}\n                    required\n                    className=\"w-full px-4 py-2 rounded-xl bg-slate-950 border border-slate-800 focus:border-primary outline-none\"\n                    placeholder=\"مثال: مطعم النورس\"\n                />\n                {state.errors?.name && <p className=\"text-red-500 text-xs mt-1\">{state.errors.name[0]}</p>}\n            </div>\n\n            <div>\n                <label className=\"block text-sm font-medium text-slate-400 mb-1\">التصنيف</label>\n                <select\n                    name=\"category_id\"\n                    defaultValue={initialData?.categoryId}\n                    required\n                    className=\"w-full px-4 py-2 rounded-xl bg-slate-950 border border-slate-800 focus:border-primary outline-none\"\n                >\n                    <option value=\"\">اختر التصنيف...</option>\n                    {categories.map(cat => (\n                        <option key={cat.id} value={cat.id}>{cat.name}</option>\n                    ))}\n                </select>\n                {state.errors?.category_id && <p className=\"text-red-500 text-xs mt-1\">{state.errors.category_id[0]}</p>}\n            </div>\n\n            <div>\n                <label className=\"block text-sm font-medium text-slate-400 mb-1\">العنوان</label>\n                <input\n                    type=\"text\"\n                    name=\"address\"\n                    defaultValue={initialData?.address}\n                    required\n                    className=\"w-full px-4 py-2 rounded-xl bg-slate-950 border border-slate-800 focus:border-primary outline-none\"\n                    placeholder=\"العنوان بالتفصيل\"\n                />\n            </div>\n\n            <div>\n                <label className=\"block text-sm font-medium text-slate-400 mb-1\">الوصف</label>\n                <textarea\n                    name=\"description\"\n                    defaultValue={initialData?.description}\n                    rows={4}\n                    className=\"w-full px-4 py-2 rounded-xl bg-slate-950 border border-slate-800 focus:border-primary outline-none\"\n                    placeholder=\"وصف مختصر للمكان وخدماته...\"\n                ></textarea>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                    <label className=\"block text-sm font-medium text-slate-400 mb-1\">رقم الهاتف</label>\n                    <input\n                        type=\"tel\"\n                        name=\"phone\"\n                        defaultValue={initialData?.phone}\n                        className=\"w-full px-4 py-2 rounded-xl bg-slate-950 border border-slate-800 focus:border-primary outline-none\"\n                    />\n                </div>\n            </div>\n\n            <div className=\"pt-4 flex items-center justify-end gap-4\">\n                <button type=\"button\" onClick={() => router.back()} className=\"px-6 py-2 text-slate-400 hover:bg-slate-800 rounded-xl font-medium transition-colors\">\n                    إلغاء\n                </button>\n                <button type=\"submit\" disabled={isPending} className=\"px-6 py-2 bg-primary text-primary-foreground hover:brightness-110 rounded-xl font-medium transition-colors flex items-center gap-2 disabled:opacity-50\">\n                    {isPending && <Loader2 className=\"w-4 h-4 animate-spin\" />}\n                    {isEdit ? 'حفظ التغييرات' : 'حفظ المكان'}\n                </button>\n            </div>\n        </form>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/delete-place-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/events-list-client.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'places' is defined but never used.","line":74,"column":56,"nodeType":"Identifier","messageId":"unusedVar","endLine":74,"endColumn":62}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, Fragment } from 'react'\nimport Link from 'next/link'\nimport { Pencil, Calendar, Clock, MapPin, ChevronDown, ChevronUp, Trash2 } from 'lucide-react'\nimport Image from 'next/image'\nimport { Place } from '@/domain/entities/place'\nimport { format } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport { deleteEventAction, toggleEventStatusAction } from '@/actions/admin/events.actions'\nimport { toast } from 'sonner'\nimport { SuezEvent, EventStatus } from '@/domain/entities/suez-event'\n\ninterface AdminEventsListClientProps {\n    initialEvents: SuezEvent[]\n    places: Place[]\n}\n\nconst StatusBadge = ({\n    status,\n    onStatusChange,\n    isUpdating\n}: {\n    status: string,\n    onStatusChange?: (newStatus: EventStatus) => void,\n    isUpdating?: boolean\n}) => {\n    const styles = {\n        active: 'bg-green-500/10 text-green-500 border-green-500/20 hover:bg-green-500/20',\n        draft: 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20 hover:bg-yellow-500/20',\n        inactive: 'bg-red-500/10 text-red-500 border-red-500/20 hover:bg-red-500/20',\n    }\n    const labels = {\n        active: 'نشط',\n        draft: 'مسودة',\n        inactive: 'معطل',\n    }\n    const currentStyle = styles[status as keyof typeof styles] || styles.draft\n    const label = labels[status as keyof typeof labels] || status\n\n    const [isOpen, setIsOpen] = useState(false)\n\n    return (\n        <div className=\"relative inline-block\" onClick={(e) => e.stopPropagation()}>\n            <button\n                disabled={isUpdating}\n                onClick={() => setIsOpen(!isOpen)}\n                className={`px-2.5 py-1 rounded-lg text-xs font-medium border transition-all flex items-center gap-1.5 ${currentStyle} disabled:opacity-50`}\n            >\n                {isUpdating ? <Clock size={12} className=\"animate-spin\" /> : label}\n                <ChevronDown size={12} className={`transition-transform ${isOpen ? 'rotate-180' : ''}`} />\n            </button>\n\n            {isOpen && (\n                <div className=\"absolute top-full mt-1 right-0 w-24 bg-slate-900 border border-slate-800 rounded-xl shadow-xl z-10 py-1 overflow-hidden\">\n                    {(Object.keys(labels) as EventStatus[]).map((s) => (\n                        <button\n                            key={s}\n                            onClick={() => {\n                                onStatusChange?.(s)\n                                setIsOpen(false)\n                            }}\n                            className={`w-full text-right px-3 py-1.5 text-xs hover:bg-slate-800 transition-colors ${status === s ? 'text-primary font-bold' : 'text-slate-400'}`}\n                        >\n                            {labels[s]}\n                        </button>\n                    ))}\n                </div>\n            )}\n        </div>\n    )\n}\n\nexport function AdminEventsListClient({ initialEvents, places }: AdminEventsListClientProps) {\n    const [events, setEvents] = useState(initialEvents)\n    const [expandedEventId, setExpandedEventId] = useState<string | null>(null)\n    const [updatingEventId, setUpdatingEventId] = useState<string | null>(null)\n\n    const toggleExpanded = (eventId: string) => {\n        setExpandedEventId(expandedEventId === eventId ? null : eventId)\n    }\n\n    const handleStatusChange = async (id: string, newStatus: EventStatus) => {\n        setUpdatingEventId(id)\n        const res = await toggleEventStatusAction(id, newStatus)\n        if (res.success) {\n            setEvents(events.map(e => e.id === id ? { ...e, status: newStatus } : e))\n            toast.success(res.message)\n        } else {\n            toast.error(res.message)\n        }\n        setUpdatingEventId(null)\n    }\n\n    const handleDelete = async (id: string) => {\n        if (!confirm('هل أنت متأكد من حذف هذه الفعالية؟')) return\n\n        const res = await deleteEventAction(id)\n        if (res.success) {\n            setEvents(events.filter(e => e.id !== id))\n            toast.success(res.message)\n        } else {\n            toast.error(res.message)\n        }\n    }\n\n    return (\n        <div className=\"bg-slate-900 rounded-2xl border border-slate-800 shadow-sm overflow-hidden text-right\" dir=\"rtl\">\n            <div className=\"overflow-x-auto\">\n                <table className=\"w-full border-collapse\">\n                    <thead className=\"bg-slate-950/50 border-b border-slate-800 text-right\">\n                        <tr>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm\">الفعالية</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm\">الحالة</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm\">التاريخ</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm w-24\">الإجراءات</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm w-10\"></th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-800\">\n                        {events.length > 0 ? events.map((event) => (\n                            <Fragment key={event.id}>\n                                <tr\n                                    className={`transition-colors cursor-pointer ${expandedEventId === event.id ? 'bg-slate-800/80' : 'hover:bg-slate-800/50'}`}\n                                >\n                                    <td className=\"px-6 py-4\" onClick={() => toggleExpanded(event.id)}>\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-12 h-12 rounded-xl bg-slate-800 relative overflow-hidden border border-slate-700/50 shrink-0\">\n                                                {event.imageUrl ? (\n                                                    <Image src={event.imageUrl} alt={event.title} fill className=\"object-cover\" sizes=\"48px\" />\n                                                ) : (\n                                                    <div className=\"w-full h-full flex items-center justify-center text-slate-600\">\n                                                        <Calendar size={16} />\n                                                    </div>\n                                                )}\n                                            </div>\n                                            <div>\n                                                <div className=\"font-bold text-slate-200 mb-0.5\">{event.title}</div>\n                                                <div className=\"text-xs text-slate-500 font-mono\">{event.slug}</div>\n                                            </div>\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4\">\n                                        <StatusBadge\n                                            status={event.status}\n                                            onStatusChange={(newStatus) => handleStatusChange(event.id, newStatus)}\n                                            isUpdating={updatingEventId === event.id}\n                                        />\n                                    </td>\n                                    <td className=\"px-6 py-4 text-slate-400 text-sm\" onClick={() => toggleExpanded(event.id)}>\n                                        <div className=\"flex flex-col\">\n                                            <span>{format(new Date(event.startDate), 'dd MMM yyyy', { locale: ar })}</span>\n                                            <span className=\"text-xs text-slate-500\">{event.type === 'place_hosted' ? `بواسطة: ${event.placeName || 'مكان مسجل'}` : 'فعالية عامة'}</span>\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4\">\n                                        <div className=\"flex items-center gap-2\" onClick={(e) => e.stopPropagation()}>\n                                            <Link href={`/admin/events/${event.id}/edit`}>\n                                                <button className=\"p-2 text-slate-400 hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors\">\n                                                    <Pencil size={18} />\n                                                </button>\n                                            </Link>\n                                            <button\n                                                onClick={() => handleDelete(event.id)}\n                                                className=\"p-2 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors\"\n                                            >\n                                                <Trash2 size={18} />\n                                            </button>\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-left\" onClick={() => toggleExpanded(event.id)}>\n                                        {expandedEventId === event.id ? <ChevronUp size={18} /> : <ChevronDown size={18} />}\n                                    </td>\n                                </tr>\n                                {expandedEventId === event.id && (\n                                    <tr className=\"bg-slate-900/50\">\n                                        <td colSpan={5} className=\"p-0\">\n                                            <div className=\"p-6 border-b border-slate-800\">\n                                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                                    <div className=\"md:col-span-2\">\n                                                        <h4 className=\"text-sm font-semibold text-slate-300 mb-2\">الوصف</h4>\n                                                        <p className=\"text-sm text-slate-400 leading-relaxed\">{event.description || 'لا يوجد وصف'}</p>\n                                                    </div>\n                                                    <div>\n                                                        <h4 className=\"text-sm font-semibold text-slate-300 mb-2\">المكان والموعد</h4>\n                                                        <div className=\"space-y-2 text-sm text-slate-400\">\n                                                            <div className=\"flex items-center gap-2\"><MapPin size={14} className=\"text-primary\" /> {event.location || 'غير محدد'}</div>\n                                                            <div className=\"flex items-center gap-2\"><Clock size={14} className=\"text-primary\" /> {format(new Date(event.startDate), 'HH:mm')} - {format(new Date(event.endDate), 'HH:mm')}</div>\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </td>\n                                    </tr>\n                                )}\n                            </Fragment>\n                        )) : (\n                            <tr>\n                                <td colSpan={5} className=\"px-6 py-12 text-center text-slate-500\">لا توجد فعاليات حالياً.</td>\n                            </tr>\n                        )}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/events-list-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/places-list-client.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Plus' is defined but never used.","line":5,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":14,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Plus"},"fix":{"range":[95,100],"text":""},"desc":"Remove unused variable \"Plus\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, Fragment } from 'react'\nimport Link from 'next/link'\nimport { Plus, Pencil, MapPin, ChevronDown, ChevronUp, Phone, Globe, MapPinned, Calendar } from 'lucide-react'\nimport Image from 'next/image'\nimport { Place } from '@/domain/entities/place'\nimport { DeletePlaceButton } from './delete-place-button'\nimport { ToggleStatusButton } from './toggle-status-button'\nimport { format } from 'date-fns'\nimport { ar } from 'date-fns/locale'\n\ninterface PlacesListClientProps {\n    places: Place[]\n    isSuperAdmin: boolean\n}\n\nconst StatusBadge = ({ status }: { status: string }) => {\n    const styles = {\n        active: 'bg-green-500/10 text-green-500 border-green-500/20',\n        pending: 'bg-yellow-500/10 text-yellow-500 border-yellow-500/20',\n        inactive: 'bg-red-500/10 text-red-500 border-red-500/20',\n    }\n    const labels = {\n        active: 'نشط',\n        pending: 'مراجعة',\n        inactive: 'معطل',\n    }\n    const currentStyle = styles[status as keyof typeof styles] || styles.inactive\n    const label = labels[status as keyof typeof labels] || status\n\n    return (\n        <span className={`px-2.5 py-1 rounded-lg text-xs font-medium border ${currentStyle}`}>\n            {label}\n        </span>\n    )\n}\n\nexport function PlacesListClient({ places, isSuperAdmin }: PlacesListClientProps) {\n    const [expandedPlaceId, setExpandedPlaceId] = useState<string | null>(null)\n\n    const toggleExpanded = (placeId: string) => {\n        setExpandedPlaceId(expandedPlaceId === placeId ? null : placeId)\n    }\n\n    return (\n        <div className=\"bg-slate-900 rounded-2xl border border-slate-800 shadow-sm overflow-hidden\">\n            <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-right border-collapse\">\n                    <thead className=\"bg-slate-950/50 border-b border-slate-800\">\n                        <tr>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm\">المكان</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm hidden sm:table-cell\">الحالة</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm hidden md:table-cell\">التصنيف</th>\n                            {isSuperAdmin && <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm hidden lg:table-cell\">المضيف</th>}\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm w-24\">الإجراءات</th>\n                            <th className=\"px-6 py-4 font-semibold text-slate-400 text-sm w-10\"></th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"divide-y divide-slate-800\">\n                        {(places && places.length > 0) ? places.map((place) => (\n                            <Fragment key={place.id}>\n                                <tr\n                                    className={`transition-colors cursor-pointer ${expandedPlaceId === place.id ? 'bg-slate-800/80' : 'hover:bg-slate-800/50'}`}\n                                >\n                                    <td className=\"px-6 py-4\" onClick={() => toggleExpanded(place.id)}>\n                                        <div className=\"flex items-center gap-3\">\n                                            <div className=\"w-12 h-12 rounded-xl bg-slate-800 relative overflow-hidden border border-slate-700/50 hover:border-primary/20 transition-colors shrink-0\">\n                                                {place.images && place.images.length > 0 ? (\n                                                    <Image src={place.images[0]} alt={place.name} fill className=\"object-cover\" sizes=\"48px\" />\n                                                ) : (\n                                                    <div className=\"w-full h-full flex items-center justify-center text-slate-600 bg-slate-800\">\n                                                        <MapPin size={16} />\n                                                    </div>\n                                                )}\n                                            </div>\n                                            <div>\n                                                <div className=\"font-bold text-slate-200 mb-0.5\">{place.name}</div>\n                                                <div className=\"text-xs text-slate-500 font-mono truncate max-w-[150px]\">{place.slug}</div>\n                                                <div className=\"block sm:hidden mt-1\">\n                                                    <StatusBadge status={place.status || 'active'} />\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4 hidden sm:table-cell\" onClick={() => toggleExpanded(place.id)}>\n                                        <StatusBadge status={place.status || 'active'} />\n                                    </td>\n                                    <td className=\"px-6 py-4 text-slate-400 text-sm hidden md:table-cell\" onClick={() => toggleExpanded(place.id)}>\n                                        <div className=\"flex flex-col\">\n                                            <span className=\"text-slate-300\">{place.categoryName}</span>\n                                            <span className=\"text-xs text-slate-500\">{place.areaName || 'بدون منطقة'}</span>\n                                        </div>\n                                    </td>\n                                    {isSuperAdmin && (\n                                        <td className=\"px-6 py-4 text-slate-400 text-sm hidden lg:table-cell\" onClick={() => toggleExpanded(place.id)}>\n                                            {place.createdByName || 'N/A'}\n                                        </td>\n                                    )}\n                                    <td className=\"px-6 py-4\">\n                                        <div className=\"flex items-center gap-2\" onClick={(e) => e.stopPropagation()}>\n                                            <Link href={`/admin/places/${place.id}/edit`}>\n                                                <button className=\"p-2 text-slate-400 hover:text-blue-400 hover:bg-blue-500/10 rounded-lg transition-colors\" title=\"تعديل\">\n                                                    <Pencil size={18} />\n                                                </button>\n                                            </Link>\n                                            <DeletePlaceButton id={place.id} />\n                                            {isSuperAdmin && (\n                                                <ToggleStatusButton id={place.id} currentStatus={place.status || 'inactive'} />\n                                            )}\n                                        </div>\n                                    </td>\n                                    <td className=\"px-6 py-4 text-left\" onClick={() => toggleExpanded(place.id)}>\n                                        {expandedPlaceId === place.id ? <ChevronUp size={18} className=\"text-slate-500\" /> : <ChevronDown size={18} className=\"text-slate-500\" />}\n                                    </td>\n                                </tr>\n\n                                {/* Expanded Details Row */}\n                                {expandedPlaceId === place.id && (\n                                    <tr className=\"bg-slate-900/50\">\n                                        <td colSpan={isSuperAdmin ? 6 : 5} className=\"p-0\">\n                                            <div className=\"p-6 border-b border-slate-800 animate-in slide-in-from-top-2\">\n                                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                                    {/* Description */}\n                                                    <div className=\"md:col-span-2\">\n                                                        <h4 className=\"text-sm font-semibold text-slate-300 mb-2\">الوصف</h4>\n                                                        <p className=\"text-sm text-slate-400 leading-relaxed\">\n                                                            {place.description || 'لا يوجد وصف'}\n                                                        </p>\n                                                    </div>\n\n                                                    {/* Contact Info */}\n                                                    <div>\n                                                        <h4 className=\"text-sm font-semibold text-slate-300 mb-2\">معلومات الاتصال</h4>\n                                                        <div className=\"space-y-2\">\n                                                            {place.phone && (\n                                                                <div className=\"flex items-center gap-2 text-sm text-slate-400\">\n                                                                    <Phone size={14} className=\"text-primary\" />\n                                                                    <span dir=\"ltr\">{place.phone}</span>\n                                                                </div>\n                                                            )}\n                                                            {place.website && (\n                                                                <div className=\"flex items-center gap-2 text-sm text-slate-400\">\n                                                                    <Globe size={14} className=\"text-primary\" />\n                                                                    <a href={place.website} target=\"_blank\" rel=\"noopener noreferrer\" className=\"hover:text-primary transition-colors\">\n                                                                        {place.website}\n                                                                    </a>\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    </div>\n\n                                                    {/* Location */}\n                                                    <div>\n                                                        <h4 className=\"text-sm font-semibold text-slate-300 mb-2\">الموقع</h4>\n                                                        <div className=\"space-y-2\">\n                                                            {place.address && (\n                                                                <div className=\"flex items-start gap-2 text-sm text-slate-400\">\n                                                                    <MapPinned size={14} className=\"text-primary mt-0.5 shrink-0\" />\n                                                                    <span>{place.address}</span>\n                                                                </div>\n                                                            )}\n                                                            {place.createdAt && (\n                                                                <div className=\"flex items-center gap-2 text-sm text-slate-400\">\n                                                                    <Calendar size={14} className=\"text-primary\" />\n                                                                    <span>تم الإنشاء: {format(new Date(place.createdAt), 'dd MMM yyyy', { locale: ar })}</span>\n                                                                </div>\n                                                            )}\n                                                        </div>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </td>\n                                    </tr>\n                                )}\n                            </Fragment>\n                        )) : (\n                            <tr>\n                                <td colSpan={isSuperAdmin ? 6 : 5} className=\"px-6 py-12 text-center text-slate-500\">\n                                    لا توجد أماكن مطابقة للفلاتر الحالية.\n                                </td>\n                            </tr>\n                        )}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/places-list-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/request-category-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/admin/toggle-status-button.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":69,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":72,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1052,1055],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1052,1055],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { Power, PowerOff } from 'lucide-react'\nimport { togglePlaceStatus } from '@/actions/admin/places.actions'\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\n\nexport function ToggleStatusButton({ id, currentStatus }: { id: string, currentStatus: string }) {\n    const [isLoading, setIsLoading] = useState(false)\n    const router = useRouter()\n\n    const newStatus = currentStatus === 'active' ? 'inactive' : 'active'\n    const Icon = currentStatus === 'active' ? PowerOff : Power\n    const title = currentStatus === 'active' ? 'تعطيل المكان' : 'تفعيل المكان'\n    const colorClass = currentStatus === 'active'\n        ? 'text-slate-400 hover:text-red-400 hover:bg-red-500/10'\n        : 'text-slate-400 hover:text-green-400 hover:bg-green-500/10'\n\n    const handleToggle = async () => {\n        if (!confirm(`هل أنت متأكد من ${currentStatus === 'active' ? 'تعطيل' : 'تفعيل'} هذا المكان؟`)) return\n\n        setIsLoading(true)\n        try {\n            const result = await togglePlaceStatus(id, newStatus as any)\n            if (result.success) {\n                router.refresh()\n            } else {\n                alert('حدث خطأ: ' + result.message)\n            }\n        } catch (error) {\n            console.error(error)\n            alert('حدث خطأ غير متوقع')\n        } finally {\n            setIsLoading(false)\n        }\n    }\n\n    return (\n        <button\n            onClick={handleToggle}\n            disabled={isLoading}\n            className={`p-2 rounded-lg transition-colors ${colorClass} ${isLoading ? 'opacity-50 cursor-not-allowed' : ''}`}\n            title={title}\n        >\n            <Icon size={18} />\n        </button>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/analytics/VisitTracker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/layout/footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/layout/header.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'cn' is defined but never used.","line":7,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":7,"endColumn":12,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"cn"},"fix":{"range":[197,229],"text":""},"desc":"Remove unused import declaration."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { createPortal } from 'react-dom'\nimport Link from 'next/link'\nimport { Menu, X, Search, User, Heart, Compass } from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { ThemeToggle } from '../theme-toggle'\nimport { NotificationBell } from '../notification-bell'\nimport { createClient } from '@/lib/supabase/client'\nimport { User as SupabaseUser } from '@supabase/supabase-js'\nimport Image from 'next/image'\n\nexport function Header({ settings }: { settings?: Record<string, unknown> }) {\n    const [isMenuOpen, setIsMenuOpen] = useState(false)\n    const [mounted, setMounted] = useState(false)\n    const [user, setUser] = useState<SupabaseUser | null>(null)\n    const supabase = createClient()\n\n    useEffect(() => {\n        // Use a tick to avoid \"setState in effect\" warning\n        setTimeout(() => setMounted(true), 0)\n    }, [])\n\n    useEffect(() => {\n        // Check initial session\n        const checkUser = async () => {\n            const { data: { user } } = await supabase.auth.getUser()\n            setUser(user)\n        }\n        checkUser()\n\n        // Listen for auth changes\n        const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\n            setUser(session?.user ?? null)\n        })\n\n        return () => subscription.unsubscribe()\n    }, [supabase])\n\n    // Prevent hydration mismatch for portal rendering if needed,\n    // but allow main header to render immediately.\n\n    return (\n        <header className=\"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n            <div className=\"container mx-auto px-4 h-16 flex items-center justify-between\">\n                {/* Logo */}\n                <Link href=\"/\" className=\"flex items-center gap-4\">\n                    {settings?.site_logo ? (\n                        <Image\n                            src={settings.site_logo as string}\n                            alt={(settings?.site_name as string) || \"Logo\"}\n                            width={32}\n                            height={32}\n                            className=\"w-8 h-8 rounded-lg object-cover\"\n                            unoptimized\n                        />\n                    ) : (\n                        <Compass className=\"w-5 h-5 text-primary\" />\n                    )}\n                    <span className=\"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-blue-600\">\n                        {(settings?.site_name as string) || \"دليل السويس\"}\n                    </span>\n                </Link>\n\n                {/* Desktop Navigation */}\n                <nav className=\"hidden md:flex items-center gap-8\">\n                    <Link href=\"/\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n                        الرئيسية\n                    </Link>\n                    <Link href=\"/categories\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n                        التصنيفات\n                    </Link>\n                    <Link href=\"/events\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n                        الفعاليات\n                    </Link>\n                    <Link href=\"/places\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n                        الأماكن\n                    </Link>\n                </nav>\n\n                {/* Desktop Actions */}\n                <div className=\"hidden md:flex items-center gap-4\">\n                    <ThemeToggle />\n                    {user && <NotificationBell />}\n                    <button className=\"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors\">\n                        <Search size={20} className=\"text-slate-600 dark:text-slate-300\" />\n                    </button>\n                    {user ? (\n                        <Link\n                            href=\"/profile\"\n                            className=\"flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 text-primary hover:bg-primary/20 transition-colors text-sm font-medium\"\n                        >\n                            <User size={16} />\n                            <span>حسابي</span>\n                        </Link>\n                    ) : (\n                        <Link\n                            href=\"/login\"\n                            className=\"flex items-center gap-2 px-4 py-2 rounded-full bg-slate-900 dark:bg-slate-50 text-slate-50 dark:text-slate-900 hover:bg-slate-800 dark:hover:bg-slate-200 transition-colors text-sm font-medium\"\n                        >\n                            <User size={16} />\n                            <span>تسجيل الدخول</span>\n                        </Link>\n                    )}\n                </div>\n\n                {/* Mobile Menu Actions */}\n                <div className=\"flex md:hidden items-center gap-2\">\n                    {user && <NotificationBell />}\n                    <button\n                        className=\"p-2 -ml-2\"\n                        onClick={() => setIsMenuOpen(!isMenuOpen)}\n                    >\n                        {isMenuOpen ? <X size={24} /> : <Menu size={24} />}\n                    </button>\n                </div>\n            </div>\n\n            {/* Mobile Navigation Overlay */}\n            {isMenuOpen && mounted && createPortal(\n                <div className=\"md:hidden fixed inset-0 z-[100]\">\n                    {/* Backdrop - covers entire screen including header */}\n                    <div\n                        className=\"absolute inset-0 bg-black/40 backdrop-blur-sm animate-in fade-in duration-200\"\n                        onClick={() => setIsMenuOpen(false)}\n                    />\n\n                    {/* Menu Content Wrapper - Full Screen */}\n                    <div\n                        className=\"absolute inset-0 pointer-events-none flex flex-col\"\n                    >\n                        <div\n                            className=\"bg-popover w-full shadow-xl animate-in slide-in-from-top-2 duration-300 pointer-events-auto\"\n                            onClick={(e) => e.stopPropagation()}\n                        >\n                            {/* Mobile Menu Header (Logo + Close) */}\n                            <div className=\"container mx-auto px-4 h-16 flex items-center justify-between border-b\">\n                                <Link href=\"/\" className=\"flex items-center gap-4\" onClick={() => setIsMenuOpen(false)}>\n                                    {settings?.site_logo ? (\n                                        <Image\n                                            src={settings.site_logo as string}\n                                            alt={(settings?.site_name as string) || \"Logo\"}\n                                            width={32}\n                                            height={32}\n                                            className=\"w-8 h-8 rounded-lg object-cover\"\n                                            unoptimized\n                                        />\n                                    ) : (\n                                        <Compass className=\"w-5 h-5 text-primary\" />\n                                    )}\n                                    <span className=\"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-blue-600\">\n                                        {(settings?.site_name as string) || \"دليل السويس\"}\n                                    </span>\n                                </Link>\n                                <button\n                                    className=\"p-2 -ml-2 hover:bg-muted rounded-full transition-colors\"\n                                    onClick={() => setIsMenuOpen(false)}\n                                >\n                                    <X size={24} />\n                                </button>\n                            </div>\n\n                            {/* Menu Links */}\n                            <div className=\"container mx-auto px-4 py-6 space-y-2\">\n                                <Link\n                                    href=\"/\"\n                                    className=\"block px-4 py-3 text-base font-medium rounded-xl hover:bg-muted transition-colors\"\n                                    onClick={() => setIsMenuOpen(false)}\n                                >\n                                    الرئيسية\n                                </Link>\n                                <Link\n                                    href=\"/categories\"\n                                    className=\"block px-4 py-3 text-base font-medium rounded-xl hover:bg-muted transition-colors\"\n                                    onClick={() => setIsMenuOpen(false)}\n                                >\n                                    التصنيفات\n                                </Link>\n                                <Link\n                                    href=\"/places\"\n                                    className=\"block px-4 py-3 text-base font-medium rounded-xl hover:bg-muted transition-colors\"\n                                    onClick={() => setIsMenuOpen(false)}\n                                >\n                                    الأماكن\n                                </Link>\n                                <Link\n                                    href=\"/events\"\n                                    className=\"block px-4 py-3 text-base font-medium rounded-xl hover:bg-muted transition-colors\"\n                                    onClick={() => setIsMenuOpen(false)}\n                                >\n                                    الفعاليات\n                                </Link>\n\n                                <div className=\"mt-4 pt-4 border-t border-border flex items-center justify-between px-4\">\n                                    <div className=\"flex items-center gap-2\">\n                                        <ThemeToggle />\n                                    </div>\n                                    {user ? (\n                                        <div className=\"flex flex-col gap-2 w-full\">\n                                            <Link\n                                                href=\"/profile\"\n                                                className=\"flex items-center justify-center gap-2 bg-primary/10 text-primary px-6 py-2.5 rounded-xl text-sm font-medium hover:bg-primary/20 transition-colors shadow-sm\"\n                                                onClick={() => setIsMenuOpen(false)}\n                                            >\n                                                <User size={18} />\n                                                <span>حسابي</span>\n                                            </Link>\n                                            <Link\n                                                href=\"/favorites\"\n                                                className=\"flex items-center justify-center gap-2 bg-red-50 text-red-500 px-6 py-2.5 rounded-xl text-sm font-medium hover:bg-red-100 transition-colors shadow-sm\"\n                                                onClick={() => setIsMenuOpen(false)}\n                                            >\n                                                <Heart size={18} className=\"fill-current\" />\n                                                <span>مفضلاتي</span>\n                                            </Link>\n                                        </div>\n                                    ) : (\n                                        <Link\n                                            href=\"/login\"\n                                            className=\"flex items-center justify-center gap-2 bg-primary text-primary-foreground px-6 py-2.5 rounded-xl text-sm font-medium hover:brightness-110 transition-colors shadow-sm\"\n                                            onClick={() => setIsMenuOpen(false)}\n                                        >\n                                            <User size={18} />\n                                            <span>تسجيل الدخول</span>\n                                        </Link>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>,\n                document.body\n            )}\n        </header>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/notification-bell.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/search-bar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/theme-provider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/components/shared/theme-toggle.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'theme' is assigned a value but never used.","line":8,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\"use client\"\n\nimport * as React from \"react\"\nimport { Moon, Sun } from \"lucide-react\"\nimport { useTheme } from \"next-themes\"\n\nexport function ThemeToggle() {\n    const { theme, setTheme, resolvedTheme } = useTheme()\n    const [mounted, setMounted] = React.useState(false)\n\n    React.useEffect(() => {\n        setMounted(true)\n    }, [])\n\n    if (!mounted) {\n        return (\n            <button className=\"rounded-full p-2 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors w-9 h-9\">\n                <span className=\"sr-only\">Toggle theme</span>\n            </button>\n        )\n    }\n\n    return (\n        <button\n            onClick={() => setTheme(resolvedTheme === \"light\" ? \"dark\" : \"light\")}\n            className=\"rounded-full p-2 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors relative w-9 h-9 flex items-center justify-center cursor-pointer\"\n            aria-label=\"Toggle theme\"\n        >\n            <Sun className={`h-5 w-5 transition-all absolute text-primary ${resolvedTheme === 'dark' ? '-rotate-90 scale-0' : 'rotate-0 scale-100'}`} />\n            <Moon className={`h-5 w-5 transition-all absolute text-primary-400 ${resolvedTheme === 'dark' ? 'rotate-0 scale-100' : 'rotate-90 scale-0'}`} />\n            <span className=\"sr-only\">Toggle theme</span>\n        </button>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/ai/chat-widget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/categories-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/categories/components/category-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/categories/components/category-icon.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'HelpCircle' is defined but never used.","line":23,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":23,"endColumn":15,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"HelpCircle"},"fix":{"range":[273,289],"text":""},"desc":"Remove unused variable \"HelpCircle\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n    Utensils,\n    Stethoscope,\n    ShoppingBag,\n    Briefcase,\n    Wrench,\n    Car,\n    GraduationCap,\n    Landmark,\n    Dumbbell,\n    Music,\n    Palette,\n    Plane,\n    Home,\n    Wifi,\n    Tv,\n    Coffee,\n    Pizza,\n    Scissors,\n    Shirt,\n    Laptop,\n    Folder,\n    HelpCircle,\n    LucideIcon\n} from 'lucide-react'\n\n// Map of icon names (lowercase) to Lucide components\nconst iconMap: Record<string, LucideIcon> = {\n    'utensils': Utensils,\n    'restaurant': Utensils,\n    'food': Utensils,\n    'stethoscope': Stethoscope,\n    'doctor': Stethoscope,\n    'health': Stethoscope,\n    'medical': Stethoscope,\n    'shopping-bag': ShoppingBag,\n    'shopping': ShoppingBag,\n    'shop': ShoppingBag,\n    'briefcase': Briefcase,\n    'work': Briefcase,\n    'wrench': Wrench,\n    'service': Wrench,\n    'repair': Wrench,\n    'car': Car,\n    'auto': Car,\n    'graduation-cap': GraduationCap,\n    'education': GraduationCap,\n    'school': GraduationCap,\n    'landmark': Landmark,\n    'bank': Landmark,\n    'government': Landmark,\n    'dumbbell': Dumbbell,\n    'gym': Dumbbell,\n    'fitness': Dumbbell,\n    'music': Music,\n    'entertainment': Music,\n    'palette': Palette,\n    'art': Palette,\n    'design': Palette,\n    'plane': Plane,\n    'travel': Plane,\n    'home': Home,\n    'real-estate': Home,\n    'wifi': Wifi,\n    'internet': Wifi,\n    'tv': Tv,\n    'electronics': Tv,\n    'coffee': Coffee,\n    'cafe': Coffee,\n    'pizza': Pizza,\n    'fast-food': Pizza,\n    'scissors': Scissors,\n    'salon': Scissors,\n    'barber': Scissors,\n    'shirt': Shirt,\n    'clothing': Shirt,\n    'fashion': Shirt,\n    'laptop': Laptop,\n    'tech': Laptop,\n    'computer': Laptop\n}\n\ninterface CategoryIconProps {\n    name?: string;\n    size?: number;\n    className?: string;\n}\n\nexport function CategoryIcon({ name, size = 24, className }: CategoryIconProps) {\n    if (!name) return <Folder size={size} className={className} />;\n\n    const normalizedName = name.toLowerCase().trim();\n    const IconComponent = iconMap[normalizedName] || Folder;\n\n    return <IconComponent size={size} className={className} />;\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/events/event-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/home-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/place-details-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places-list-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/favorite-button.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1682,1685],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1682,1685],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Heart } from 'lucide-react'\nimport { cn } from '@/lib/utils'\nimport { toggleFavoriteAction, checkIsFavoriteAction } from '@/actions/favorites.actions'\nimport { useRouter } from 'next/navigation'\n\ninterface FavoriteButtonProps {\n    placeId: string\n    initialIsFavorite?: boolean\n    className?: string\n    size?: number\n}\n\nexport function FavoriteButton({ placeId, initialIsFavorite = false, className, size = 20 }: FavoriteButtonProps) {\n    const [isFavorite, setIsFavorite] = useState(initialIsFavorite)\n    const [loading, setLoading] = useState(false)\n    const router = useRouter()\n\n    useEffect(() => {\n        // If initial state is not provided (or false default), ensure we check it\n        // Only checking if we suspect we might be logged in, but better to rely on parent passing initial state\n        // For now, let's assume parent might not pass it and we fetch if needed, \n        // OR better: parent passes it. If not passed, we can check.\n        const check = async () => {\n            const status = await checkIsFavoriteAction(placeId)\n            setIsFavorite(status)\n        }\n        if (initialIsFavorite === undefined) {\n            check()\n        }\n    }, [placeId, initialIsFavorite])\n\n    const handleToggle = async (e: React.MouseEvent) => {\n        e.preventDefault()\n        e.stopPropagation() // Prevent triggering card click\n\n        if (loading) return\n\n        // Optimistic update\n        const newState = !isFavorite\n        setIsFavorite(newState)\n        setLoading(true)\n\n        try {\n            await toggleFavoriteAction(placeId, newState)\n        } catch (error: any) {\n            // Revert\n            setIsFavorite(!newState)\n            if (error.message.includes('تسجيل الدخول')) {\n                router.push('/login')\n            } else {\n                console.error('Error toggling favorite:', error)\n            }\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <button\n            onClick={handleToggle}\n            className={cn(\n                \"transition-all duration-200 backdrop-blur-sm flex items-center justify-center\",\n                !className && \"p-2 rounded-full\",\n                !className && (isFavorite\n                    ? \"bg-red-50 text-red-500 hover:bg-red-100\"\n                    : \"bg-white/80 text-gray-500 hover:bg-white hover:text-red-500\"),\n                className,\n                isFavorite && className && \"text-red-500 bg-red-50 border-red-200\"\n            )}\n            disabled={loading}\n        >\n            <Heart size={size} className={cn(\"transition-all\", isFavorite && \"fill-current\")} />\n        </button>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/google-map-embed.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'e' is defined but never used.","line":20,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"interface GoogleMapEmbedProps {\n    mapLink?: string\n    placeName: string\n    address?: string\n}\n\nexport function GoogleMapEmbed({ mapLink, placeName, address }: GoogleMapEmbedProps) {\n    // Helper to extract query for the map\n    const getMapQuery = () => {\n        if (!mapLink) return `${placeName}, ${address || ''}`\n\n        try {\n            const url = new URL(mapLink)\n            // If it's a google maps link with 'q' param\n            if (url.searchParams.has('q')) {\n                return url.searchParams.get('q')\n            }\n            // If it's a short link or specific place link, ideally we'd need to expand it, \n            // but for now we fallback to place details\n        } catch (e) {\n            // Invalid URL\n        }\n\n        // Fallback: use exact address or place name\n        return `${placeName}, ${address || 'Suez, Egypt'}`\n    }\n\n    const query = encodeURIComponent(getMapQuery() || '')\n    const embedUrl = `https://maps.google.com/maps?q=${query}&t=&z=15&ie=UTF8&iwloc=&output=embed`\n\n    if (!mapLink && !address) {\n        return (\n            <div className=\"h-64 md:h-80 bg-muted rounded-xl flex flex-col items-center justify-center text-muted-foreground text-sm gap-2 border border-border\">\n                <span className=\"text-3xl\">🗺️</span>\n                <span>الخريطة غير متوفرة</span>\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"rounded-xl overflow-hidden border border-border shadow-sm h-64 md:h-80 relative bg-muted group\">\n            <iframe\n                width=\"100%\"\n                height=\"100%\"\n                src={embedUrl}\n                frameBorder=\"0\"\n                scrolling=\"no\"\n                marginHeight={0}\n                marginWidth={0}\n                className=\"w-full h-full filter grayscale-[20%] group-hover:grayscale-0 transition-all duration-500\"\n                title={`${placeName} Map`}\n                loading=\"lazy\"\n            ></iframe>\n\n            {/* Overlay to open in new tab (optional, but good for UX) */}\n            <a\n                href={mapLink || `https://www.google.com/maps/search/?api=1&query=${query}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"absolute top-3 right-3 bg-white/90 hover:bg-white text-xs font-semibold px-3 py-1.5 rounded-lg shadow-md backdrop-blur-sm transition-all opacity-0 group-hover:opacity-100 flex items-center gap-1 text-primary\"\n            >\n                فتح في خرائط جوجل\n                <svg className=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" /></svg>\n            </a>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/hero-search-bar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/place-action-buttons.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Heart' is defined but never used.","line":3,"column":75,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":80,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"Heart"},"fix":{"range":[86,93],"text":""},"desc":"Remove unused variable \"Heart\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'slug' is defined but never used.","line":25,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":25,"endColumn":9},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'err' is defined but never used.","line":40,"column":22,"nodeType":"Identifier","messageId":"unusedVar","endLine":40,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { Phone, MessageCircle, Share2, ExternalLink, Facebook, Instagram, Heart } from 'lucide-react'\nimport { useState } from 'react'\nimport { FavoriteButton } from './favorite-button'\n\ninterface PlaceActionButtonsProps {\n    phone?: string\n    whatsapp?: string\n    website?: string\n    facebook?: string\n    instagram?: string\n    placeName: string\n    slug: string\n    placeId: string\n}\n\nexport function PlaceActionButtons({\n    phone,\n    whatsapp,\n    website,\n    facebook,\n    instagram,\n    placeName,\n    slug,\n    placeId\n}: PlaceActionButtonsProps) {\n    const [shareSuccess, setShareSuccess] = useState(false)\n\n    const handleShare = async () => {\n        const shareData = {\n            title: placeName,\n            text: `تعرف على ${placeName} على دليل السويس`,\n            url: window.location.href\n        }\n\n        if (navigator.share) {\n            try {\n                await navigator.share(shareData)\n            } catch (err) {\n                console.log('Share cancelled')\n            }\n        } else {\n            // Fallback: copy link\n            navigator.clipboard.writeText(window.location.href)\n            setShareSuccess(true)\n            setTimeout(() => setShareSuccess(false), 2000)\n        }\n    }\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Primary Actions */}\n            <div className=\"grid grid-cols-2 gap-3\">\n                {phone && (\n                    <a\n                        href={`tel:${phone}`}\n                        className=\"bg-gradient-to-r from-yellow-500 to-amber-600 hover:from-yellow-600 hover:to-amber-700 text-white px-6 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2\"\n                    >\n                        <Phone size={20} />\n                        <span>اتصال</span>\n                    </a>\n                )}\n\n                {(whatsapp || phone) && (\n                    <a\n                        href={`https://wa.me/${(whatsapp || phone)?.replace(/[^0-9]/g, '')}`}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white px-6 py-4 rounded-xl font-bold transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2\"\n                    >\n                        <MessageCircle size={20} />\n                        <span>واتساب</span>\n                    </a>\n                )}\n            </div>\n\n            {/* Secondary Actions */}\n            <div className=\"flex gap-2\">\n                <FavoriteButton\n                    placeId={placeId}\n                    className=\"flex-1 bg-card hover:bg-muted border border-border text-foreground px-4 py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2 data-[active=true]:bg-red-50 data-[active=true]:text-red-600 data-[active=true]:border-red-200\"\n                    size={18}\n                />\n\n                <button\n                    onClick={handleShare}\n                    className=\"flex-1 bg-card hover:bg-muted border border-border text-foreground px-4 py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2\"\n                >\n                    <Share2 size={18} />\n                    <span>{shareSuccess ? 'تم النسخ!' : 'مشاركة'}</span>\n                </button>\n\n                {website && (\n                    <a\n                        href={website}\n                        target=\"_blank\"\n                        rel=\"noopener noreferrer\"\n                        className=\"flex-1 bg-card hover:bg-muted border border-border text-foreground px-4 py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2\"\n                    >\n                        <ExternalLink size={18} />\n                        <span>الموقع</span>\n                    </a>\n                )}\n            </div>\n\n            {/* Social Links */}\n            {(facebook || instagram) && (\n                <div className=\"flex gap-2 pt-2\">\n                    {facebook && (\n                        <a\n                            href={facebook}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-xl font-medium transition-colors flex items-center justify-center gap-2\"\n                        >\n                            <Facebook size={18} />\n                            <span>Facebook</span>\n                        </a>\n                    )}\n                    {instagram && (\n                        <a\n                            href={instagram}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"flex-1 bg-gradient-to-r from-purple-500 via-pink-500 to-orange-500 hover:opacity-90 text-white px-4 py-3 rounded-xl font-medium transition-opacity flex items-center justify-center gap-2\"\n                        >\n                            <Instagram size={18} />\n                            <span>Instagram</span>\n                        </a>\n                    )}\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/place-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/place-image-slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/places-filters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/places-search-bar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/places/components/star-rating.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/activity-dashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/danger-zone.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'UserX' is defined but never used.","line":4,"column":33,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":38,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"UserX"},"fix":{"range":[77,84],"text":""},"desc":"Remove unused variable \"UserX\"."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is defined but never used.","line":14,"column":30,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":34}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { AlertTriangle, Trash2, UserX, Loader2 } from 'lucide-react'\nimport { sendDeleteAccountCode, deleteAccountPermanently } from '../../../actions/profile-security.actions'\n\nimport { User as SupabaseUser } from '@supabase/supabase-js'\n\ninterface DangerZoneProps {\n    user: SupabaseUser | null\n    isOAuthUser: boolean\n}\n\nexport function DangerZone({ user, isOAuthUser }: DangerZoneProps) {\n    const [showDeleteModal, setShowDeleteModal] = useState(false)\n    const [deleteStep, setDeleteStep] = useState<'confirm' | 'verify'>('confirm')\n    const [confirmText, setConfirmText] = useState('')\n    const [verificationCode, setVerificationCode] = useState('')\n    const [password, setPassword] = useState('')\n    const [loading, setLoading] = useState(false)\n\n    const handleDeleteRequest = async () => {\n        if (confirmText !== 'حذف حسابي') {\n            alert('يرجى كتابة \"حذف حسابي\" للتأكيد')\n            return\n        }\n\n        setLoading(true)\n        try {\n            if (isOAuthUser) {\n                // Send verification code to email\n                const result = await sendDeleteAccountCode()\n                setDeleteStep('verify')\n\n                // In development, show the code directly\n                if (result.code) {\n                    alert(`رمز التحقق (للتطوير فقط): ${result.code}\\n\\nتم إرسال رمز التحقق إلى بريدك الإلكتروني`)\n                } else {\n                    alert('تم إرسال رمز التحقق إلى بريدك الإلكتروني')\n                }\n            } else {\n                // Move to password verification\n                setDeleteStep('verify')\n            }\n        } catch (error) {\n            alert(error instanceof Error ? error.message : 'حدث خطأ')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    const handleDeleteConfirm = async () => {\n        setLoading(true)\n        try {\n            if (isOAuthUser) {\n                await deleteAccountPermanently({ code: verificationCode })\n            } else {\n                await deleteAccountPermanently({ password })\n            }\n\n            // Account deleted, redirect to home\n            window.location.href = '/'\n        } catch (error) {\n            alert(error instanceof Error ? error.message : 'فشل حذف الحساب')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"p-4 bg-red-100/50 dark:bg-red-950/30 border border-red-200 dark:border-red-800 rounded-xl\">\n                <div className=\"flex items-start gap-3 mb-4\">\n                    <AlertTriangle className=\"text-red-700 dark:text-red-400 mt-0.5 flex-shrink-0\" size={20} />\n                    <div>\n                        <h3 className=\"font-bold text-red-950 dark:text-red-500 mb-2\">منطقة الخطر</h3>\n                        <p className=\"text-sm text-red-900 dark:text-red-500 leading-relaxed font-semibold\">\n                            الإجراءات التالية لا يمكن التراجع عنها. يرجى التأكد قبل المتابعة.\n                        </p>\n                    </div>\n                </div>\n\n                <div className=\"space-y-3\">\n                    <button\n                        onClick={() => setShowDeleteModal(true)}\n                        className=\"w-full flex items-center justify-center gap-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl transition-colors font-medium shadow-sm\"\n                    >\n                        <Trash2 size={18} />\n                        حذف الحساب نهائياً\n                    </button>\n                </div>\n            </div>\n\n            {/* Delete Modal */}\n            {showDeleteModal && (\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200\">\n                    <div className=\"bg-card w-full max-w-md rounded-2xl shadow-2xl border border-border p-6 animate-in zoom-in-95 duration-200\">\n                        <div className=\"flex items-center gap-3 mb-4\">\n                            <div className=\"p-2 bg-red-100 dark:bg-red-900/30 rounded-lg\">\n                                <AlertTriangle className=\"text-red-600 dark:text-red-400\" size={24} />\n                            </div>\n                            <h2 className=\"text-xl font-bold\">حذف الحساب نهائياً</h2>\n                        </div>\n\n                        {deleteStep === 'confirm' ? (\n                            <>\n                                <div className=\"mb-6 space-y-3\">\n                                    <p className=\"text-sm text-muted-foreground\">\n                                        ⚠️ سيتم حذف جميع بياناتك بشكل نهائي:\n                                    </p>\n                                    <ul className=\"text-sm text-muted-foreground list-disc list-inside space-y-1\">\n                                        <li>جميع المراجعات التي كتبتها</li>\n                                        <li>قائمة المفضلات</li>\n                                        <li>الإشعارات</li>\n                                        <li>معلومات الحساب</li>\n                                    </ul>\n                                    <p className=\"text-sm font-medium text-red-600 dark:text-red-400\">\n                                        هذا الإجراء لا يمكن التراجع عنه!\n                                    </p>\n                                </div>\n\n                                <div className=\"mb-6\">\n                                    <label className=\"block text-sm font-medium mb-2\">\n                                        اكتب &quot;حذف حسابي&quot; للتأكيد:\n                                    </label>\n                                    <input\n                                        type=\"text\"\n                                        value={confirmText}\n                                        onChange={e => setConfirmText(e.target.value)}\n                                        className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-red-500/20 focus:border-red-500 outline-none\"\n                                        placeholder=\"حذف حسابي\"\n                                    />\n                                </div>\n\n                                <div className=\"flex gap-3\">\n                                    <button\n                                        onClick={() => {\n                                            setShowDeleteModal(false)\n                                            setConfirmText('')\n                                            setDeleteStep('confirm')\n                                        }}\n                                        className=\"flex-1 px-4 py-2 rounded-lg border border-input hover:bg-muted transition-colors font-medium\"\n                                        disabled={loading}\n                                    >\n                                        إلغاء\n                                    </button>\n                                    <button\n                                        onClick={handleDeleteRequest}\n                                        className=\"flex-1 px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors font-medium flex items-center justify-center gap-2\"\n                                        disabled={loading || confirmText !== 'حذف حسابي'}\n                                    >\n                                        {loading && <Loader2 size={16} className=\"animate-spin\" />}\n                                        متابعة\n                                    </button>\n                                </div>\n                            </>\n                        ) : (\n                            <>\n                                <div className=\"mb-6\">\n                                    {isOAuthUser ? (\n                                        <>\n                                            <p className=\"text-sm text-muted-foreground mb-4\">\n                                                تم إرسال رمز التحقق إلى بريدك الإلكتروني. أدخل الرمز للمتابعة:\n                                            </p>\n                                            <input\n                                                type=\"text\"\n                                                value={verificationCode}\n                                                onChange={e => setVerificationCode(e.target.value)}\n                                                className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-red-500/20 focus:border-red-500 outline-none text-center text-2xl tracking-widest\"\n                                                placeholder=\"000000\"\n                                                maxLength={6}\n                                            />\n                                        </>\n                                    ) : (\n                                        <>\n                                            <p className=\"text-sm text-muted-foreground mb-4\">\n                                                أدخل كلمة المرور للتأكيد:\n                                            </p>\n                                            <input\n                                                type=\"password\"\n                                                value={password}\n                                                onChange={e => setPassword(e.target.value)}\n                                                className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-red-500/20 focus:border-red-500 outline-none\"\n                                                placeholder=\"كلمة المرور\"\n                                            />\n                                        </>\n                                    )}\n                                </div>\n\n                                <div className=\"flex gap-3\">\n                                    <button\n                                        onClick={() => {\n                                            setDeleteStep('confirm')\n                                            setVerificationCode('')\n                                            setPassword('')\n                                        }}\n                                        className=\"flex-1 px-4 py-2 rounded-lg border border-input hover:bg-muted transition-colors font-medium\"\n                                        disabled={loading}\n                                    >\n                                        رجوع\n                                    </button>\n                                    <button\n                                        onClick={handleDeleteConfirm}\n                                        className=\"flex-1 px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors font-medium flex items-center justify-center gap-2\"\n                                        disabled={loading || (isOAuthUser ? verificationCode.length !== 6 : !password)}\n                                    >\n                                        {loading && <Loader2 size={16} className=\"animate-spin\" />}\n                                        حذف الحساب\n                                    </button>\n                                </div>\n                            </>\n                        )}\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/notification-settings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used.","line":8,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16,"suggestions":[{"messageId":"removeUnusedImportDeclaration","data":{"varName":"Button"},"fix":{"range":[329,378],"text":""},"desc":"Remove unused import declaration."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[719,722],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[719,722],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":44,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":44,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Loader2, Bell, Mail, Smartphone, RefreshCw } from 'lucide-react'\nimport { Switch } from '@/presentation/ui/switch'\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/presentation/ui/card'\nimport { Label } from '@/presentation/ui/label'\nimport { Button } from '@/presentation/ui/button'\nimport { getNotificationPreferences, updateNotificationPreferences } from '@/actions/notification-preferences.actions'\nimport { toast } from 'sonner'\n\nexport function NotificationSettings() {\n    const [loading, setLoading] = useState(true)\n    const [saving, setSaving] = useState(false)\n    const [preferences, setPreferences] = useState<any>(null)\n\n    useEffect(() => {\n        loadPreferences()\n    }, [])\n\n    const loadPreferences = async () => {\n        try {\n            const data = await getNotificationPreferences()\n            setPreferences(data)\n        } catch (error) {\n            console.error(error)\n            toast.error('فشل تحميل التفضيلات')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    const handleToggle = async (key: string, value: boolean) => {\n        // Optimistic update\n        const oldPreferences = { ...preferences }\n        const newPreferences = { ...preferences, [key]: value }\n\n        setPreferences(newPreferences)\n        setSaving(true)\n\n        try {\n            await updateNotificationPreferences(newPreferences)\n            // toast.success('تم تحديث التفضيلات')\n        } catch (error) {\n            setPreferences(oldPreferences) // Revert on error\n            toast.error('فشل تحديث التفضيلات')\n        } finally {\n            setSaving(false)\n        }\n    }\n\n    if (loading) {\n        return (\n            <div className=\"flex justify-center items-center py-12\">\n                <Loader2 className=\"animate-spin h-8 w-8 text-muted-foreground\" />\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"space-y-6 animate-in fade-in duration-500\">\n            <div>\n                <h2 className=\"text-2xl font-bold mb-2\">إعدادات الإشعارات</h2>\n                <p className=\"text-muted-foreground\">تحكم في الإشعارات التي تصلك منا</p>\n            </div>\n\n            <Card>\n                <CardHeader>\n                    <div className=\"flex items-center gap-2\">\n                        <Bell className=\"h-5 w-5 text-primary\" />\n                        <CardTitle>قنوات التواصل</CardTitle>\n                    </div>\n                    <CardDescription>اختر الوسائل التي تفضل استلام الإشعارات عبرها</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <div className=\"flex items-center gap-2\">\n                            <Mail className=\"h-4 w-4 text-muted-foreground\" />\n                            <Label htmlFor=\"email_notifications\" className=\"flex flex-col space-y-1\">\n                                <span>البريد الإلكتروني</span>\n                                <span className=\"font-normal text-xs text-muted-foreground\">استلام ملخصات وتحديثات عبر البريد</span>\n                            </Label>\n                        </div>\n                        <Switch\n                            id=\"email_notifications\"\n                            checked={preferences.email_notifications}\n                            onCheckedChange={(checked: boolean) => handleToggle('email_notifications', checked)}\n                        />\n                    </div>\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <div className=\"flex items-center gap-2\">\n                            <Smartphone className=\"h-4 w-4 text-muted-foreground\" />\n                            <Label htmlFor=\"push_notifications\" className=\"flex flex-col space-y-1\">\n                                <span>إشعارات التطبيق</span>\n                                <span className=\"font-normal text-xs text-muted-foreground\">إشعارات فورية داخل المتصفح/التطبيق</span>\n                            </Label>\n                        </div>\n                        <Switch\n                            id=\"push_notifications\"\n                            checked={preferences.push_notifications}\n                            onCheckedChange={(checked: boolean) => handleToggle('push_notifications', checked)}\n                        />\n                    </div>\n                </CardContent>\n            </Card>\n\n            <Card>\n                <CardHeader>\n                    <CardTitle>ننوع الإشعارات</CardTitle>\n                    <CardDescription>حدد الأنشطة التي تهمك</CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <Label htmlFor=\"notify_new_reviews\" className=\"flex flex-col space-y-1\">\n                            <span>مراجعات جديدة</span>\n                            <span className=\"font-normal text-xs text-muted-foreground\">عندما يضيف شخص مراجعة لأماكنك المفضلة</span>\n                        </Label>\n                        <Switch\n                            id=\"notify_new_reviews\"\n                            checked={preferences.notify_new_reviews}\n                            onCheckedChange={(checked: boolean) => handleToggle('notify_new_reviews', checked)}\n                        />\n                    </div>\n\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <Label htmlFor=\"notify_review_replies\" className=\"flex flex-col space-y-1\">\n                            <span>الردود على مراجعاتك</span>\n                            <span className=\"font-normal text-xs text-muted-foreground\">عندما يرد صاحب مكان أو مستخدم على مراجعتك</span>\n                        </Label>\n                        <Switch\n                            id=\"notify_review_replies\"\n                            checked={preferences.notify_review_replies}\n                            onCheckedChange={(checked: boolean) => handleToggle('notify_review_replies', checked)}\n                        />\n                    </div>\n\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <Label htmlFor=\"notify_favorite_updates\" className=\"flex flex-col space-y-1\">\n                            <span>تحديثات المفضلة</span>\n                            <span className=\"font-normal text-xs text-muted-foreground\">تغييرات في مواعيد عمل أو تفاصيل أماكنك المفضلة</span>\n                        </Label>\n                        <Switch\n                            id=\"notify_favorite_updates\"\n                            checked={preferences.notify_favorite_updates}\n                            onCheckedChange={(checked: boolean) => handleToggle('notify_favorite_updates', checked)}\n                        />\n                    </div>\n\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <Label htmlFor=\"notify_account_changes\" className=\"flex flex-col space-y-1\">\n                            <span>أمان الحساب</span>\n                            <span className=\"font-normal text-xs text-muted-foreground\">تنبيهات تسجيل الدخول وتغييرات كلمة المرور (موصى به)</span>\n                        </Label>\n                        <Switch\n                            id=\"notify_account_changes\"\n                            checked={preferences.notify_account_changes}\n                            onCheckedChange={(checked: boolean) => handleToggle('notify_account_changes', checked)}\n                        />\n                    </div>\n\n                    <div className=\"flex items-center justify-between space-x-2\">\n                        <Label htmlFor=\"notify_marketing\" className=\"flex flex-col space-y-1\">\n                            <span>أخبار وعروض</span>\n                            <span className=\"font-normal text-xs text-muted-foreground\">آخر أخبار دليل السويس والعروض الحصرية</span>\n                        </Label>\n                        <Switch\n                            id=\"notify_marketing\"\n                            checked={preferences.notify_marketing}\n                            onCheckedChange={(checked: boolean) => handleToggle('notify_marketing', checked)}\n                        />\n                    </div>\n                </CardContent>\n            </Card>\n\n            <div className=\"flex justify-end\">\n                {saving && <span className=\"text-sm text-muted-foreground flex items-center gap-1\"><RefreshCw className=\"h-3 w-3 animate-spin\" /> جاري الحفظ...</span>}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/overview-section.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[152,155],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[152,155],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[169,172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[169,172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'profile' is defined but never used.","line":12,"column":41,"nodeType":"Identifier","messageId":"unusedVar","endLine":12,"endColumn":48}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { User, Mail, Calendar, Heart, Star } from 'lucide-react'\nimport Link from 'next/link'\n\ninterface OverviewSectionProps {\n    user: any\n    profile: any\n    isAdmin: boolean\n}\n\nexport function OverviewSection({ user, profile, isAdmin }: OverviewSectionProps) {\n    return (\n        <div className=\"space-y-6\">\n            {/* User Info */}\n            <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-bold\">معلومات الحساب</h3>\n\n                <div className=\"grid gap-4\">\n                    <div className=\"flex items-center gap-3 p-4 bg-muted/50 rounded-xl border border-border\">\n                        <div className=\"p-2 bg-primary/10 text-primary rounded-lg\">\n                            <User size={20} />\n                        </div>\n                        <div>\n                            <p className=\"text-sm text-muted-foreground\">الاسم</p>\n                            <p className=\"font-medium text-foreground\">\n                                {user.user_metadata?.full_name || 'مستخدم دليل السويس'}\n                            </p>\n                        </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-3 p-4 bg-muted/50 rounded-xl border border-border\">\n                        <div className=\"p-2 bg-primary/10 text-primary rounded-lg\">\n                            <Mail size={20} />\n                        </div>\n                        <div>\n                            <p className=\"text-sm text-muted-foreground\">البريد الإلكتروني</p>\n                            <p className=\"font-medium text-foreground\">{user.email}</p>\n                        </div>\n                    </div>\n\n                    <div className=\"flex items-center gap-3 p-4 bg-muted/50 rounded-xl border border-border\">\n                        <div className=\"p-2 bg-primary/10 text-primary rounded-lg\">\n                            <Calendar size={20} />\n                        </div>\n                        <div>\n                            <p className=\"text-sm text-muted-foreground\">تاريخ الانضمام</p>\n                            <p className=\"font-medium text-foreground\">\n                                {new Date(user.created_at).toLocaleDateString('ar-EG', {\n                                    year: 'numeric',\n                                    month: 'long',\n                                    day: 'numeric'\n                                })}\n                            </p>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            {/* Quick Links */}\n            <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-bold\">روابط سريعة</h3>\n\n                <div className=\"grid gap-3\">\n                    <Link\n                        href=\"/favorites\"\n                        className=\"flex items-center gap-3 p-4 bg-card hover:bg-accent border border-border rounded-xl transition-all group\"\n                    >\n                        <div className=\"p-2 bg-red-500/10 text-red-500 rounded-lg\">\n                            <Heart size={20} className=\"fill-current\" />\n                        </div>\n                        <div className=\"flex-1\">\n                            <p className=\"font-bold text-foreground\">مفضلاتي</p>\n                            <p className=\"text-sm text-muted-foreground\">الأماكن المحفوظة</p>\n                        </div>\n                    </Link>\n\n                    {isAdmin && (\n                        <Link\n                            href=\"/admin\"\n                            className=\"flex items-center gap-3 p-4 bg-card hover:bg-accent border border-border rounded-xl transition-all group\"\n                        >\n                            <div className=\"p-2 bg-indigo-500/10 text-indigo-500 rounded-lg\">\n                                <Star size={20} />\n                            </div>\n                            <div className=\"flex-1\">\n                                <p className=\"font-bold text-foreground\">لوحة التحكم</p>\n                                <p className=\"text-sm text-muted-foreground\">أنت تمتلك صلاحيات الأدمن</p>\n                            </div>\n                        </Link>\n                    )}\n                </div>\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/profile-content.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1215,1218],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1215,1218],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1269,1272],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1269,1272],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":29,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1440,1443],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1440,1443],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":116,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":116,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4244,4247],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4244,4247],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":154,"column":37,"nodeType":"JSXOpeningElement","endLine":154,"endColumn":132}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport { User, Loader2, LogOut, Shield, AlertTriangle, LifeBuoy, Bell, Activity } from 'lucide-react'\nimport { ProfileTabs, type TabItem } from '@/presentation/features/profile/profile-tabs'\nimport { OverviewSection } from '@/presentation/features/profile/overview-section'\nimport { SecuritySection } from '@/presentation/features/profile/security-section'\nimport { DangerZone } from '@/presentation/features/profile/danger-zone'\nimport { SupportList } from '@/presentation/features/profile/support/support-list'\nimport { getUserTickets } from '@/actions/support.actions'\nimport { NotificationSettings } from '@/presentation/features/profile/notification-settings'\nimport { ActivityDashboard } from '@/presentation/features/profile/activity-dashboard'\nimport {\n    Accordion,\n    AccordionContent,\n    AccordionItem,\n    AccordionTrigger,\n} from \"@/presentation/ui/accordion\"\n\ntype TabType = 'overview' | 'security' | 'danger' | 'support' | 'notifications' | 'activity'\n\nexport function ProfileContent() {\n    const [user, setUser] = useState<any>(null)\n    const [profile, setProfile] = useState<any>(null)\n    const [loading, setLoading] = useState(true)\n    const [activeTab, setActiveTab] = useState<TabType>('overview')\n    const [tickets, setTickets] = useState<any[]>([])\n    const router = useRouter()\n    const searchParams = useSearchParams()\n    const supabase = createClient()\n\n    // Get ticketId from URL if present\n    const ticketIdParam = searchParams.get('ticketId')\n\n    const [isEditing, setIsEditing] = useState(false)\n    const [formData, setFormData] = useState({ fullName: '', password: '' })\n    const [saving, setSaving] = useState(false)\n\n    // Handle initial tab from URL\n    useEffect(() => {\n        const tabParam = searchParams.get('tab')\n        if (tabParam && ['overview', 'security', 'danger', 'support', 'notifications', 'activity'].includes(tabParam)) {\n            setActiveTab(tabParam as TabType)\n        }\n    }, [searchParams])\n\n    useEffect(() => {\n        const getUser = async () => {\n            try {\n                const { data: { user }, error } = await supabase.auth.getUser()\n\n                if (error || !user) {\n                    router.push('/login')\n                    return\n                }\n\n                setUser(user)\n                setFormData(prev => ({ ...prev, fullName: user.user_metadata?.full_name || '' }))\n\n                // Fetch extra profile data (role)\n                const { data: profile } = await supabase\n                    .from('profiles')\n                    .select('*')\n                    .eq('id', user.id)\n                    .single()\n\n                if (profile) {\n                    setProfile(profile)\n                }\n\n            } catch (error) {\n                console.error('Error fetching user:', error)\n            } finally {\n                setLoading(false)\n            }\n        }\n\n        getUser()\n    }, [router, supabase])\n\n    useEffect(() => {\n        if (activeTab === 'support' && user) {\n            const fetchTickets = async () => {\n                try {\n                    const data = await getUserTickets()\n                    setTickets(data || [])\n                } catch (error) {\n                    console.error('Error fetching tickets:', error)\n                }\n            }\n            fetchTickets()\n        }\n    }, [activeTab, user])\n\n    const handleSignOut = async () => {\n        await supabase.auth.signOut()\n        router.push('/')\n        router.refresh()\n    }\n\n    const handleSave = async (e: React.FormEvent) => {\n        e.preventDefault()\n        setSaving(true)\n        try {\n            const { updateProfile } = await import('@/actions/profile.actions')\n            await updateProfile(formData)\n\n            // Refresh local user data\n            const { data: { user } } = await supabase.auth.getUser()\n            setUser(user)\n            setIsEditing(false)\n            setFormData(prev => ({ ...prev, password: '' })) // Clear password\n            alert('تم حفظ التغييرات بنجاح')\n        } catch (error: any) {\n            alert(error.message || 'حدث خطأ أثناء الحفظ')\n        } finally {\n            setSaving(false)\n        }\n    }\n\n    if (loading) {\n        return (\n            <div className=\"min-h-[80vh] flex items-center justify-center\">\n                <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n        )\n    }\n\n    if (!user) return null\n\n    const isAdmin = profile?.role === 'admin' || profile?.role === 'super_admin'\n    const isOAuthUser = user.app_metadata?.provider === 'google' || user.app_metadata?.provider === 'facebook'\n\n    const tabs: (TabItem & { component: React.ReactNode })[] = [\n        { id: 'overview', label: 'نظرة عامة', icon: User, component: <OverviewSection user={user} profile={profile} isAdmin={isAdmin} /> },\n        { id: 'activity', label: 'النشاط', icon: Activity, component: <ActivityDashboard /> },\n        { id: 'security', label: 'الأمان', icon: Shield, component: <SecuritySection user={user} isOAuthUser={isOAuthUser} /> },\n        { id: 'notifications', label: 'الإشعارات', icon: Bell, component: <NotificationSettings /> },\n        { id: 'support', label: 'الدعم الفني', icon: LifeBuoy, component: <SupportList tickets={tickets} initialTicketId={ticketIdParam} /> },\n        { id: 'danger', label: 'منطقة الخطر', icon: AlertTriangle, component: <DangerZone user={user} isOAuthUser={isOAuthUser} /> },\n    ]\n\n    return (\n        <div className=\"container mx-auto px-4 py-12 relative\">\n            <div className=\"max-w-4xl mx-auto bg-card border border-border rounded-3xl overflow-hidden shadow-xl relative z-10\">\n                {/* Header/Cover */}\n                <div className=\"h-32 bg-gradient-to-r from-primary to-blue-600 relative\">\n                    <div className=\"absolute -bottom-10 right-8\">\n                        <div className=\"w-24 h-24 bg-card rounded-full p-1 border-4 border-card\">\n                            <div className=\"w-full h-full bg-muted rounded-full flex items-center justify-center text-muted-foreground overflow-hidden\">\n                                {user.user_metadata?.avatar_url ? (\n                                    <img src={user.user_metadata.avatar_url} alt=\"avatar\" className=\"w-full h-full object-cover\" />\n                                ) : (\n                                    <User size={40} />\n                                )}\n                            </div>\n                        </div>\n                    </div>\n                    {/* Edit Button */}\n                    <div className=\"absolute bottom-4 left-4\">\n                        <button\n                            onClick={() => setIsEditing(true)}\n                            className=\"bg-black/20 hover:bg-black/40 text-white px-4 py-2 rounded-full text-sm font-medium backdrop-blur-sm transition-colors border border-white/20\"\n                        >\n                            تعديل الملف الشخصي\n                        </button>\n                    </div>\n                </div>\n\n                <div className=\"pt-16 pb-8 px-8\">\n                    <div className=\"mb-6\">\n                        <h1 className=\"text-2xl font-bold text-foreground\">\n                            {user.user_metadata?.full_name || 'مستخدم دليل السويس'}\n                        </h1>\n                        <p className=\"text-muted-foreground text-sm mt-1\">\n                            {user.email}\n                        </p>\n                    </div>\n\n                    {/* Mobile View: Accordion */}\n                    <div className=\"md:hidden\">\n                        <Accordion type=\"single\" collapsible value={activeTab} onValueChange={(val) => val && setActiveTab(val as TabType)}>\n                            {tabs.map((tab) => (\n                                <AccordionItem key={tab.id} value={tab.id}>\n                                    <AccordionTrigger>\n                                        <div className=\"flex items-center gap-2\">\n                                            <tab.icon size={18} />\n                                            <span>{tab.label}</span>\n                                        </div>\n                                    </AccordionTrigger>\n                                    <AccordionContent>\n                                        <div className=\"pt-2\">\n                                            {tab.component}\n                                        </div>\n                                    </AccordionContent>\n                                </AccordionItem>\n                            ))}\n                        </Accordion>\n                    </div>\n\n                    {/* Desktop View: Tabs */}\n                    <div className=\"hidden md:block\">\n                        <ProfileTabs items={tabs} activeTab={activeTab} onTabChange={setActiveTab} />\n                        <div className=\"mt-6\">\n                            {tabs.find(t => t.id === activeTab)?.component}\n                        </div>\n                    </div>\n\n                    {/* Logout Button */}\n                    <div className=\"mt-8 pt-8 border-t border-border\">\n                        <button\n                            onClick={handleSignOut}\n                            className=\"flex items-center justify-center gap-2 w-full p-4 text-destructive bg-card border border-border hover:bg-destructive/10 hover:border-destructive/30 rounded-xl transition-all font-medium\"\n                        >\n                            <LogOut size={20} />\n                            تسجيل الخروج\n                        </button>\n                    </div>\n                </div>\n            </div>\n\n            {/* Edit Modal Overlay */}\n            {isEditing && (\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200\">\n                    <div className=\"bg-card w-full max-w-md rounded-2xl shadow-2xl border border-border p-6 animate-in zoom-in-95 duration-200\">\n                        <div className=\"flex items-center justify-between mb-6\">\n                            <h2 className=\"text-xl font-bold\">تعديل الملف الشخصي</h2>\n                            <button onClick={() => setIsEditing(false)} className=\"size-8 flex items-center justify-center hover:bg-muted rounded-full transition-colors\">\n                                ✕\n                            </button>\n                        </div>\n\n                        <form onSubmit={handleSave} className=\"space-y-4\">\n                            <div>\n                                <label className=\"block text-sm font-medium mb-1.5\">الاسم</label>\n                                <input\n                                    type=\"text\"\n                                    value={formData.fullName}\n                                    onChange={e => setFormData({ ...formData, fullName: e.target.value })}\n                                    className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                    placeholder=\"الاسم الكامل\"\n                                    required\n                                />\n                            </div>\n\n                            <div className=\"flex gap-3 pt-4\">\n                                <button\n                                    type=\"button\"\n                                    onClick={() => setIsEditing(false)}\n                                    className=\"flex-1 px-4 py-2 rounded-lg border border-input hover:bg-muted transition-colors font-medium\"\n                                    disabled={saving}\n                                >\n                                    إلغاء\n                                </button>\n                                <button\n                                    type=\"submit\"\n                                    className=\"flex-1 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors font-medium flex items-center justify-center gap-2\"\n                                    disabled={saving}\n                                >\n                                    {saving && <Loader2 size={16} className=\"animate-spin\" />}\n                                    حفظ التغييرات\n                                </button>\n                            </div>\n                        </form>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/profile-tabs.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[252,255],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[252,255],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { cn } from '@/lib/utils'\nimport { LucideIcon } from 'lucide-react'\n\nexport type TabItem = {\n    id: string\n    label: string\n    icon: LucideIcon\n}\n\ninterface ProfileTabsProps {\n    items: TabItem[]\n    activeTab: string\n    onTabChange: (tab: any) => void\n}\n\nexport function ProfileTabs({ items, activeTab, onTabChange }: ProfileTabsProps) {\n    return (\n        <div className=\"border-b border-border mb-6 -mx-8 px-8 overflow-x-auto\">\n            <nav className=\"flex gap-1 min-w-max\">\n                {items.map((tab) => {\n                    const Icon = tab.icon\n                    const isActive = activeTab === tab.id\n\n                    return (\n                        <button\n                            key={tab.id}\n                            onClick={() => onTabChange(tab.id)}\n                            className={cn(\n                                \"flex items-center gap-2 px-6 py-3 font-medium text-sm whitespace-nowrap transition-all border-b-2 min-w-fit\",\n                                isActive\n                                    ? \"text-primary border-primary bg-primary/5\"\n                                    : \"text-muted-foreground border-transparent hover:text-foreground hover:bg-muted/50\"\n                            )}\n                        >\n                            <Icon size={18} />\n                            <span>{tab.label}</span>\n                        </button>\n                    )\n                })}\n            </nav>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/security-section.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":11,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":14,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[141,144],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[141,144],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'user' is defined but never used.","line":11,"column":35,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":39},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":41,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1304,1307],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1304,1307],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { Lock, Key, Loader2 } from 'lucide-react'\n\ninterface SecuritySectionProps {\n    user: any\n    isOAuthUser: boolean\n}\n\nexport function SecuritySection({ user, isOAuthUser }: SecuritySectionProps) {\n    const [isChangingPassword, setIsChangingPassword] = useState(false)\n    const [currentPassword, setCurrentPassword] = useState('')\n    const [newPassword, setNewPassword] = useState('')\n    const [confirmPassword, setConfirmPassword] = useState('')\n    const [loading, setLoading] = useState(false)\n\n    const handlePasswordChange = async (e: React.FormEvent) => {\n        e.preventDefault()\n\n        if (newPassword !== confirmPassword) {\n            alert('كلمات المرور غير متطابقة')\n            return\n        }\n\n        if (newPassword.length < 6) {\n            alert('كلمة المرور يجب أن تكون 6 أحرف على الأقل')\n            return\n        }\n\n        setLoading(true)\n        try {\n            const { updatePassword } = await import('@/actions/profile.actions')\n            await updatePassword({ currentPassword, newPassword })\n\n            setCurrentPassword('')\n            setNewPassword('')\n            setConfirmPassword('')\n            setIsChangingPassword(false)\n            alert('تم تغيير كلمة المرور بنجاح')\n        } catch (error: any) {\n            alert(error.message || 'فشل تغيير كلمة المرور')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <div className=\"space-y-6\">\n            <div>\n                <h3 className=\"text-lg font-bold mb-4\">إعدادات الأمان</h3>\n\n                {isOAuthUser ? (\n                    <div className=\"p-4 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 rounded-xl\">\n                        <div className=\"flex items-start gap-3\">\n                            <Lock className=\"text-blue-600 dark:text-blue-400 mt-0.5\" size={20} />\n                            <div>\n                                <p className=\"font-medium text-blue-900 dark:text-blue-100\">تسجيل الدخول عبر Google</p>\n                                <p className=\"text-sm text-blue-700 dark:text-blue-300 mt-1\">\n                                    أنت تستخدم حساب Google للدخول. لا يمكنك تغيير كلمة المرور من هنا.\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                ) : (\n                    <div className=\"space-y-4\">\n                        {!isChangingPassword ? (\n                            <button\n                                onClick={() => setIsChangingPassword(true)}\n                                className=\"flex items-center gap-2 px-4 py-3 bg-primary text-primary-foreground rounded-xl hover:bg-primary/90 transition-colors font-medium\"\n                            >\n                                <Key size={18} />\n                                تغيير كلمة المرور\n                            </button>\n                        ) : (\n                            <form onSubmit={handlePasswordChange} className=\"space-y-4 p-4 border border-border rounded-xl\">\n                                <div>\n                                    <label className=\"block text-sm font-medium mb-1.5\">كلمة المرور الحالية</label>\n                                    <input\n                                        type=\"password\"\n                                        value={currentPassword}\n                                        onChange={e => setCurrentPassword(e.target.value)}\n                                        className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                        required\n                                        minLength={6}\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium mb-1.5\">كلمة المرور الجديدة</label>\n                                    <input\n                                        type=\"password\"\n                                        value={newPassword}\n                                        onChange={e => setNewPassword(e.target.value)}\n                                        className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                        required\n                                        minLength={6}\n                                    />\n                                </div>\n\n                                <div>\n                                    <label className=\"block text-sm font-medium mb-1.5\">تأكيد كلمة المرور</label>\n                                    <input\n                                        type=\"password\"\n                                        value={confirmPassword}\n                                        onChange={e => setConfirmPassword(e.target.value)}\n                                        className=\"w-full px-3 py-2 rounded-lg border border-input bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                                        required\n                                        minLength={6}\n                                    />\n                                </div>\n\n                                <div className=\"flex gap-3 pt-2\">\n                                    <button\n                                        type=\"button\"\n                                        onClick={() => {\n                                            setIsChangingPassword(false)\n                                            setCurrentPassword('')\n                                            setNewPassword('')\n                                            setConfirmPassword('')\n                                        }}\n                                        className=\"flex-1 px-4 py-2 rounded-lg border border-input hover:bg-muted transition-colors font-medium\"\n                                        disabled={loading}\n                                    >\n                                        إلغاء\n                                    </button>\n                                    <button\n                                        type=\"submit\"\n                                        className=\"flex-1 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors font-medium flex items-center justify-center gap-2\"\n                                        disabled={loading}\n                                    >\n                                        {loading && <Loader2 size={16} className=\"animate-spin\" />}\n                                        حفظ\n                                    </button>\n                                </div>\n                            </form>\n                        )}\n                    </div>\n                )}\n            </div>\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/support/create-ticket-dialog.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1451,1454],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1451,1454],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from '@/presentation/ui/dialog'\nimport { Button } from '@/presentation/ui/button'\nimport { Input } from '@/presentation/ui/input'\nimport { Textarea } from '@/presentation/ui/textarea'\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/presentation/ui/select'\nimport { Plus, Loader2 } from 'lucide-react'\nimport { createSupportTicket } from '@/actions/support.actions'\nimport { toast } from 'sonner' // Assuming sonner is used, or alert fallback\n\nexport function CreateTicketDialog() {\n    const [open, setOpen] = useState(false)\n    const [loading, setLoading] = useState(false)\n    const [formData, setFormData] = useState({\n        subject: '',\n        category: '',\n        message: ''\n    })\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault()\n        setLoading(true)\n\n        try {\n            await createSupportTicket({\n                subject: formData.subject,\n                category: formData.category,\n                message: formData.message\n            })\n\n            setOpen(false)\n            setFormData({ subject: '', category: '', message: '' })\n            toast.success('تم إنشاء التذكرة بنجاح')\n            // alert('تم إنشاء التذكرة بنجاح')\n            window.location.reload() // Simple refresh to show new ticket\n        } catch (error: any) {\n            toast.error(error.message || 'حدث خطأ')\n            // alert(error.message || 'حدث خطأ')\n        } finally {\n            setLoading(false)\n        }\n    }\n\n    return (\n        <Dialog open={open} onOpenChange={setOpen}>\n            <DialogTrigger asChild>\n                <Button className=\"gap-2 bg-primary text-primary-foreground hover:bg-primary/90\">\n                    <Plus size={16} />\n                    تذكرة جديدة\n                </Button>\n            </DialogTrigger>\n            <DialogContent className=\"sm:max-w-[500px]\" dir=\"rtl\">\n                <DialogHeader>\n                    <DialogTitle className=\"text-right\">تذكرة دعم فني جديدة</DialogTitle>\n                </DialogHeader>\n                <form onSubmit={handleSubmit} className=\"space-y-4 mt-4\">\n                    <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium\">الموضوع</label>\n                        <Input\n                            required\n                            placeholder=\"وصف مختصر للمشكلة\"\n                            value={formData.subject}\n                            onChange={e => setFormData({ ...formData, subject: e.target.value })}\n                        />\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium\">القسم</label>\n                        <Select\n                            required\n                            onValueChange={(value: string) => setFormData({ ...formData, category: value })}\n                        >\n                            <SelectTrigger>\n                                <SelectValue placeholder=\"اختر القسم\" />\n                            </SelectTrigger>\n                            <SelectContent>\n                                <SelectItem value=\"bug\">مشكلة تقنية</SelectItem>\n                                <SelectItem value=\"feature\">اقتراح ميزة</SelectItem>\n                                <SelectItem value=\"account\">الحساب</SelectItem>\n                                <SelectItem value=\"other\">أخرى</SelectItem>\n                            </SelectContent>\n                        </Select>\n                    </div>\n\n                    <div className=\"space-y-2\">\n                        <label className=\"text-sm font-medium\">تفاصيل المشكلة</label>\n                        <Textarea\n                            required\n                            placeholder=\"اشرح المشكلة بالتفصيل...\"\n                            className=\"min-h-[120px]\"\n                            value={formData.message}\n                            onChange={e => setFormData({ ...formData, message: e.target.value })}\n                        />\n                    </div>\n\n                    <div className=\"flex justify-end gap-3 pt-4 border-t\">\n                        <Button\n                            type=\"button\"\n                            variant=\"outline\"\n                            onClick={() => setOpen(false)}\n                            disabled={loading}\n                        >\n                            إلغاء\n                        </Button>\n                        <Button type=\"submit\" disabled={loading}>\n                            {loading && <Loader2 className=\"ml-2 h-4 w-4 animate-spin\" />}\n                            إرسال التذكرة\n                        </Button>\n                    </div>\n                </form>\n            </DialogContent>\n        </Dialog>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/support/support-list.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[590,593],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[590,593],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[949,952],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[949,952],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":58,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":61,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1129,1132],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1129,1132],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { format } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport { MessageSquare, Clock, CheckCircle2, AlertCircle } from 'lucide-react'\nimport { Badge } from '@/presentation/ui/badge'\nimport { Card } from '@/presentation/ui/card'\nimport { CreateTicketDialog } from './create-ticket-dialog'\nimport { TicketChat } from './ticket-chat' // Will create this next\nimport { useState, useEffect } from 'react'\n\nconst categoryMap: Record<string, string> = {\n    bug: 'مشكلة تقنية',\n    feature: 'اقتراح ميزة',\n    account: 'الحساب',\n    other: 'أخرى'\n}\n\nconst statusMap: any = {\n    open: { label: 'مفتوحة', color: 'bg-blue-500', icon: AlertCircle },\n    in_progress: { label: 'قيد المعالجة', color: 'bg-yellow-500', icon: Clock },\n    resolved: { label: 'تم الحل', color: 'bg-green-500', icon: CheckCircle2 },\n    closed: { label: 'مغلقة', color: 'bg-gray-500', icon: CheckCircle2 },\n}\n\ninterface SupportListProps {\n    tickets: any[]\n    initialTicketId?: string | null\n}\n\nexport function SupportList({ tickets, initialTicketId }: SupportListProps) {\n    const [selectedTicket, setSelectedTicket] = useState<any>(null)\n\n    // Auto-select ticket from URL\n    useEffect(() => {\n        if (initialTicketId && tickets.length > 0 && !selectedTicket) {\n            const ticket = tickets.find(t => t.id === initialTicketId)\n            if (ticket) {\n                // Use a tick to avoid \"setState in effect\" warning\n                const timer = setTimeout(() => {\n                    setSelectedTicket(ticket)\n                }, 0)\n                return () => clearTimeout(timer)\n            }\n        }\n    }, [initialTicketId, tickets, selectedTicket])\n\n    if (selectedTicket) {\n        return (\n            <div className=\"animate-in fade-in slide-in-from-bottom-4 duration-300\">\n                <div className=\"flex items-center gap-2 mb-4\">\n                    <button\n                        onClick={() => setSelectedTicket(null)}\n                        className=\"text-sm text-muted-foreground hover:text-primary transition-colors\"\n                    >\n                        ← العودة للقائمة\n                    </button>\n                </div>\n                <TicketChat ticket={selectedTicket} />\n            </div>\n        )\n    }\n\n    return (\n        <div className=\"space-y-6\">\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h2 className=\"text-2xl font-bold\">الدعم الفني</h2>\n                    <p className=\"text-muted-foreground mt-1\">\n                        تواصل معنا لحل مشاكلك أو تقديم اقتراحاتك\n                    </p>\n                </div>\n                <CreateTicketDialog />\n            </div>\n\n            {tickets.length === 0 ? (\n                <Card className=\"flex flex-col items-center justify-center py-12 text-center text-muted-foreground bg-muted/30 border-dashed\">\n                    <MessageSquare className=\"w-12 h-12 mb-4 opacity-50\" />\n                    <h3 className=\"text-lg font-medium mb-1\">لا توجد تذاكر</h3>\n                    <p className=\"text-sm\">لم تقم بإنشاء أي تذاكر دعم فني بعد</p>\n                </Card>\n            ) : (\n                <div className=\"grid gap-4\">\n                    {tickets.map((ticket) => {\n                        const status = statusMap[ticket.status] || statusMap.open\n                        const StatusIcon = status.icon\n\n                        return (\n                            <Card\n                                key={ticket.id}\n                                className=\"p-4 hover:shadow-md transition-shadow cursor-pointer border-l-4 border-l-transparent hover:border-l-primary\"\n                                onClick={() => setSelectedTicket(ticket)}\n                            >\n                                <div className=\"flex items-start justify-between gap-4\">\n                                    <div className=\"flex-1 space-y-1\">\n                                        <div className=\"flex items-center gap-2\">\n                                            <h3 className=\"font-semibold text-base md:text-lg break-words\">{ticket.subject}</h3>\n                                            <Badge variant=\"outline\" className={`${status.color} bg-opacity-10 text-${status.color?.replace('bg-', '') || 'gray-500'} border-0`}>\n                                                <StatusIcon size={12} className=\"mr-1\" />\n                                                {status.label}\n                                            </Badge>\n                                        </div>\n                                        <div className=\"flex flex-wrap items-center gap-x-3 gap-y-1 text-xs md:text-sm text-muted-foreground\">\n                                            <span>#{ticket.id.substring(0, 8)}</span>\n                                            <span>•</span>\n                                            <span>{categoryMap[ticket.category] || ticket.category}</span>\n                                            <span>•</span>\n                                            <span dir=\"ltr\">\n                                                {format(new Date(ticket.created_at), 'PPP p', { locale: ar })}\n                                            </span>\n                                        </div>\n                                    </div>\n                                    {ticket.messages && ticket.messages[0]?.count > 0 && (\n                                        <Badge variant=\"secondary\" className=\"gap-1\">\n                                            <MessageSquare size={12} />\n                                            {ticket.messages[0].count}\n                                        </Badge>\n                                    )}\n                                </div>\n                            </Card>\n                        )\n                    })}\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/profile/support/ticket-chat.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'AvatarImage' is defined but never used.","line":8,"column":34,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":45,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"AvatarImage"},"fix":{"range":[335,348],"text":""},"desc":"Remove unused variable \"AvatarImage\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":22,"column":13,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":16,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[770,773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[770,773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":26,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":26,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[880,883],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[880,883],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchMessages'. Either include it or remove the dependency array.","line":62,"column":8,"nodeType":"ArrayExpression","endLine":62,"endColumn":19,"suggestions":[{"desc":"Update the dependencies array to be: [fetchMessages, ticket.id]","fix":{"range":[2048,2059],"text":"[fetchMessages, ticket.id]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useEffect, useState, useRef } from 'react'\nimport { Send, Loader2, User, UserCog, MessageSquare } from 'lucide-react'\nimport { Button } from '@/presentation/ui/button'\nimport { Textarea } from '@/presentation/ui/textarea'\nimport { ScrollArea } from '@/presentation/ui/scroll-area'\nimport { Avatar, AvatarFallback, AvatarImage } from '@/presentation/ui/avatar'\nimport { getTicketMessages, addTicketMessage } from '@/actions/support.actions'\nimport { format } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport { createClient } from '@/lib/supabase/client'\n\nconst categoryMap: Record<string, string> = {\n    bug: 'مشكلة تقنية',\n    feature: 'اقتراح ميزة',\n    account: 'الحساب',\n    other: 'أخرى'\n}\n\ninterface TicketChatProps {\n    ticket: any\n}\n\nexport function TicketChat({ ticket }: TicketChatProps) {\n    const [messages, setMessages] = useState<any[]>([])\n    const [newMessage, setNewMessage] = useState('')\n    const [loading, setLoading] = useState(true)\n    const [sending, setSending] = useState(false)\n    const [userId, setUserId] = useState<string | null>(null)\n    const messagesEndRef = useRef<HTMLDivElement>(null)\n\n    const scrollToBottom = () => {\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\n    }\n\n    useEffect(() => {\n        const getUser = async () => {\n            const supabase = createClient()\n            const { data: { user } } = await supabase.auth.getUser()\n            if (user) setUserId(user.id)\n        }\n        getUser()\n    }, [])\n\n    const fetchMessages = async () => {\n        try {\n            const data = await getTicketMessages(ticket.id)\n            setMessages(data)\n            setLoading(false)\n        } catch (error) {\n            console.error('Failed to fetch messages', error)\n            setLoading(false)\n        }\n    }\n\n    useEffect(() => {\n        fetchMessages()\n        // Real-time subscription could be added here\n        const interval = setInterval(fetchMessages, 10000)\n        return () => clearInterval(interval)\n    }, [ticket.id])\n\n    // Scroll to bottom when messages change\n    useEffect(() => {\n        scrollToBottom()\n    }, [messages, loading])\n\n    const handleSend = async () => {\n        if (!newMessage.trim()) return\n\n        setSending(true)\n        try {\n            await addTicketMessage(ticket.id, newMessage)\n            setNewMessage('')\n            await fetchMessages()\n        } catch (error) {\n            console.error('Failed to send message', error)\n            alert('فشل إرسال الرسالة')\n        } finally {\n            setSending(false)\n        }\n    }\n\n    return (\n        <div className=\"flex flex-col h-[600px] border rounded-lg bg-background shadow-sm\">\n            {/* Header */}\n            <div className=\"p-4 border-b flex justify-between items-center bg-muted/30\">\n                <div>\n                    <h3 className=\"font-bold break-words line-clamp-2 text-sm md:text-base\">{ticket.subject}</h3>\n                    <p className=\"text-sm text-muted-foreground\">\n                        {categoryMap[ticket.category] || ticket.category} • #{ticket.id.substring(0, 8)}\n                    </p>\n                </div>\n                <div className=\"px-3 py-1 rounded-full text-xs font-medium bg-primary/10 text-primary border border-primary/20\">\n                    {ticket.status}\n                </div>\n            </div>\n\n            {/* Messages Area */}\n            <ScrollArea className=\"flex-1\">\n                <div className=\"p-4\">\n                    {loading ? (\n                        <div className=\"flex justify-center items-center h-full py-12\">\n                            <Loader2 className=\"animate-spin text-muted-foreground\" />\n                        </div>\n                    ) : messages.length === 0 ? (\n                        <div className=\"flex flex-col items-center justify-center h-full py-12 text-muted-foreground opacity-50\">\n                            <MessageSquare className=\"w-12 h-12 mb-4\" />\n                            <p>لا توجد رسائل بعد</p>\n                            <p className=\"text-xs mt-2\">ابدأ المحادثة مع الدعم الفني</p>\n                        </div>\n                    ) : (\n                        <div className=\"space-y-4\">\n                            {messages.map((msg) => {\n                                const isMe = userId === msg.sender_id\n\n                                return (\n                                    <div\n                                        key={msg.id}\n                                        className={`flex gap-3 ${isMe ? 'flex-row-reverse' : 'flex-row'}`}\n                                    >\n                                        <Avatar className=\"w-8 h-8 mt-1 border shadow-sm\">\n                                            <AvatarFallback className={isMe ? 'bg-primary/10 text-primary' : 'bg-orange-100 text-orange-600'}>\n                                                {isMe ? <User size={14} /> : <UserCog size={14} />}\n                                            </AvatarFallback>\n                                        </Avatar>\n                                        <div className={`flex flex-col ${isMe ? 'items-end' : 'items-start'} max-w-[80%]`}>\n                                            {!isMe && <span className=\"text-[10px] text-muted-foreground mb-1 mr-1\">الدعم الفني</span>}\n                                            <div\n                                                className={`p-3 rounded-2xl text-sm shadow-sm ${isMe\n                                                    ? 'bg-primary text-primary-foreground rounded-tr-sm'\n                                                    : 'bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-tl-sm'\n                                                    }`}\n                                            >\n                                                <div className=\"whitespace-pre-wrap leading-relaxed\">{msg.message}</div>\n                                            </div>\n                                            <div className={`text-[10px] mt-1 px-1 opacity-70 text-muted-foreground`}>\n                                                {format(new Date(msg.created_at), 'p', { locale: ar })}\n                                            </div>\n                                        </div>\n                                    </div>\n                                )\n                            })}\n                            <div ref={messagesEndRef} />\n                        </div>\n                    )}\n                </div>\n            </ScrollArea >\n\n            {/* Input Area */}\n            < div className=\"p-4 border-t bg-muted/30\" >\n                <div className=\"flex gap-2\">\n                    <Textarea\n                        placeholder=\"اكتب رسالتك هنا...\"\n                        value={newMessage}\n                        onChange={e => setNewMessage(e.target.value)}\n                        className=\"min-h-[50px] max-h-[120px] resize-none\"\n                        onKeyDown={e => {\n                            if (e.key === 'Enter' && !e.shiftKey) {\n                                e.preventDefault()\n                                handleSend()\n                            }\n                        }}\n                    />\n                    <Button\n                        onClick={handleSend}\n                        disabled={sending || !newMessage.trim()}\n                        size=\"icon\"\n                        className=\"h-auto w-12\"\n                    >\n                        {sending ? <Loader2 className=\"animate-spin\" /> : <Send size={18} />}\n                    </Button>\n                </div>\n            </div >\n        </div >\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/reviews/components/review-card.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":100,"column":29,"nodeType":"JSXOpeningElement","endLine":104,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState, useEffect } from 'react'\n\nimport { Review } from '@/domain/entities/review'\nimport { StarRating } from '@/presentation/features/places/components/star-rating'\nimport { formatDistanceToNow } from 'date-fns'\nimport { ar } from 'date-fns/locale'\nimport { ThumbsUp, ThumbsDown, Edit2, Trash2 } from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\ninterface ReviewCardProps {\n    review: Review\n    onHelpful?: (reviewId: string, isHelpful: boolean) => void\n    onEdit?: (reviewId: string) => void\n    onDelete?: (reviewId: string) => void\n    isOwnReview?: boolean\n    userVote?: boolean | null\n}\n\nexport function ReviewCard({\n    review,\n    onHelpful,\n    onEdit,\n    onDelete,\n    isOwnReview = false,\n    userVote = null,\n}: ReviewCardProps) {\n    const timeAgo = formatDistanceToNow(new Date(review.createdAt), {\n        addSuffix: true,\n        locale: ar,\n    })\n\n    const [optimisticVote, setOptimisticVote] = useState<boolean | null | undefined>(userVote)\n    const [optimisticCount, setOptimisticCount] = useState(review.helpfulCount)\n\n    // Sync with props if they change (e.g. revalidation)\n    useEffect(() => {\n        // Use a tick to avoid \"setState in effect\" warning\n        const timer = setTimeout(() => {\n            setOptimisticVote(userVote)\n            setOptimisticCount(review.helpfulCount)\n        }, 0)\n        return () => clearTimeout(timer)\n    }, [userVote, review.helpfulCount])\n\n    const handleVote = (isHelpful: boolean) => {\n        if (!onHelpful) return\n\n        let newVote: boolean | null = isHelpful\n        let newCount = optimisticCount\n\n        // Logic for toggling and switching votes\n        if (optimisticVote === isHelpful) {\n            // Toggle off (remove vote)\n            newVote = null\n            if (isHelpful) newCount-- // Removing helpful vote decreases count\n        } else {\n            // Switching or new vote\n            if (isHelpful) {\n                newCount++ // New helpful vote\n                // If switching from unhelpful to helpful, count only increases by 1 (since unhelpful was 0)\n            } else {\n                if (optimisticVote === true) newCount-- // Switching from helpful to unhelpful decreases count\n            }\n        }\n\n        setOptimisticVote(newVote)\n        setOptimisticCount(newCount)\n\n        // Call parent handler (server action)\n        // If newVote is null, we might need a way to 'remove' vote.\n        // Current interface is (reviewId, isHelpful).\n        // If we toggle off, we usually send the same value again or strict remove?\n        // Supabase repo `voteReview` toggles? No, it inserts or updates.\n        // But `voteReview` implementation: \n        // if existing: update. \n        // Logic for removing? `removeVote` exists in repo.\n        // But `onHelpful` prop usually takes (id, isHelpful).\n        // I need to check how `onVoteReview` in `ReviewsSection` handles removal.\n        // It calls `voteReview` (server action). Does server action handle toggle?\n        // Let's assume for now we just send the new state. \n        // Wait, if I want to \"remove\" the vote i.e. make it null, I need to call `removeVote`?\n        // `ReviewsSection` prop `onVoteReview` takes `(reviewId, isHelpful)`. It implies boolean.\n        // If I need to remove, I probably need to update `ReviewsSection` logic too?\n        // Or `voteReview` action should handle removal?\n        // Let's look at `voteReviewUseCase` or Action.\n\n        onHelpful(review.id, isHelpful)\n    }\n\n    return (\n        <div className=\"bg-card border border-border rounded-xl p-6 space-y-4\">\n            {/* Header */}\n            <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-3\">\n                    {/* Avatar */}\n                    <div className=\"w-12 h-12 rounded-full overflow-hidden bg-primary/10 flex items-center justify-center text-primary font-bold relative\">\n                        {review.userAvatar ? (\n                            <img\n                                src={review.userAvatar}\n                                alt={review.userName}\n                                className=\"w-full h-full object-cover\"\n                            />\n                        ) : (\n                            <span>{review.userName?.[0]?.toUpperCase() || '👤'}</span>\n                        )}\n                    </div>\n\n                    {/* User info */}\n                    <div>\n                        <h4 className=\"font-semibold text-foreground\">{review.userName}</h4>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                            <StarRating rating={review.rating} size=\"sm\" />\n                            <span className=\"text-xs text-muted-foreground\">{timeAgo}</span>\n                        </div>\n                    </div>\n                </div>\n\n                {/* Edit/Delete buttons (only for own review) */}\n                {isOwnReview && (\n                    <div className=\"flex items-center gap-2\">\n                        {onEdit && (\n                            <button\n                                onClick={() => onEdit(review.id)}\n                                className=\"p-2 text-muted-foreground hover:text-foreground hover:bg-muted rounded-lg transition-colors\"\n                                title=\"تعديل\"\n                            >\n                                <Edit2 size={16} />\n                            </button>\n                        )}\n                        {onDelete && (\n                            <button\n                                onClick={() => onDelete(review.id)}\n                                className=\"p-2 text-muted-foreground hover:text-destructive hover:bg-destructive/10 rounded-lg transition-colors\"\n                                title=\"حذف\"\n                            >\n                                <Trash2 size={16} />\n                            </button>\n                        )}\n                    </div>\n                )}\n            </div>\n\n            {/* Review content */}\n            <div className=\"space-y-2\">\n                {review.title && (\n                    <h5 className=\"font-semibold text-foreground\">{review.title}</h5>\n                )}\n                <p className=\"text-muted-foreground leading-relaxed\">{review.comment}</p>\n            </div>\n\n            {/* Footer - Helpful buttons */}\n            {!isOwnReview && onHelpful && (\n                <div className=\"flex items-center gap-3 pt-3 border-t border-border\">\n                    <span className=\"text-sm text-muted-foreground\">هل هذا التقييم مفيد؟</span>\n                    <div className=\"flex items-center gap-2\">\n                        <button\n                            onClick={() => handleVote(true)}\n                            className={cn(\n                                'inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors',\n                                optimisticVote === true\n                                    ? 'bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400'\n                                    : 'bg-muted hover:bg-muted/80 text-muted-foreground hover:text-foreground'\n                            )}\n                        >\n                            <ThumbsUp size={14} className={cn(optimisticVote === true && \"fill-current\")} />\n                            <span>مفيد</span>\n                            {optimisticCount > 0 && (\n                                <span className=\"text-xs\">({optimisticCount})</span>\n                            )}\n                        </button>\n                        <button\n                            onClick={() => handleVote(false)}\n                            className={cn(\n                                'inline-flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors',\n                                optimisticVote === false\n                                    ? 'bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400'\n                                    : 'bg-muted hover:bg-muted/80 text-muted-foreground hover:text-foreground'\n                            )}\n                        >\n                            <ThumbsDown size={14} className={cn(optimisticVote === false && \"fill-current\")} />\n                            <span>غير مفيد</span>\n                        </button>\n                    </div>\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/reviews/components/review-form.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":51,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":51,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1443,1446],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1443,1446],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport { useState } from 'react'\nimport { ReviewFormData } from '@/domain/entities/review'\nimport { StarRating } from '@/presentation/features/places/components/star-rating'\nimport { Loader2 } from 'lucide-react'\n\ninterface ReviewFormProps {\n    placeId: string\n    placeName: string\n    existingReview?: {\n        rating: number\n        title?: string\n        comment: string\n    }\n    onSubmit: (data: ReviewFormData) => Promise<void>\n    onCancel?: () => void\n    isLoading?: boolean\n}\n\nexport function ReviewForm({\n    placeName,\n    existingReview,\n    onSubmit,\n    onCancel,\n    isLoading = false,\n}: ReviewFormProps) {\n    const [rating, setRating] = useState(existingReview?.rating || 0)\n    const [title, setTitle] = useState(existingReview?.title || '')\n    const [comment, setComment] = useState(existingReview?.comment || '')\n    const [isAnonymous, setIsAnonymous] = useState(false)\n    const [error, setError] = useState('')\n\n    const handleSubmit = async (e: React.FormEvent) => {\n        e.preventDefault()\n        setError('')\n\n        // Validation\n        if (rating === 0) {\n            setError('الرجاء اختيار التقييم')\n            return\n        }\n\n        if (comment.trim().length < 5) {\n            setError('يجب أن يكون التعليق 5 أحرف على الأقل')\n            return\n        }\n\n        try {\n            await onSubmit({ rating, title: title || undefined, comment, isAnonymous })\n        } catch (err: any) {\n            setError(err.message || 'حدث خطأ أثناء إرسال التقييم')\n        }\n    }\n\n    return (\n        <form onSubmit={handleSubmit} className=\"bg-card border border-border rounded-xl p-6 space-y-6\">\n            <div>\n                <h3 className=\"text-xl font-bold text-foreground mb-2\">\n                    {existingReview ? 'تعديل تقييمك' : 'اكتب تقييمك'}\n                </h3>\n                <p className=\"text-sm text-muted-foreground\">\n                    شارك تجربتك مع <span className=\"font-medium\">{placeName}</span>\n                </p>\n            </div>\n\n            {/* Rating */}\n            <div className=\"space-y-2\">\n                <label className=\"text-sm font-medium text-foreground\">\n                    التقييم <span className=\"text-destructive\">*</span>\n                </label>\n                <StarRating\n                    rating={rating}\n                    size=\"lg\"\n                    interactive\n                    onChange={setRating}\n                />\n                {rating > 0 && (\n                    <p className=\"text-xs text-muted-foreground\">\n                        {rating === 5 && '⭐ ممتاز'}\n                        {rating === 4 && '😊 جيد جداً'}\n                        {rating === 3 && '😐 جيد'}\n                        {rating === 2 && '😕 مقبول'}\n                        {rating === 1 && '😞 سيء'}\n                    </p>\n                )}\n            </div>\n\n            {/* Title (optional) */}\n            <div className=\"space-y-2\">\n                <label htmlFor=\"review-title\" className=\"text-sm font-medium text-foreground\">\n                    عنوان التقييم (اختياري)\n                </label>\n                <input\n                    id=\"review-title\"\n                    type=\"text\"\n                    value={title}\n                    onChange={(e) => setTitle(e.target.value)}\n                    placeholder=\"مثال: مكان رائع ونظيف\"\n                    className=\"w-full px-4 py-2 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-primary\"\n                    maxLength={200}\n                    disabled={isLoading}\n                />\n                <p className=\"text-xs text-muted-foreground text-left\">\n                    {title.length}/200\n                </p>\n            </div>\n\n            {/* Comment */}\n            <div className=\"space-y-2\">\n                <label htmlFor=\"review-comment\" className=\"text-sm font-medium text-foreground\">\n                    التعليق <span className=\"text-destructive\">*</span>\n                </label>\n                <textarea\n                    id=\"review-comment\"\n                    value={comment}\n                    onChange={(e) => setComment(e.target.value)}\n                    placeholder=\"شارك تجربتك مع هذا المكان...\"\n                    className=\"w-full px-4 py-3 bg-background border border-input rounded-lg focus:outline-none focus:ring-2 focus:ring-primary min-h-[120px] resize-y\"\n                    disabled={isLoading}\n                />\n                <p className=\"text-xs text-muted-foreground\">\n                    {comment.trim().length < 5 && `متبقي ${5 - comment.trim().length} أحرف`}\n                    {comment.trim().length >= 5 && '✓ الطول مناسب'}\n                </p>\n            </div>\n\n            {/* Anonymous Option */}\n            <div className=\"flex items-center gap-2\">\n                <input\n                    type=\"checkbox\"\n                    id=\"is-anonymous\"\n                    checked={isAnonymous}\n                    onChange={(e) => setIsAnonymous(e.target.checked)}\n                    className=\"w-4 h-4 rounded border-gray-300 text-primary focus:ring-primary\"\n                    disabled={isLoading}\n                />\n                <label htmlFor=\"is-anonymous\" className=\"text-sm text-foreground select-none cursor-pointer\">\n                    نشر التقييم كـ &quot;مستخدم&quot; (إخفاء اسمك)\n                </label>\n            </div>\n\n            {/* Error */}\n            {error && (\n                <div className=\"bg-destructive/10 border border-destructive/30 text-destructive px-4 py-3 rounded-lg text-sm\">\n                    {error}\n                </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex flex-col gap-2\">\n                <div className=\"flex items-center gap-3\">\n                    <button\n                        type=\"submit\"\n                        disabled={isLoading || rating === 0 || comment.trim().length < 5}\n                        className=\"flex-1 bg-primary hover:bg-primary/90 text-primary-foreground px-6 py-3 rounded-xl font-semibold disabled:opacity-50 disabled:cursor-not-allowed transition-colors inline-flex items-center justify-center gap-2\"\n                    >\n                        {isLoading && <Loader2 size={18} className=\"animate-spin\" />}\n                        {isLoading ? 'جاري النشر...' : existingReview ? 'تحديث التقييم' : 'نشر التقييم'}\n                    </button>\n                    {onCancel && (\n                        <button\n                            type=\"button\"\n                            onClick={onCancel}\n                            disabled={isLoading}\n                            className=\"px-6 py-3 bg-muted hover:bg-muted/80 text-foreground rounded-xl font-medium transition-colors\"\n                        >\n                            إلغاء\n                        </button>\n                    )}\n                </div>\n                {(rating === 0 || comment.trim().length < 5) && (\n                    <p className=\"text-xs text-center text-muted-foreground\">\n                        {rating === 0 ? 'يجب اختيار عدد النجوم' : 'اكتب تعليقاً من ٥ أحرف على الأقل'} لتفعيل زر النشر\n                    </p>\n                )}\n            </div>\n\n        </form >\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/reviews/components/reviews-section-client.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/reviews/components/reviews-section-wrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/static/about-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/static/contact-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/static/privacy-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/features/static/terms-view.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/image-upload.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'ImageIcon' is defined but never used.","line":5,"column":37,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":46,"suggestions":[{"messageId":"removeUnusedVar","data":{"varName":"ImageIcon"},"fix":{"range":[135,155],"text":""},"desc":"Remove unused variable \"ImageIcon\"."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\n\nimport React, { useState, useEffect } from 'react'\nimport { useDropzone } from 'react-dropzone'\nimport { Plus, X, Loader2, Image as ImageIcon } from 'lucide-react'\nimport Image from 'next/image'\n\ninterface ImageUploadProps {\n    value?: string[]\n    onChange: (urls: string[]) => void\n    disabled?: boolean\n    maxFiles?: number\n}\n\n// NOTE: In production, you'd typically use signed uploads or a server action to get a signature.\n// For MVP/Demo, unsigned uploads are simpler but less secure. \n// We'll rely on a public unsigned preset name which needs to be added to ENV.\nconst CLOUDINARY_UPLOAD_PRESET = process.env.NEXT_PUBLIC_CLOUDINARY_UPLOAD_PRESET || 'daleel_unsigned'\nconst CLOUDINARY_CLOUD_NAME = process.env.NEXT_PUBLIC_CLOUDINARY_CLOUD_NAME\n\nexport default function ImageUpload({ value = [], onChange, disabled, maxFiles = 5 }: ImageUploadProps) {\n    const [isUploading, setIsUploading] = useState(false)\n    const [mounted, setMounted] = useState(false)\n\n    useEffect(() => {\n        setMounted(true)\n    }, [])\n\n    const onDrop = async (acceptedFiles: File[]) => {\n        if (!CLOUDINARY_CLOUD_NAME) {\n            alert(\"Cloudinary Cloud Name is missing in ENV\")\n            return\n        }\n\n        setIsUploading(true)\n        const newUrls: string[] = []\n\n        try {\n            for (const file of acceptedFiles) {\n                const formData = new FormData()\n                formData.append('file', file)\n                formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET)\n\n                const response = await fetch(\n                    `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,\n                    {\n                        method: 'POST',\n                        body: formData\n                    }\n                )\n\n                if (!response.ok) throw new Error('Upload failed')\n\n                const data = await response.json()\n                newUrls.push(data.secure_url)\n            }\n\n            // Append new URLs to existing ones\n            onChange([...value, ...newUrls])\n        } catch (error) {\n            console.error(error)\n            alert(\"Failed to upload image\")\n        } finally {\n            setIsUploading(false)\n        }\n    }\n\n    const { getRootProps, getInputProps } = useDropzone({\n        onDrop,\n        accept: {\n            'image/*': ['.png', '.jpg', '.jpeg', '.webp']\n        },\n        maxFiles: maxFiles - value.length,\n        disabled: disabled || isUploading || value.length >= maxFiles\n    })\n\n    const removeImage = (urlToRemove: string) => {\n        onChange(value.filter((url) => url !== urlToRemove))\n    }\n\n    if (!mounted) return null\n\n    return (\n        <div className=\"space-y-4\">\n            {/* Image Grid */}\n            <div className={`grid grid-cols-2 sm:grid-cols-3 gap-4 ${value.length > 0 ? 'mb-4' : ''}`}>\n                {value.map((url) => (\n                    <div key={url} className=\"relative aspect-square rounded-xl overflow-hidden border border-slate-700 bg-slate-900 group\">\n                        <Image\n                            src={url}\n                            alt=\"Uploaded\"\n                            fill\n                            className=\"object-cover transition-transform group-hover:scale-105\"\n                        />\n                        <button\n                            type=\"button\"\n                            onClick={() => removeImage(url)}\n                            className=\"absolute top-2 right-2 bg-red-500 text-white p-1.5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity disabled:cursor-not-allowed\"\n                            disabled={disabled}\n                        >\n                            <X size={14} />\n                        </button>\n                    </div>\n                ))}\n            </div>\n\n            {/* Dropzone */}\n            {value.length < maxFiles && (\n                <div\n                    {...getRootProps()}\n                    className={`\n                        border-2 border-dashed rounded-xl p-8 \n                        flex flex-col items-center justify-center gap-3 text-center cursor-pointer transition-colors\n                        ${isUploading ? 'opacity-50 cursor-not-allowed' : 'hover:border-primary hover:bg-primary/5'}\n                        ${disabled ? 'opacity-50 cursor-not-allowed' : 'border-slate-700 bg-slate-900/50'}\n                    `}\n                >\n                    <input {...getInputProps()} />\n                    {isUploading ? (\n                        <div className=\"flex flex-col items-center gap-2\">\n                            <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n                            <span className=\"text-sm text-slate-400\">جاري الرفع...</span>\n                        </div>\n                    ) : (\n                        <>\n                            <div className=\"p-3 bg-slate-800 rounded-full text-slate-400\">\n                                <Plus size={24} />\n                            </div>\n                            <div className=\"space-y-1\">\n                                <p className=\"text-sm font-medium text-slate-300\">\n                                    اضغط للرفع أو اسحب الصور هنا\n                                </p>\n                                <p className=\"text-xs text-slate-500\">\n                                    الحد الأقصى {maxFiles} صور (JPG, PNG, WebP)\n                                </p>\n                            </div>\n                        </>\n                    )}\n                </div>\n            )}\n        </div>\n    )\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/sonner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/shaban/Documents/daleel_al_suez/src/presentation/ui/textarea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]